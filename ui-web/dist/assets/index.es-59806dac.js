import{e as ky,r as Bs,f as ie,h as kr,i as Ky,w as Cl,j as Al,k as gc,t as ga,m as By,o as ea,p as Vy,q as _i,D as Gy,s as Wy,N as X,u as Jy,v as oc,x as Qy,V as Yy,R as Xy,F as Sh,K as Zy,y as em,L as tm,z as Ch,$ as rm,A as im,B as Ks,Z as Ah,J as sm,X as nm,E as vc,_ as Ol,C as $r,G as am,H as om,I as us,M as Ft,U as tr,O as wi,P as hr,Q as cm,S as hs,T as Rl,W as um,Y as hm,a0 as lm,a1 as Tl,a2 as fm,a3 as Nl,a4 as Fl,a5 as ls,a6 as cc,a7 as oa,a8 as fs,a9 as pm,aa as ca,ab as dm,ac as gm,ad as vm,ae as ta,af as ym,ag as mm,ah as Ko,ai as Oh,aj as wm,ak as _m,al as bm,am as Rh,an as Em,ao as Im,ap as xm,aq as Pm,ar as Sm,as as Cm,at as Am,au as js,av as $l,aw as Bo,ax as Om,ay as Rm,az as Tm}from"./index-c12aec1c.js";import{s as Vs,a as va,i as Th,c as Nm,b as Fm,f as yc,p as $m,J as ni,d as mc,e as wc,g as _c,h as mi,j as si,k as ks,l as Dm,m as Lm,H as Ii}from"./http-26f5d9fe.js";const qm=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,zm=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Mm=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jm(c,i){if(c==="__proto__"||c==="constructor"&&i&&typeof i=="object"&&"prototype"in i){Um(c);return}return i}function Um(c){console.warn(`[destr] Dropping "${c}" key to prevent prototype pollution.`)}function ra(c,i={}){if(typeof c!="string")return c;const r=c.trim();if(c[0]==='"'&&c.at(-1)==='"'&&!c.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!Mm.test(c)){if(i.strict)throw new SyntaxError("[destr] Invalid JSON");return c}try{if(qm.test(c)||zm.test(c)){if(i.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(c,jm)}return JSON.parse(c)}catch(n){if(i.strict)throw n;return c}}function Hm(c){return!c||typeof c.then!="function"?Promise.resolve(c):c}function jt(c,...i){try{return Hm(c(...i))}catch(r){return Promise.reject(r)}}function km(c){const i=typeof c;return c===null||i!=="object"&&i!=="function"}function Km(c){const i=Object.getPrototypeOf(c);return!i||i.isPrototypeOf(Object)}function ua(c){if(km(c))return String(c);if(Km(c)||Array.isArray(c))return JSON.stringify(c);if(typeof c.toJSON=="function")return ua(c.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Dl(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const uc="base64:";function Bm(c){if(typeof c=="string")return c;Dl();const i=Buffer.from(c).toString("base64");return uc+i}function Vm(c){return typeof c!="string"||!c.startsWith(uc)?c:(Dl(),Buffer.from(c.slice(uc.length),"base64"))}function ur(c){return c?c.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Gm(...c){return ur(c.join(":"))}function ia(c){return c=ur(c),c?c+":":""}const Wm="memory",Jm=()=>{const c=new Map;return{name:Wm,options:{},hasItem(i){return c.has(i)},getItem(i){return c.get(i)??null},getItemRaw(i){return c.get(i)??null},setItem(i,r){c.set(i,r)},setItemRaw(i,r){c.set(i,r)},removeItem(i){c.delete(i)},getKeys(){return Array.from(c.keys())},clear(){c.clear()},dispose(){c.clear()}}};function Qm(c={}){const i={mounts:{"":c.driver||Jm()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=v=>{for(const E of i.mountpoints)if(v.startsWith(E))return{base:E,relativeKey:v.slice(E.length),driver:i.mounts[E]};return{base:"",relativeKey:v,driver:i.mounts[""]}},n=(v,E)=>i.mountpoints.filter(C=>C.startsWith(v)||E&&v.startsWith(C)).map(C=>({relativeBase:v.length>C.length?v.slice(C.length):void 0,mountpoint:C,driver:i.mounts[C]})),a=(v,E)=>{if(i.watching){E=ur(E);for(const C of i.watchListeners)C(v,E)}},l=async()=>{if(!i.watching){i.watching=!0;for(const v in i.mounts)i.unwatch[v]=await Nh(i.mounts[v],a,v)}},d=async()=>{if(i.watching){for(const v in i.unwatch)await i.unwatch[v]();i.unwatch={},i.watching=!1}},y=(v,E,C)=>{const R=new Map,M=$=>{let K=R.get($.base);return K||(K={driver:$.driver,base:$.base,items:[]},R.set($.base,K)),K};for(const $ of v){const K=typeof $=="string",re=ur(K?$:$.key),ce=K?void 0:$.value,ue=K||!$.options?E:{...E,...$.options},he=r(re);M(he).items.push({key:re,value:ce,relativeKey:he.relativeKey,options:ue})}return Promise.all([...R.values()].map($=>C($))).then($=>$.flat())},w={hasItem(v,E={}){v=ur(v);const{relativeKey:C,driver:R}=r(v);return jt(R.hasItem,C,E)},getItem(v,E={}){v=ur(v);const{relativeKey:C,driver:R}=r(v);return jt(R.getItem,C,E).then(M=>ra(M))},getItems(v,E){return y(v,E,C=>C.driver.getItems?jt(C.driver.getItems,C.items.map(R=>({key:R.relativeKey,options:R.options})),E).then(R=>R.map(M=>({key:Gm(C.base,M.key),value:ra(M.value)}))):Promise.all(C.items.map(R=>jt(C.driver.getItem,R.relativeKey,R.options).then(M=>({key:R.key,value:ra(M)})))))},getItemRaw(v,E={}){v=ur(v);const{relativeKey:C,driver:R}=r(v);return R.getItemRaw?jt(R.getItemRaw,C,E):jt(R.getItem,C,E).then(M=>Vm(M))},async setItem(v,E,C={}){if(E===void 0)return w.removeItem(v);v=ur(v);const{relativeKey:R,driver:M}=r(v);M.setItem&&(await jt(M.setItem,R,ua(E),C),M.watch||a("update",v))},async setItems(v,E){await y(v,E,async C=>{C.driver.setItems&&await jt(C.driver.setItems,C.items.map(R=>({key:R.relativeKey,value:ua(R.value),options:R.options})),E),C.driver.setItem&&await Promise.all(C.items.map(R=>jt(C.driver.setItem,R.relativeKey,ua(R.value),R.options)))})},async setItemRaw(v,E,C={}){if(E===void 0)return w.removeItem(v,C);v=ur(v);const{relativeKey:R,driver:M}=r(v);if(M.setItemRaw)await jt(M.setItemRaw,R,E,C);else if(M.setItem)await jt(M.setItem,R,Bm(E),C);else return;M.watch||a("update",v)},async removeItem(v,E={}){typeof E=="boolean"&&(E={removeMeta:E}),v=ur(v);const{relativeKey:C,driver:R}=r(v);R.removeItem&&(await jt(R.removeItem,C,E),(E.removeMeta||E.removeMata)&&await jt(R.removeItem,C+"$",E),R.watch||a("remove",v))},async getMeta(v,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),v=ur(v);const{relativeKey:C,driver:R}=r(v),M=Object.create(null);if(R.getMeta&&Object.assign(M,await jt(R.getMeta,C,E)),!E.nativeOnly){const $=await jt(R.getItem,C+"$",E).then(K=>ra(K));$&&typeof $=="object"&&(typeof $.atime=="string"&&($.atime=new Date($.atime)),typeof $.mtime=="string"&&($.mtime=new Date($.mtime)),Object.assign(M,$))}return M},setMeta(v,E,C={}){return this.setItem(v+"$",E,C)},removeMeta(v,E={}){return this.removeItem(v+"$",E)},async getKeys(v,E={}){v=ia(v);const C=n(v,!0);let R=[];const M=[];for(const $ of C){const re=(await jt($.driver.getKeys,$.relativeBase,E)).map(ce=>$.mountpoint+ur(ce)).filter(ce=>!R.some(ue=>ce.startsWith(ue)));M.push(...re),R=[$.mountpoint,...R.filter(ce=>!ce.startsWith($.mountpoint))]}return v?M.filter($=>$.startsWith(v)&&!$.endsWith("$")):M.filter($=>!$.endsWith("$"))},async clear(v,E={}){v=ia(v),await Promise.all(n(v,!1).map(async C=>{if(C.driver.clear)return jt(C.driver.clear,C.relativeBase,E);if(C.driver.removeItem){const R=await C.driver.getKeys(C.relativeBase||"",E);return Promise.all(R.map(M=>C.driver.removeItem(M,E)))}}))},async dispose(){await Promise.all(Object.values(i.mounts).map(v=>Fh(v)))},async watch(v){return await l(),i.watchListeners.push(v),async()=>{i.watchListeners=i.watchListeners.filter(E=>E!==v),i.watchListeners.length===0&&await d()}},async unwatch(){i.watchListeners=[],await d()},mount(v,E){if(v=ia(v),v&&i.mounts[v])throw new Error(`already mounted at ${v}`);return v&&(i.mountpoints.push(v),i.mountpoints.sort((C,R)=>R.length-C.length)),i.mounts[v]=E,i.watching&&Promise.resolve(Nh(E,a,v)).then(C=>{i.unwatch[v]=C}).catch(console.error),w},async unmount(v,E=!0){v=ia(v),!(!v||!i.mounts[v])&&(i.watching&&v in i.unwatch&&(i.unwatch[v](),delete i.unwatch[v]),E&&await Fh(i.mounts[v]),i.mountpoints=i.mountpoints.filter(C=>C!==v),delete i.mounts[v])},getMount(v=""){v=ur(v)+":";const E=r(v);return{driver:E.driver,base:E.base}},getMounts(v="",E={}){return v=ur(v),n(v,E.parents).map(R=>({driver:R.driver,base:R.mountpoint}))}};return w}function Nh(c,i,r){return c.watch?c.watch((n,a)=>i(n,r+a)):()=>{}}async function Fh(c){typeof c.dispose=="function"&&await jt(c.dispose)}function ji(c){return new Promise((i,r)=>{c.oncomplete=c.onsuccess=()=>i(c.result),c.onabort=c.onerror=()=>r(c.error)})}function Ll(c,i){const r=indexedDB.open(c);r.onupgradeneeded=()=>r.result.createObjectStore(i);const n=ji(r);return(a,l)=>n.then(d=>l(d.transaction(i,a).objectStore(i)))}let Vo;function Gs(){return Vo||(Vo=Ll("keyval-store","keyval")),Vo}function $h(c,i=Gs()){return i("readonly",r=>ji(r.get(c)))}function Ym(c,i,r=Gs()){return r("readwrite",n=>(n.put(i,c),ji(n.transaction)))}function Xm(c,i=Gs()){return i("readwrite",r=>(r.delete(c),ji(r.transaction)))}function Zm(c=Gs()){return c("readwrite",i=>(i.clear(),ji(i.transaction)))}function e1(c,i){return c.openCursor().onsuccess=function(){this.result&&(i(this.result),this.result.continue())},ji(c.transaction)}function t1(c=Gs()){return c("readonly",i=>{if(i.getAllKeys)return ji(i.getAllKeys());const r=[];return e1(i,n=>r.push(n.key)).then(()=>r)})}const r1="idb-keyval";var i1=(c={})=>{const i=c.base&&c.base.length>0?`${c.base}:`:"",r=a=>i+a;let n;return c.dbName&&c.storeName&&(n=Ll(c.dbName,c.storeName)),{name:r1,options:c,async hasItem(a){return!(typeof await $h(r(a),n)>"u")},async getItem(a){return await $h(r(a),n)??null},setItem(a,l){return Ym(r(a),l,n)},removeItem(a){return Xm(r(a),n)},getKeys(){return t1(n)},clear(){return Zm(n)}}};const s1="WALLET_CONNECT_V2_INDEXED_DB",n1="keyvaluestorage";let a1=class{constructor(){this.indexedDb=Qm({driver:i1({dbName:s1,storeName:n1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){const r=await this.indexedDb.getItem(i);if(r!==null)return r}async setItem(i,r){await this.indexedDb.setItem(i,Vs(r))}async removeItem(i){await this.indexedDb.removeItem(i)}};var Go=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ha={exports:{}};(function(){let c;function i(){}c=i,c.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},c.prototype.setItem=function(r,n){this[r]=String(n)},c.prototype.removeItem=function(r){delete this[r]},c.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},c.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Go<"u"&&Go.localStorage?ha.exports=Go.localStorage:typeof window<"u"&&window.localStorage?ha.exports=window.localStorage:ha.exports=new i})();function o1(c){var i;return[c[0],va((i=c[1])!=null?i:"")]}let c1=class{constructor(){this.localStorage=ha.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(o1)}async getItem(i){const r=this.localStorage.getItem(i);if(r!==null)return va(r)}async setItem(i,r){this.localStorage.setItem(i,Vs(r))}async removeItem(i){this.localStorage.removeItem(i)}};const u1="wc_storage_version",Dh=1,h1=async(c,i,r)=>{const n=u1,a=await i.getItem(n);if(a&&a>=Dh){r(i);return}const l=await c.getKeys();if(!l.length){r(i);return}const d=[];for(;l.length;){const y=l.shift();if(!y)continue;const w=y.toLowerCase();if(w.includes("wc@")||w.includes("walletconnect")||w.includes("wc_")||w.includes("wallet_connect")){const v=await c.getItem(y);await i.setItem(y,v),d.push(y)}}await i.setItem(n,Dh),r(i),l1(c,d)},l1=async(c,i)=>{i.length&&i.forEach(async r=>{await c.removeItem(r)})};let f1=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const i=new c1;this.storage=i;try{const r=new a1;h1(i,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,r){return await this.initialize(),this.storage.setItem(i,r)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),i())},20)})}};var ps={},Fs={},Wo={},$s={};class Ui{}const p1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ui},Symbol.toStringTag,{value:"Module"})),d1=ky(p1);var Lh;function g1(){if(Lh)return $s;Lh=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.IHeartBeat=void 0;const c=d1;class i extends c.IEvents{constructor(n){super()}}return $s.IHeartBeat=i,$s}var qh;function ql(){return qh||(qh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Bs.__exportStar(g1(),c)}(Wo)),Wo}var Jo={},zi={},zh;function v1(){if(zh)return zi;zh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.HEARTBEAT_EVENTS=zi.HEARTBEAT_INTERVAL=void 0;const c=ie;return zi.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,zi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},zi}var Mh;function zl(){return Mh||(Mh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Bs.__exportStar(v1(),c)}(Jo)),Jo}var jh;function y1(){if(jh)return Fs;jh=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.HeartBeat=void 0;const c=Bs,i=kr,r=ie,n=ql(),a=zl();class l extends n.IHeartBeat{constructor(y){super(y),this.events=new i.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=y?.interval||a.HEARTBEAT_INTERVAL}static init(y){return c.__awaiter(this,void 0,void 0,function*(){const w=new l(y);return yield w.init(),w})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(y,w){this.events.on(y,w)}once(y,w){this.events.once(y,w)}off(y,w){this.events.off(y,w)}removeListener(y,w){this.events.removeListener(y,w)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Fs.HeartBeat=l,Fs}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=Bs;i.__exportStar(y1(),c),i.__exportStar(ql(),c),i.__exportStar(zl(),c)})(ps);var Ae={},Qo,Uh;function m1(){if(Uh)return Qo;Uh=1;function c(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Qo=i;function i(r,n,a){var l=a&&a.stringify||c,d=1;if(typeof r=="object"&&r!==null){var y=n.length+d;if(y===1)return r;var w=new Array(y);w[0]=l(r);for(var v=1;v<y;v++)w[v]=l(n[v]);return w.join(" ")}if(typeof r!="string")return r;var E=n.length;if(E===0)return r;for(var C="",R=1-d,M=-1,$=r&&r.length||0,K=0;K<$;){if(r.charCodeAt(K)===37&&K+1<$){switch(M=M>-1?M:0,r.charCodeAt(K+1)){case 100:case 102:if(R>=E||n[R]==null)break;M<K&&(C+=r.slice(M,K)),C+=Number(n[R]),M=K+2,K++;break;case 105:if(R>=E||n[R]==null)break;M<K&&(C+=r.slice(M,K)),C+=Math.floor(Number(n[R])),M=K+2,K++;break;case 79:case 111:case 106:if(R>=E||n[R]===void 0)break;M<K&&(C+=r.slice(M,K));var re=typeof n[R];if(re==="string"){C+="'"+n[R]+"'",M=K+2,K++;break}if(re==="function"){C+=n[R].name||"<anonymous>",M=K+2,K++;break}C+=l(n[R]),M=K+2,K++;break;case 115:if(R>=E)break;M<K&&(C+=r.slice(M,K)),C+=String(n[R]),M=K+2,K++;break;case 37:M<K&&(C+=r.slice(M,K)),C+="%",M=K+2,K++,R--;break}++R}++K}return M===-1?r:(M<$&&(C+=r.slice(M)),C)}return Qo}var Yo,Hh;function w1(){if(Hh)return Yo;Hh=1;const c=m1();Yo=a;const i=pe().console||{},r={mapHttpRequest:$,mapHttpResponse:$,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:$,res:$,err:R};function n(F,H){return Array.isArray(F)?F.filter(function(ve){return ve!=="!stdSerializers.err"}):F===!0?Object.keys(H):!1}function a(F){F=F||{},F.browser=F.browser||{};const H=F.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const W=F.browser.write||i;F.browser.write&&(F.browser.asObject=!0);const ve=F.serializers||{},te=n(F.browser.serialize,ve);let Ee=F.browser.serialize;Array.isArray(F.browser.serialize)&&F.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Ee=!1);const Oe=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),F.enabled===!1&&(F.level="silent");const et=F.level||"info",O=Object.create(W);O.log||(O.log=re),Object.defineProperty(O,"levelVal",{get:Me}),Object.defineProperty(O,"level",{get:Re,set:J});const z={transmit:H,serialize:te,asObject:F.browser.asObject,levels:Oe,timestamp:M(F)};O.levels=a.levels,O.level=et,O.setMaxListeners=O.getMaxListeners=O.emit=O.addListener=O.on=O.prependListener=O.once=O.prependOnceListener=O.removeListener=O.removeAllListeners=O.listeners=O.listenerCount=O.eventNames=O.write=O.flush=re,O.serializers=ve,O._serialize=te,O._stdErrSerialize=Ee,O.child=B,H&&(O._logEvent=C());function Me(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Re(){return this._level}function J(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,l(z,O,"error","log"),l(z,O,"fatal","error"),l(z,O,"warn","error"),l(z,O,"info","log"),l(z,O,"debug","log"),l(z,O,"trace","log")}function B(k,V){if(!k)throw new Error("missing bindings for child Pino");V=V||{},te&&k.serializers&&(V.serializers=k.serializers);const ut=V.serializers;if(te&&ut){var He=Object.assign({},ve,ut),Dr=F.browser.serialize===!0?Object.keys(He):te;delete k.serializers,w([k],Dr,He,this._stdErrSerialize)}function _e(It){this._childLevel=(It._childLevel|0)+1,this.error=v(It,k,"error"),this.fatal=v(It,k,"fatal"),this.warn=v(It,k,"warn"),this.info=v(It,k,"info"),this.debug=v(It,k,"debug"),this.trace=v(It,k,"trace"),He&&(this.serializers=He,this._serialize=Dr),H&&(this._logEvent=C([].concat(It._logEvent.bindings,k)))}return _e.prototype=this,new _e(this)}return O}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ce,epochTime:ue,unixTime:he,isoTime:fe});function l(F,H,W,ve){const te=Object.getPrototypeOf(H);H[W]=H.levelVal>H.levels.values[W]?re:te[W]?te[W]:i[W]||i[ve]||re,d(F,H,W)}function d(F,H,W){!F.transmit&&H[W]===re||(H[W]=function(ve){return function(){const Ee=F.timestamp(),Oe=new Array(arguments.length),et=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var O=0;O<Oe.length;O++)Oe[O]=arguments[O];if(F.serialize&&!F.asObject&&w(Oe,this._serialize,this.serializers,this._stdErrSerialize),F.asObject?ve.call(et,y(this,W,Oe,Ee)):ve.apply(et,Oe),F.transmit){const z=F.transmit.level||H.level,Me=a.levels.values[z],Re=a.levels.values[W];if(Re<Me)return;E(this,{ts:Ee,methodLevel:W,methodValue:Re,transmitLevel:z,transmitValue:a.levels.values[F.transmit.level||H.level],send:F.transmit.send,val:H.levelVal},Oe)}}}(H[W]))}function y(F,H,W,ve){F._serialize&&w(W,F._serialize,F.serializers,F._stdErrSerialize);const te=W.slice();let Ee=te[0];const Oe={};ve&&(Oe.time=ve),Oe.level=a.levels.values[H];let et=(F._childLevel|0)+1;if(et<1&&(et=1),Ee!==null&&typeof Ee=="object"){for(;et--&&typeof te[0]=="object";)Object.assign(Oe,te.shift());Ee=te.length?c(te.shift(),te):void 0}else typeof Ee=="string"&&(Ee=c(te.shift(),te));return Ee!==void 0&&(Oe.msg=Ee),Oe}function w(F,H,W,ve){for(const te in F)if(ve&&F[te]instanceof Error)F[te]=a.stdSerializers.err(F[te]);else if(typeof F[te]=="object"&&!Array.isArray(F[te]))for(const Ee in F[te])H&&H.indexOf(Ee)>-1&&Ee in W&&(F[te][Ee]=W[Ee](F[te][Ee]))}function v(F,H,W){return function(){const ve=new Array(1+arguments.length);ve[0]=H;for(var te=1;te<ve.length;te++)ve[te]=arguments[te-1];return F[W].apply(this,ve)}}function E(F,H,W){const ve=H.send,te=H.ts,Ee=H.methodLevel,Oe=H.methodValue,et=H.val,O=F._logEvent.bindings;w(W,F._serialize||Object.keys(F.serializers),F.serializers,F._stdErrSerialize===void 0?!0:F._stdErrSerialize),F._logEvent.ts=te,F._logEvent.messages=W.filter(function(z){return O.indexOf(z)===-1}),F._logEvent.level.label=Ee,F._logEvent.level.value=Oe,ve(Ee,F._logEvent,et),F._logEvent=C(O)}function C(F){return{ts:0,messages:[],bindings:F||[],level:{label:"",value:0}}}function R(F){const H={type:F.constructor.name,msg:F.message,stack:F.stack};for(const W in F)H[W]===void 0&&(H[W]=F[W]);return H}function M(F){return typeof F.timestamp=="function"?F.timestamp:F.timestamp===!1?ce:ue}function $(){return{}}function K(F){return F}function re(){}function ce(){return!1}function ue(){return Date.now()}function he(){return Math.round(Date.now()/1e3)}function fe(){return new Date(Date.now()).toISOString()}function pe(){function F(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return F(self)||F(window)||F(this)||{}}}return Yo}var Mi={},kh;function Ml(){return kh||(kh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.PINO_CUSTOM_CONTEXT_KEY=Mi.PINO_LOGGER_DEFAULTS=void 0,Mi.PINO_LOGGER_DEFAULTS={level:"info"},Mi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Mi}var er={},Kh;function _1(){if(Kh)return er;Kh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const c=Ml();function i(y){return Object.assign(Object.assign({},y),{level:y?.level||c.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=i;function r(y,w=c.PINO_CUSTOM_CONTEXT_KEY){return y[w]||""}er.getBrowserLoggerContext=r;function n(y,w,v=c.PINO_CUSTOM_CONTEXT_KEY){return y[v]=w,y}er.setBrowserLoggerContext=n;function a(y,w=c.PINO_CUSTOM_CONTEXT_KEY){let v="";return typeof y.bindings>"u"?v=r(y,w):v=y.bindings().context||"",v}er.getLoggerContext=a;function l(y,w,v=c.PINO_CUSTOM_CONTEXT_KEY){const E=a(y,v);return E.trim()?`${E}/${w}`:w}er.formatChildLoggerContext=l;function d(y,w,v=c.PINO_CUSTOM_CONTEXT_KEY){const E=l(y,w,v),C=y.child({context:E});return n(C,E,v)}return er.generateChildLogger=d,er}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const i=Bs,r=i.__importDefault(w1());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(Ml(),c),i.__exportStar(_1(),c)})(Ae);class b1 extends Ui{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class E1 extends Ui{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class I1{constructor(i,r){this.logger=i,this.core=r}}let x1=class extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}},P1=class extends Ui{constructor(i){super()}},S1=class{constructor(i,r,n,a){this.core=i,this.logger=r,this.name=n}};class C1 extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}}let A1=class extends Ui{constructor(i,r){super(),this.core=i,this.logger=r}},O1=class{constructor(i,r){this.projectId=i,this.logger=r}},R1=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},T1=class{constructor(i){this.client=i}};var bc={},jl={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var i=Ky,r=Cl;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function y(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},y.prototype.update=function(w,v){if(v===void 0&&(v=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=v,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&v>0;)this._buffer[this._bufferLength++]=w[E++],v--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(v>=this.blockSize&&(E=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,E,v),v%=this.blockSize);v>0;)this._buffer[this._bufferLength++]=w[E++],v--;return this},y.prototype.finish=function(w){if(!this._finished){var v=this._bytesHashed,E=this._bufferLength,C=v/536870912|0,R=v<<3,M=v%128<112?128:256;this._buffer[E]=128;for(var $=E+1;$<M-8;$++)this._buffer[$]=0;i.writeUint32BE(C,this._buffer,M-8),i.writeUint32BE(R,this._buffer,M-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,M),this._finished=!0}for(var $=0;$<this.digestLength/8;$++)i.writeUint32BE(this._stateHi[$],w,$*8),i.writeUint32BE(this._stateLo[$],w,$*8+4);return this},y.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(w){r.wipe(w.stateHi),r.wipe(w.stateLo),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},y}();c.SHA512=n;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(y,w,v,E,C,R,M){for(var $=v[0],K=v[1],re=v[2],ce=v[3],ue=v[4],he=v[5],fe=v[6],pe=v[7],F=E[0],H=E[1],W=E[2],ve=E[3],te=E[4],Ee=E[5],Oe=E[6],et=E[7],O,z,Me,Re,J,B,k,V;M>=128;){for(var ut=0;ut<16;ut++){var He=8*ut+R;y[ut]=i.readUint32BE(C,He),w[ut]=i.readUint32BE(C,He+4)}for(var ut=0;ut<80;ut++){var Dr=$,_e=K,It=re,N=ce,T=ue,S=he,u=fe,b=pe,Z=F,oe=H,me=W,Te=ve,Fe=te,xe=Ee,xt=Oe,mt=et;if(O=pe,z=et,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=(ue>>>14|te<<32-14)^(ue>>>18|te<<32-18)^(te>>>41-32|ue<<32-(41-32)),z=(te>>>14|ue<<32-14)^(te>>>18|ue<<32-18)^(ue>>>41-32|te<<32-(41-32)),J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,O=ue&he^~ue&fe,z=te&Ee^~te&Oe,J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,O=a[ut*2],z=a[ut*2+1],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,O=y[ut%16],z=w[ut%16],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,Me=k&65535|V<<16,Re=J&65535|B<<16,O=Me,z=Re,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=($>>>28|F<<32-28)^(F>>>34-32|$<<32-(34-32))^(F>>>39-32|$<<32-(39-32)),z=(F>>>28|$<<32-28)^($>>>34-32|F<<32-(34-32))^($>>>39-32|F<<32-(39-32)),J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,O=$&K^$&re^K&re,z=F&H^F&W^H&W,J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,b=k&65535|V<<16,mt=J&65535|B<<16,O=N,z=Te,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=Me,z=Re,J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,N=k&65535|V<<16,Te=J&65535|B<<16,K=Dr,re=_e,ce=It,ue=N,he=T,fe=S,pe=u,$=b,H=Z,W=oe,ve=me,te=Te,Ee=Fe,Oe=xe,et=xt,F=mt,ut%16===15)for(var He=0;He<16;He++)O=y[He],z=w[He],J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=y[(He+9)%16],z=w[(He+9)%16],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,Me=y[(He+1)%16],Re=w[(He+1)%16],O=(Me>>>1|Re<<32-1)^(Me>>>8|Re<<32-8)^Me>>>7,z=(Re>>>1|Me<<32-1)^(Re>>>8|Me<<32-8)^(Re>>>7|Me<<32-7),J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,Me=y[(He+14)%16],Re=w[(He+14)%16],O=(Me>>>19|Re<<32-19)^(Re>>>61-32|Me<<32-(61-32))^Me>>>6,z=(Re>>>19|Me<<32-19)^(Me>>>61-32|Re<<32-(61-32))^(Re>>>6|Me<<32-6),J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,y[He]=k&65535|V<<16,w[He]=J&65535|B<<16}O=$,z=F,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[0],z=E[0],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[0]=$=k&65535|V<<16,E[0]=F=J&65535|B<<16,O=K,z=H,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[1],z=E[1],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[1]=K=k&65535|V<<16,E[1]=H=J&65535|B<<16,O=re,z=W,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[2],z=E[2],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[2]=re=k&65535|V<<16,E[2]=W=J&65535|B<<16,O=ce,z=ve,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[3],z=E[3],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[3]=ce=k&65535|V<<16,E[3]=ve=J&65535|B<<16,O=ue,z=te,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[4],z=E[4],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[4]=ue=k&65535|V<<16,E[4]=te=J&65535|B<<16,O=he,z=Ee,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[5],z=E[5],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[5]=he=k&65535|V<<16,E[5]=Ee=J&65535|B<<16,O=fe,z=Oe,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[6],z=E[6],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[6]=fe=k&65535|V<<16,E[6]=Oe=J&65535|B<<16,O=pe,z=et,J=z&65535,B=z>>>16,k=O&65535,V=O>>>16,O=v[7],z=E[7],J+=z&65535,B+=z>>>16,k+=O&65535,V+=O>>>16,B+=J>>>16,k+=B>>>16,V+=k>>>16,v[7]=pe=k&65535|V<<16,E[7]=et=J&65535|B<<16,R+=128,M-=128}return R}function d(y){var w=new n;w.update(y);var v=w.digest();return w.clean(),v}c.hash=d})(jl);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const i=Al,r=jl,n=Cl;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function a(N){const T=new Float64Array(16);if(N)for(let S=0;S<N.length;S++)T[S]=N[S];return T}const l=new Uint8Array(32);l[0]=9;const d=a(),y=a([1]),w=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),C=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),R=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function M(N,T){for(let S=0;S<16;S++)N[S]=T[S]|0}function $(N){let T=1;for(let S=0;S<16;S++){let u=N[S]+T+65535;T=Math.floor(u/65536),N[S]=u-T*65536}N[0]+=T-1+37*(T-1)}function K(N,T,S){const u=~(S-1);for(let b=0;b<16;b++){const Z=u&(N[b]^T[b]);N[b]^=Z,T[b]^=Z}}function re(N,T){const S=a(),u=a();for(let b=0;b<16;b++)u[b]=T[b];$(u),$(u),$(u);for(let b=0;b<2;b++){S[0]=u[0]-65517;for(let oe=1;oe<15;oe++)S[oe]=u[oe]-65535-(S[oe-1]>>16&1),S[oe-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const Z=S[15]>>16&1;S[14]&=65535,K(u,S,1-Z)}for(let b=0;b<16;b++)N[2*b]=u[b]&255,N[2*b+1]=u[b]>>8}function ce(N,T){let S=0;for(let u=0;u<32;u++)S|=N[u]^T[u];return(1&S-1>>>8)-1}function ue(N,T){const S=new Uint8Array(32),u=new Uint8Array(32);return re(S,N),re(u,T),ce(S,u)}function he(N){const T=new Uint8Array(32);return re(T,N),T[0]&1}function fe(N,T){for(let S=0;S<16;S++)N[S]=T[2*S]+(T[2*S+1]<<8);N[15]&=32767}function pe(N,T,S){for(let u=0;u<16;u++)N[u]=T[u]+S[u]}function F(N,T,S){for(let u=0;u<16;u++)N[u]=T[u]-S[u]}function H(N,T,S){let u,b,Z=0,oe=0,me=0,Te=0,Fe=0,xe=0,xt=0,mt=0,nt=0,De=0,Je=0,Qe=0,at=0,je=0,Ye=0,Ne=0,ke=0,ht=0,qe=0,Pt=0,$t=0,Ut=0,Ht=0,qt=0,Wt=0,rr=0,Lr=0,Jt=0,Kr=0,oi=0,xi=0,lt=S[0],tt=S[1],ft=S[2],pt=S[3],ot=S[4],rt=S[5],St=S[6],Ct=S[7],dt=S[8],At=S[9],gt=S[10],wt=S[11],vt=S[12],We=S[13],Ot=S[14],Rt=S[15];u=T[0],Z+=u*lt,oe+=u*tt,me+=u*ft,Te+=u*pt,Fe+=u*ot,xe+=u*rt,xt+=u*St,mt+=u*Ct,nt+=u*dt,De+=u*At,Je+=u*gt,Qe+=u*wt,at+=u*vt,je+=u*We,Ye+=u*Ot,Ne+=u*Rt,u=T[1],oe+=u*lt,me+=u*tt,Te+=u*ft,Fe+=u*pt,xe+=u*ot,xt+=u*rt,mt+=u*St,nt+=u*Ct,De+=u*dt,Je+=u*At,Qe+=u*gt,at+=u*wt,je+=u*vt,Ye+=u*We,Ne+=u*Ot,ke+=u*Rt,u=T[2],me+=u*lt,Te+=u*tt,Fe+=u*ft,xe+=u*pt,xt+=u*ot,mt+=u*rt,nt+=u*St,De+=u*Ct,Je+=u*dt,Qe+=u*At,at+=u*gt,je+=u*wt,Ye+=u*vt,Ne+=u*We,ke+=u*Ot,ht+=u*Rt,u=T[3],Te+=u*lt,Fe+=u*tt,xe+=u*ft,xt+=u*pt,mt+=u*ot,nt+=u*rt,De+=u*St,Je+=u*Ct,Qe+=u*dt,at+=u*At,je+=u*gt,Ye+=u*wt,Ne+=u*vt,ke+=u*We,ht+=u*Ot,qe+=u*Rt,u=T[4],Fe+=u*lt,xe+=u*tt,xt+=u*ft,mt+=u*pt,nt+=u*ot,De+=u*rt,Je+=u*St,Qe+=u*Ct,at+=u*dt,je+=u*At,Ye+=u*gt,Ne+=u*wt,ke+=u*vt,ht+=u*We,qe+=u*Ot,Pt+=u*Rt,u=T[5],xe+=u*lt,xt+=u*tt,mt+=u*ft,nt+=u*pt,De+=u*ot,Je+=u*rt,Qe+=u*St,at+=u*Ct,je+=u*dt,Ye+=u*At,Ne+=u*gt,ke+=u*wt,ht+=u*vt,qe+=u*We,Pt+=u*Ot,$t+=u*Rt,u=T[6],xt+=u*lt,mt+=u*tt,nt+=u*ft,De+=u*pt,Je+=u*ot,Qe+=u*rt,at+=u*St,je+=u*Ct,Ye+=u*dt,Ne+=u*At,ke+=u*gt,ht+=u*wt,qe+=u*vt,Pt+=u*We,$t+=u*Ot,Ut+=u*Rt,u=T[7],mt+=u*lt,nt+=u*tt,De+=u*ft,Je+=u*pt,Qe+=u*ot,at+=u*rt,je+=u*St,Ye+=u*Ct,Ne+=u*dt,ke+=u*At,ht+=u*gt,qe+=u*wt,Pt+=u*vt,$t+=u*We,Ut+=u*Ot,Ht+=u*Rt,u=T[8],nt+=u*lt,De+=u*tt,Je+=u*ft,Qe+=u*pt,at+=u*ot,je+=u*rt,Ye+=u*St,Ne+=u*Ct,ke+=u*dt,ht+=u*At,qe+=u*gt,Pt+=u*wt,$t+=u*vt,Ut+=u*We,Ht+=u*Ot,qt+=u*Rt,u=T[9],De+=u*lt,Je+=u*tt,Qe+=u*ft,at+=u*pt,je+=u*ot,Ye+=u*rt,Ne+=u*St,ke+=u*Ct,ht+=u*dt,qe+=u*At,Pt+=u*gt,$t+=u*wt,Ut+=u*vt,Ht+=u*We,qt+=u*Ot,Wt+=u*Rt,u=T[10],Je+=u*lt,Qe+=u*tt,at+=u*ft,je+=u*pt,Ye+=u*ot,Ne+=u*rt,ke+=u*St,ht+=u*Ct,qe+=u*dt,Pt+=u*At,$t+=u*gt,Ut+=u*wt,Ht+=u*vt,qt+=u*We,Wt+=u*Ot,rr+=u*Rt,u=T[11],Qe+=u*lt,at+=u*tt,je+=u*ft,Ye+=u*pt,Ne+=u*ot,ke+=u*rt,ht+=u*St,qe+=u*Ct,Pt+=u*dt,$t+=u*At,Ut+=u*gt,Ht+=u*wt,qt+=u*vt,Wt+=u*We,rr+=u*Ot,Lr+=u*Rt,u=T[12],at+=u*lt,je+=u*tt,Ye+=u*ft,Ne+=u*pt,ke+=u*ot,ht+=u*rt,qe+=u*St,Pt+=u*Ct,$t+=u*dt,Ut+=u*At,Ht+=u*gt,qt+=u*wt,Wt+=u*vt,rr+=u*We,Lr+=u*Ot,Jt+=u*Rt,u=T[13],je+=u*lt,Ye+=u*tt,Ne+=u*ft,ke+=u*pt,ht+=u*ot,qe+=u*rt,Pt+=u*St,$t+=u*Ct,Ut+=u*dt,Ht+=u*At,qt+=u*gt,Wt+=u*wt,rr+=u*vt,Lr+=u*We,Jt+=u*Ot,Kr+=u*Rt,u=T[14],Ye+=u*lt,Ne+=u*tt,ke+=u*ft,ht+=u*pt,qe+=u*ot,Pt+=u*rt,$t+=u*St,Ut+=u*Ct,Ht+=u*dt,qt+=u*At,Wt+=u*gt,rr+=u*wt,Lr+=u*vt,Jt+=u*We,Kr+=u*Ot,oi+=u*Rt,u=T[15],Ne+=u*lt,ke+=u*tt,ht+=u*ft,qe+=u*pt,Pt+=u*ot,$t+=u*rt,Ut+=u*St,Ht+=u*Ct,qt+=u*dt,Wt+=u*At,rr+=u*gt,Lr+=u*wt,Jt+=u*vt,Kr+=u*We,oi+=u*Ot,xi+=u*Rt,Z+=38*ke,oe+=38*ht,me+=38*qe,Te+=38*Pt,Fe+=38*$t,xe+=38*Ut,xt+=38*Ht,mt+=38*qt,nt+=38*Wt,De+=38*rr,Je+=38*Lr,Qe+=38*Jt,at+=38*Kr,je+=38*oi,Ye+=38*xi,b=1,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=Te+b+65535,b=Math.floor(u/65536),Te=u-b*65536,u=Fe+b+65535,b=Math.floor(u/65536),Fe=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=xt+b+65535,b=Math.floor(u/65536),xt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=nt+b+65535,b=Math.floor(u/65536),nt=u-b*65536,u=De+b+65535,b=Math.floor(u/65536),De=u-b*65536,u=Je+b+65535,b=Math.floor(u/65536),Je=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=je+b+65535,b=Math.floor(u/65536),je=u-b*65536,u=Ye+b+65535,b=Math.floor(u/65536),Ye=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,Z+=b-1+37*(b-1),b=1,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=Te+b+65535,b=Math.floor(u/65536),Te=u-b*65536,u=Fe+b+65535,b=Math.floor(u/65536),Fe=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=xt+b+65535,b=Math.floor(u/65536),xt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=nt+b+65535,b=Math.floor(u/65536),nt=u-b*65536,u=De+b+65535,b=Math.floor(u/65536),De=u-b*65536,u=Je+b+65535,b=Math.floor(u/65536),Je=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=je+b+65535,b=Math.floor(u/65536),je=u-b*65536,u=Ye+b+65535,b=Math.floor(u/65536),Ye=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,Z+=b-1+37*(b-1),N[0]=Z,N[1]=oe,N[2]=me,N[3]=Te,N[4]=Fe,N[5]=xe,N[6]=xt,N[7]=mt,N[8]=nt,N[9]=De,N[10]=Je,N[11]=Qe,N[12]=at,N[13]=je,N[14]=Ye,N[15]=Ne}function W(N,T){H(N,T,T)}function ve(N,T){const S=a();let u;for(u=0;u<16;u++)S[u]=T[u];for(u=253;u>=0;u--)W(S,S),u!==2&&u!==4&&H(S,S,T);for(u=0;u<16;u++)N[u]=S[u]}function te(N,T){const S=a();let u;for(u=0;u<16;u++)S[u]=T[u];for(u=250;u>=0;u--)W(S,S),u!==1&&H(S,S,T);for(u=0;u<16;u++)N[u]=S[u]}function Ee(N,T){const S=a(),u=a(),b=a(),Z=a(),oe=a(),me=a(),Te=a(),Fe=a(),xe=a();F(S,N[1],N[0]),F(xe,T[1],T[0]),H(S,S,xe),pe(u,N[0],N[1]),pe(xe,T[0],T[1]),H(u,u,xe),H(b,N[3],T[3]),H(b,b,v),H(Z,N[2],T[2]),pe(Z,Z,Z),F(oe,u,S),F(me,Z,b),pe(Te,Z,b),pe(Fe,u,S),H(N[0],oe,me),H(N[1],Fe,Te),H(N[2],Te,me),H(N[3],oe,Fe)}function Oe(N,T,S){for(let u=0;u<4;u++)K(N[u],T[u],S)}function et(N,T){const S=a(),u=a(),b=a();ve(b,T[2]),H(S,T[0],b),H(u,T[1],b),re(N,u),N[31]^=he(S)<<7}function O(N,T,S){M(N[0],d),M(N[1],y),M(N[2],y),M(N[3],d);for(let u=255;u>=0;--u){const b=S[u/8|0]>>(u&7)&1;Oe(N,T,b),Ee(T,N),Ee(N,N),Oe(N,T,b)}}function z(N,T){const S=[a(),a(),a(),a()];M(S[0],E),M(S[1],C),M(S[2],y),H(S[3],E,C),O(N,S,T)}function Me(N){if(N.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const T=(0,r.hash)(N);T[0]&=248,T[31]&=127,T[31]|=64;const S=new Uint8Array(32),u=[a(),a(),a(),a()];z(u,T),et(S,u);const b=new Uint8Array(64);return b.set(N),b.set(S,32),{publicKey:S,secretKey:b}}c.generateKeyPairFromSeed=Me;function Re(N){const T=(0,i.randomBytes)(32,N),S=Me(T);return(0,n.wipe)(T),S}c.generateKeyPair=Re;function J(N){if(N.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}c.extractPublicKeyFromSecretKey=J;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(N,T){let S,u,b,Z;for(u=63;u>=32;--u){for(S=0,b=u-32,Z=u-12;b<Z;++b)T[b]+=S-16*T[u]*B[b-(u-32)],S=Math.floor((T[b]+128)/256),T[b]-=S*256;T[b]+=S,T[u]=0}for(S=0,b=0;b<32;b++)T[b]+=S-(T[31]>>4)*B[b],S=T[b]>>8,T[b]&=255;for(b=0;b<32;b++)T[b]-=S*B[b];for(u=0;u<32;u++)T[u+1]+=T[u]>>8,N[u]=T[u]&255}function V(N){const T=new Float64Array(64);for(let S=0;S<64;S++)T[S]=N[S];for(let S=0;S<64;S++)N[S]=0;k(N,T)}function ut(N,T){const S=new Float64Array(64),u=[a(),a(),a(),a()],b=(0,r.hash)(N.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const Z=new Uint8Array(64);Z.set(b.subarray(32),32);const oe=new r.SHA512;oe.update(Z.subarray(32)),oe.update(T);const me=oe.digest();oe.clean(),V(me),z(u,me),et(Z,u),oe.reset(),oe.update(Z.subarray(0,32)),oe.update(N.subarray(32)),oe.update(T);const Te=oe.digest();V(Te);for(let Fe=0;Fe<32;Fe++)S[Fe]=me[Fe];for(let Fe=0;Fe<32;Fe++)for(let xe=0;xe<32;xe++)S[Fe+xe]+=Te[Fe]*b[xe];return k(Z.subarray(32),S),Z}c.sign=ut;function He(N,T){const S=a(),u=a(),b=a(),Z=a(),oe=a(),me=a(),Te=a();return M(N[2],y),fe(N[1],T),W(b,N[1]),H(Z,b,w),F(b,b,N[2]),pe(Z,N[2],Z),W(oe,Z),W(me,oe),H(Te,me,oe),H(S,Te,b),H(S,S,Z),te(S,S),H(S,S,b),H(S,S,Z),H(S,S,Z),H(N[0],S,Z),W(u,N[0]),H(u,u,Z),ue(u,b)&&H(N[0],N[0],R),W(u,N[0]),H(u,u,Z),ue(u,b)?-1:(he(N[0])===T[31]>>7&&F(N[0],d,N[0]),H(N[3],N[0],N[1]),0)}function Dr(N,T,S){const u=new Uint8Array(32),b=[a(),a(),a(),a()],Z=[a(),a(),a(),a()];if(S.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(He(Z,N))return!1;const oe=new r.SHA512;oe.update(S.subarray(0,32)),oe.update(N),oe.update(T);const me=oe.digest();return V(me),O(b,Z,me),z(Z,S.subarray(32)),Ee(b,Z),et(u,b),!ce(S,u)}c.verify=Dr;function _e(N){let T=[a(),a(),a(),a()];if(He(T,N))throw new Error("Ed25519: invalid public key");let S=a(),u=a(),b=T[1];pe(S,y,b),F(u,y,b),ve(u,u),H(S,S,u);let Z=new Uint8Array(32);return re(Z,S),Z}c.convertPublicKeyToX25519=_e;function It(N){const T=(0,r.hash)(N.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const S=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),S}c.convertSecretKeyToX25519=It})(bc);const N1="EdDSA",F1="JWT",Ul=".",Hl="base64url",$1="utf8",D1="utf8",L1=":",q1="did",z1="key",Bh="base58btc",M1="z",j1="K36",U1=32;function fa(c){return ga(gc(Vs(c),$1),Hl)}function kl(c){const i=gc(j1,Bh),r=M1+ga(By([i,c]),Bh);return[q1,z1,r].join(L1)}function H1(c){return ga(c,Hl)}function k1(c){return gc([fa(c.header),fa(c.payload)].join(Ul),D1)}function K1(c){return[fa(c.header),fa(c.payload),H1(c.signature)].join(Ul)}function Vh(c=Al.randomBytes(U1)){return bc.generateKeyPairFromSeed(c)}async function B1(c,i,r,n,a=ie.fromMiliseconds(Date.now())){const l={alg:N1,typ:F1},d=kl(n.publicKey),y=a+r,w={iss:d,sub:c,aud:i,iat:a,exp:y},v=k1({header:l,payload:w}),E=bc.sign(n.secretKey,v);return K1({header:l,payload:w,signature:E})}const V1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),G1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Gh=c=>c.split("?")[0],Wh=10,W1=V1();class J1{constructor(i){if(this.url=i,this.events=new kr.EventEmitter,this.registering=!1,!Th(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Vs(i))}catch(n){this.onError(i.id,n)}}register(i=this.url){if(!Th(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,n)=>{const a=Nm.isReactNative()?void 0:{rejectUnauthorized:!Fm(i)},l=new W1(i,[],a);G1()?l.onerror=d=>{const y=d;n(this.emitError(y.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?va(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),a=n.message||n.toString(),l=yc(i,a);this.events.emit("payload",l)}parseError(i,r=this.url){return $m(i,Gh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Wh&&this.events.setMaxListeners(Wh)}emitError(i){const r=this.parseError(new Error(i?.message||`WebSocket connection failed for host: ${Gh(this.url)}`));return this.events.emit("register_error",r),r}}var pa={exports:{}};pa.exports;(function(c,i){var r=200,n="__lodash_hash_undefined__",a=1,l=2,d=9007199254740991,y="[object Arguments]",w="[object Array]",v="[object AsyncFunction]",E="[object Boolean]",C="[object Date]",R="[object Error]",M="[object Function]",$="[object GeneratorFunction]",K="[object Map]",re="[object Number]",ce="[object Null]",ue="[object Object]",he="[object Promise]",fe="[object Proxy]",pe="[object RegExp]",F="[object Set]",H="[object String]",W="[object Symbol]",ve="[object Undefined]",te="[object WeakMap]",Ee="[object ArrayBuffer]",Oe="[object DataView]",et="[object Float32Array]",O="[object Float64Array]",z="[object Int8Array]",Me="[object Int16Array]",Re="[object Int32Array]",J="[object Uint8Array]",B="[object Uint8ClampedArray]",k="[object Uint16Array]",V="[object Uint32Array]",ut=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,Dr=/^(?:0|[1-9]\d*)$/,_e={};_e[et]=_e[O]=_e[z]=_e[Me]=_e[Re]=_e[J]=_e[B]=_e[k]=_e[V]=!0,_e[y]=_e[w]=_e[Ee]=_e[E]=_e[Oe]=_e[C]=_e[R]=_e[M]=_e[K]=_e[re]=_e[ue]=_e[pe]=_e[F]=_e[H]=_e[te]=!1;var It=typeof ea=="object"&&ea&&ea.Object===Object&&ea,N=typeof self=="object"&&self&&self.Object===Object&&self,T=It||N||Function("return this")(),S=i&&!i.nodeType&&i,u=S&&!0&&c&&!c.nodeType&&c,b=u&&u.exports===S,Z=b&&It.process,oe=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=oe&&oe.isTypedArray;function Te(g,I){for(var j=-1,Q=g==null?0:g.length,Be=0,de=[];++j<Q;){var Xe=g[j];I(Xe,j,g)&&(de[Be++]=Xe)}return de}function Fe(g,I){for(var j=-1,Q=I.length,Be=g.length;++j<Q;)g[Be+j]=I[j];return g}function xe(g,I){for(var j=-1,Q=g==null?0:g.length;++j<Q;)if(I(g[j],j,g))return!0;return!1}function xt(g,I){for(var j=-1,Q=Array(g);++j<g;)Q[j]=I(j);return Q}function mt(g){return function(I){return g(I)}}function nt(g,I){return g.has(I)}function De(g,I){return g?.[I]}function Je(g){var I=-1,j=Array(g.size);return g.forEach(function(Q,Be){j[++I]=[Be,Q]}),j}function Qe(g,I){return function(j){return g(I(j))}}function at(g){var I=-1,j=Array(g.size);return g.forEach(function(Q){j[++I]=Q}),j}var je=Array.prototype,Ye=Function.prototype,Ne=Object.prototype,ke=T["__core-js_shared__"],ht=Ye.toString,qe=Ne.hasOwnProperty,Pt=function(){var g=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),$t=Ne.toString,Ut=RegExp("^"+ht.call(qe).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=b?T.Buffer:void 0,qt=T.Symbol,Wt=T.Uint8Array,rr=Ne.propertyIsEnumerable,Lr=je.splice,Jt=qt?qt.toStringTag:void 0,Kr=Object.getOwnPropertySymbols,oi=Ht?Ht.isBuffer:void 0,xi=Qe(Object.keys,Object),lt=lr(T,"DataView"),tt=lr(T,"Map"),ft=lr(T,"Promise"),pt=lr(T,"Set"),ot=lr(T,"WeakMap"),rt=lr(Object,"create"),St=Vr(lt),Ct=Vr(tt),dt=Vr(ft),At=Vr(pt),gt=Vr(ot),wt=qt?qt.prototype:void 0,vt=wt?wt.valueOf:void 0;function We(g){var I=-1,j=g==null?0:g.length;for(this.clear();++I<j;){var Q=g[I];this.set(Q[0],Q[1])}}function Ot(){this.__data__=rt?rt(null):{},this.size=0}function Rt(g){var I=this.has(g)&&delete this.__data__[g];return this.size-=I?1:0,I}function wa(g){var I=this.__data__;if(rt){var j=I[g];return j===n?void 0:j}return qe.call(I,g)?I[g]:void 0}function _a(g){var I=this.__data__;return rt?I[g]!==void 0:qe.call(I,g)}function ba(g,I){var j=this.__data__;return this.size+=this.has(g)?0:1,j[g]=rt&&I===void 0?n:I,this}We.prototype.clear=Ot,We.prototype.delete=Rt,We.prototype.get=wa,We.prototype.has=_a,We.prototype.set=ba;function yr(g){var I=-1,j=g==null?0:g.length;for(this.clear();++I<j;){var Q=g[I];this.set(Q[0],Q[1])}}function Ea(){this.__data__=[],this.size=0}function Ia(g){var I=this.__data__,j=Pi(I,g);if(j<0)return!1;var Q=I.length-1;return j==Q?I.pop():Lr.call(I,j,1),--this.size,!0}function xa(g){var I=this.__data__,j=Pi(I,g);return j<0?void 0:I[j][1]}function Pa(g){return Pi(this.__data__,g)>-1}function Sa(g,I){var j=this.__data__,Q=Pi(j,g);return Q<0?(++this.size,j.push([g,I])):j[Q][1]=I,this}yr.prototype.clear=Ea,yr.prototype.delete=Ia,yr.prototype.get=xa,yr.prototype.has=Pa,yr.prototype.set=Sa;function Br(g){var I=-1,j=g==null?0:g.length;for(this.clear();++I<j;){var Q=g[I];this.set(Q[0],Q[1])}}function ki(){this.size=0,this.__data__={hash:new We,map:new(tt||yr),string:new We}}function Ca(g){var I=ci(this,g).delete(g);return this.size-=I?1:0,I}function Ki(g){return ci(this,g).get(g)}function Aa(g){return ci(this,g).has(g)}function Oa(g,I){var j=ci(this,g),Q=j.size;return j.set(g,I),this.size+=j.size==Q?0:1,this}Br.prototype.clear=ki,Br.prototype.delete=Ca,Br.prototype.get=Ki,Br.prototype.has=Aa,Br.prototype.set=Oa;function Bi(g){var I=-1,j=g==null?0:g.length;for(this.__data__=new Br;++I<j;)this.add(g[I])}function Js(g){return this.__data__.set(g,n),this}function Qs(g){return this.__data__.has(g)}Bi.prototype.add=Bi.prototype.push=Js,Bi.prototype.has=Qs;function Cr(g){var I=this.__data__=new yr(g);this.size=I.size}function Ra(){this.__data__=new yr,this.size=0}function Ta(g){var I=this.__data__,j=I.delete(g);return this.size=I.size,j}function Na(g){return this.__data__.get(g)}function Fa(g){return this.__data__.has(g)}function Ys(g,I){var j=this.__data__;if(j instanceof yr){var Q=j.__data__;if(!tt||Q.length<r-1)return Q.push([g,I]),this.size=++j.size,this;j=this.__data__=new Br(Q)}return j.set(g,I),this.size=j.size,this}Cr.prototype.clear=Ra,Cr.prototype.delete=Ta,Cr.prototype.get=Na,Cr.prototype.has=Fa,Cr.prototype.set=Ys;function Xs(g,I){var j=Wi(g),Q=!j&&ln(g),Be=!j&&!Q&&vs(g),de=!j&&!Q&&!Be&&dn(g),Xe=j||Q||Be||de,Tt=Xe?xt(g.length,String):[],Se=Tt.length;for(var Ve in g)(I||qe.call(g,Ve))&&!(Xe&&(Ve=="length"||Be&&(Ve=="offset"||Ve=="parent")||de&&(Ve=="buffer"||Ve=="byteLength"||Ve=="byteOffset")||an(Ve,Se)))&&Tt.push(Ve);return Tt}function Pi(g,I){for(var j=g.length;j--;)if(hn(g[j][0],I))return j;return-1}function ds(g,I,j){var Q=I(g);return Wi(g)?Q:Fe(Q,j(g))}function Si(g){return g==null?g===void 0?ve:ce:Jt&&Jt in Object(g)?sn(g):La(g)}function gs(g){return Ai(g)&&Si(g)==y}function Ci(g,I,j,Q,Be){return g===I?!0:g==null||I==null||!Ai(g)&&!Ai(I)?g!==g&&I!==I:Zs(g,I,j,Q,Ci,Be)}function Zs(g,I,j,Q,Be,de){var Xe=Wi(g),Tt=Wi(I),Se=Xe?w:qr(g),Ve=Tt?w:qr(I);Se=Se==y?ue:Se,Ve=Ve==y?ue:Ve;var _t=Se==ue,ir=Ve==ue,Nt=Se==Ve;if(Nt&&vs(g)){if(!vs(I))return!1;Xe=!0,_t=!1}if(Nt&&!_t)return de||(de=new Cr),Xe||dn(g)?Vi(g,I,j,Q,Be,de):Da(g,I,Se,j,Q,Be,de);if(!(j&a)){var Ze=_t&&qe.call(g,"__wrapped__"),Qt=ir&&qe.call(I,"__wrapped__");if(Ze||Qt){var Ar=Ze?g.value():g,mr=Qt?I.value():I;return de||(de=new Cr),Be(Ar,mr,j,Q,de)}}return Nt?(de||(de=new Cr),rn(g,I,j,Q,Be,de)):!1}function $a(g){if(!pn(g)||cn(g))return!1;var I=Ji(g)?Ut:He;return I.test(Vr(g))}function en(g){return Ai(g)&&fn(g.length)&&!!_e[Si(g)]}function tn(g){if(!un(g))return xi(g);var I=[];for(var j in Object(g))qe.call(g,j)&&j!="constructor"&&I.push(j);return I}function Vi(g,I,j,Q,Be,de){var Xe=j&a,Tt=g.length,Se=I.length;if(Tt!=Se&&!(Xe&&Se>Tt))return!1;var Ve=de.get(g);if(Ve&&de.get(I))return Ve==I;var _t=-1,ir=!0,Nt=j&l?new Bi:void 0;for(de.set(g,I),de.set(I,g);++_t<Tt;){var Ze=g[_t],Qt=I[_t];if(Q)var Ar=Xe?Q(Qt,Ze,_t,I,g,de):Q(Ze,Qt,_t,g,I,de);if(Ar!==void 0){if(Ar)continue;ir=!1;break}if(Nt){if(!xe(I,function(mr,zr){if(!nt(Nt,zr)&&(Ze===mr||Be(Ze,mr,j,Q,de)))return Nt.push(zr)})){ir=!1;break}}else if(!(Ze===Qt||Be(Ze,Qt,j,Q,de))){ir=!1;break}}return de.delete(g),de.delete(I),ir}function Da(g,I,j,Q,Be,de,Xe){switch(j){case Oe:if(g.byteLength!=I.byteLength||g.byteOffset!=I.byteOffset)return!1;g=g.buffer,I=I.buffer;case Ee:return!(g.byteLength!=I.byteLength||!de(new Wt(g),new Wt(I)));case E:case C:case re:return hn(+g,+I);case R:return g.name==I.name&&g.message==I.message;case pe:case H:return g==I+"";case K:var Tt=Je;case F:var Se=Q&a;if(Tt||(Tt=at),g.size!=I.size&&!Se)return!1;var Ve=Xe.get(g);if(Ve)return Ve==I;Q|=l,Xe.set(g,I);var _t=Vi(Tt(g),Tt(I),Q,Be,de,Xe);return Xe.delete(g),_t;case W:if(vt)return vt.call(g)==vt.call(I)}return!1}function rn(g,I,j,Q,Be,de){var Xe=j&a,Tt=Gi(g),Se=Tt.length,Ve=Gi(I),_t=Ve.length;if(Se!=_t&&!Xe)return!1;for(var ir=Se;ir--;){var Nt=Tt[ir];if(!(Xe?Nt in I:qe.call(I,Nt)))return!1}var Ze=de.get(g);if(Ze&&de.get(I))return Ze==I;var Qt=!0;de.set(g,I),de.set(I,g);for(var Ar=Xe;++ir<Se;){Nt=Tt[ir];var mr=g[Nt],zr=I[Nt];if(Q)var ys=Xe?Q(zr,mr,Nt,I,g,de):Q(mr,zr,Nt,g,I,de);if(!(ys===void 0?mr===zr||Be(mr,zr,j,Q,de):ys)){Qt=!1;break}Ar||(Ar=Nt=="constructor")}if(Qt&&!Ar){var Oi=g.constructor,zt=I.constructor;Oi!=zt&&"constructor"in g&&"constructor"in I&&!(typeof Oi=="function"&&Oi instanceof Oi&&typeof zt=="function"&&zt instanceof zt)&&(Qt=!1)}return de.delete(g),de.delete(I),Qt}function Gi(g){return ds(g,Ma,nn)}function ci(g,I){var j=g.__data__;return on(I)?j[typeof I=="string"?"string":"hash"]:j.map}function lr(g,I){var j=De(g,I);return $a(j)?j:void 0}function sn(g){var I=qe.call(g,Jt),j=g[Jt];try{g[Jt]=void 0;var Q=!0}catch{}var Be=$t.call(g);return Q&&(I?g[Jt]=j:delete g[Jt]),Be}var nn=Kr?function(g){return g==null?[]:(g=Object(g),Te(Kr(g),function(I){return rr.call(g,I)}))}:Ke,qr=Si;(lt&&qr(new lt(new ArrayBuffer(1)))!=Oe||tt&&qr(new tt)!=K||ft&&qr(ft.resolve())!=he||pt&&qr(new pt)!=F||ot&&qr(new ot)!=te)&&(qr=function(g){var I=Si(g),j=I==ue?g.constructor:void 0,Q=j?Vr(j):"";if(Q)switch(Q){case St:return Oe;case Ct:return K;case dt:return he;case At:return F;case gt:return te}return I});function an(g,I){return I=I??d,!!I&&(typeof g=="number"||Dr.test(g))&&g>-1&&g%1==0&&g<I}function on(g){var I=typeof g;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?g!=="__proto__":g===null}function cn(g){return!!Pt&&Pt in g}function un(g){var I=g&&g.constructor,j=typeof I=="function"&&I.prototype||Ne;return g===j}function La(g){return $t.call(g)}function Vr(g){if(g!=null){try{return ht.call(g)}catch{}try{return g+""}catch{}}return""}function hn(g,I){return g===I||g!==g&&I!==I}var ln=gs(function(){return arguments}())?gs:function(g){return Ai(g)&&qe.call(g,"callee")&&!rr.call(g,"callee")},Wi=Array.isArray;function qa(g){return g!=null&&fn(g.length)&&!Ji(g)}var vs=oi||Ue;function za(g,I){return Ci(g,I)}function Ji(g){if(!pn(g))return!1;var I=Si(g);return I==M||I==$||I==v||I==fe}function fn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function pn(g){var I=typeof g;return g!=null&&(I=="object"||I=="function")}function Ai(g){return g!=null&&typeof g=="object"}var dn=me?mt(me):en;function Ma(g){return qa(g)?Xs(g):tn(g)}function Ke(){return[]}function Ue(){return!1}c.exports=za})(pa,pa.exports);var Q1=pa.exports;const Y1=Vy(Q1);function X1(c,i){if(c.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<c.length;a++){var l=c.charAt(a),d=l.charCodeAt(0);if(r[d]!==255)throw new TypeError(l+" is ambiguous");r[d]=a}var y=c.length,w=c.charAt(0),v=Math.log(y)/Math.log(256),E=Math.log(256)/Math.log(y);function C($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var K=0,re=0,ce=0,ue=$.length;ce!==ue&&$[ce]===0;)ce++,K++;for(var he=(ue-ce)*E+1>>>0,fe=new Uint8Array(he);ce!==ue;){for(var pe=$[ce],F=0,H=he-1;(pe!==0||F<re)&&H!==-1;H--,F++)pe+=256*fe[H]>>>0,fe[H]=pe%y>>>0,pe=pe/y>>>0;if(pe!==0)throw new Error("Non-zero carry");re=F,ce++}for(var W=he-re;W!==he&&fe[W]===0;)W++;for(var ve=w.repeat(K);W<he;++W)ve+=c.charAt(fe[W]);return ve}function R($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var K=0;if($[K]!==" "){for(var re=0,ce=0;$[K]===w;)re++,K++;for(var ue=($.length-K)*v+1>>>0,he=new Uint8Array(ue);$[K];){var fe=r[$.charCodeAt(K)];if(fe===255)return;for(var pe=0,F=ue-1;(fe!==0||pe<ce)&&F!==-1;F--,pe++)fe+=y*he[F]>>>0,he[F]=fe%256>>>0,fe=fe/256>>>0;if(fe!==0)throw new Error("Non-zero carry");ce=pe,K++}if($[K]!==" "){for(var H=ue-ce;H!==ue&&he[H]===0;)H++;for(var W=new Uint8Array(re+(ue-H)),ve=re;H!==ue;)W[ve++]=he[H++];return W}}}function M($){var K=R($);if(K)return K;throw new Error(`Non-${i} character`)}return{encode:C,decodeUnsafe:R,decode:M}}var Z1=X1,ew=Z1;const Kl=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},tw=c=>new TextEncoder().encode(c),rw=c=>new TextDecoder().decode(c);class iw{constructor(i,r,n){this.name=i,this.prefix=r,this.baseEncode=n}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class sw{constructor(i,r,n){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return Bl(this,i)}}class nw{constructor(i){this.decoders=i}or(i){return Bl(this,i)}decode(i){const r=i[0],n=this.decoders[r];if(n)return n.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Bl=(c,i)=>new nw({...c.decoders||{[c.prefix]:c},...i.decoders||{[i.prefix]:i}});class aw{constructor(i,r,n,a){this.name=i,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new iw(i,r,n),this.decoder=new sw(i,r,a)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const ya=({name:c,prefix:i,encode:r,decode:n})=>new aw(c,i,r,n),Ws=({prefix:c,name:i,alphabet:r})=>{const{encode:n,decode:a}=ew(r,i);return ya({prefix:c,name:i,encode:n,decode:l=>Kl(a(l))})},ow=(c,i,r,n)=>{const a={};for(let E=0;E<i.length;++E)a[i[E]]=E;let l=c.length;for(;c[l-1]==="=";)--l;const d=new Uint8Array(l*r/8|0);let y=0,w=0,v=0;for(let E=0;E<l;++E){const C=a[c[E]];if(C===void 0)throw new SyntaxError(`Non-${n} character`);w=w<<r|C,y+=r,y>=8&&(y-=8,d[v++]=255&w>>y)}if(y>=r||255&w<<8-y)throw new SyntaxError("Unexpected end of data");return d},cw=(c,i,r)=>{const n=i[i.length-1]==="=",a=(1<<r)-1;let l="",d=0,y=0;for(let w=0;w<c.length;++w)for(y=y<<8|c[w],d+=8;d>r;)d-=r,l+=i[a&y>>d];if(d&&(l+=i[a&y<<r-d]),n)for(;l.length*r&7;)l+="=";return l},Kt=({name:c,prefix:i,bitsPerChar:r,alphabet:n})=>ya({prefix:i,name:c,encode(a){return cw(a,n,r)},decode(a){return ow(a,n,r,c)}}),uw=ya({prefix:"\0",name:"identity",encode:c=>rw(c),decode:c=>tw(c)});var hw=Object.freeze({__proto__:null,identity:uw});const lw=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fw=Object.freeze({__proto__:null,base2:lw});const pw=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var dw=Object.freeze({__proto__:null,base8:pw});const gw=Ws({prefix:"9",name:"base10",alphabet:"0123456789"});var vw=Object.freeze({__proto__:null,base10:gw});const yw=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),mw=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ww=Object.freeze({__proto__:null,base16:yw,base16upper:mw});const _w=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bw=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ew=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Iw=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),xw=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pw=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Sw=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Cw=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Aw=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ow=Object.freeze({__proto__:null,base32:_w,base32upper:bw,base32pad:Ew,base32padupper:Iw,base32hex:xw,base32hexupper:Pw,base32hexpad:Sw,base32hexpadupper:Cw,base32z:Aw});const Rw=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Tw=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nw=Object.freeze({__proto__:null,base36:Rw,base36upper:Tw});const Fw=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$w=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Dw=Object.freeze({__proto__:null,base58btc:Fw,base58flickr:$w});const Lw=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qw=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zw=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Mw=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var jw=Object.freeze({__proto__:null,base64:Lw,base64pad:qw,base64url:zw,base64urlpad:Mw});const Vl=Array.from(""),Uw=Vl.reduce((c,i,r)=>(c[r]=i,c),[]),Hw=Vl.reduce((c,i,r)=>(c[i.codePointAt(0)]=r,c),[]);function kw(c){return c.reduce((i,r)=>(i+=Uw[r],i),"")}function Kw(c){const i=[];for(const r of c){const n=Hw[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(n)}return new Uint8Array(i)}const Bw=ya({prefix:"",name:"base256emoji",encode:kw,decode:Kw});var Vw=Object.freeze({__proto__:null,base256emoji:Bw}),Gw=Gl,Jh=128,Ww=127,Jw=~Ww,Qw=Math.pow(2,31);function Gl(c,i,r){i=i||[],r=r||0;for(var n=r;c>=Qw;)i[r++]=c&255|Jh,c/=128;for(;c&Jw;)i[r++]=c&255|Jh,c>>>=7;return i[r]=c|0,Gl.bytes=r-n+1,i}var Yw=hc,Xw=128,Qh=127;function hc(c,n){var r=0,n=n||0,a=0,l=n,d,y=c.length;do{if(l>=y)throw hc.bytes=0,new RangeError("Could not decode varint");d=c[l++],r+=a<28?(d&Qh)<<a:(d&Qh)*Math.pow(2,a),a+=7}while(d>=Xw);return hc.bytes=l-n,r}var Zw=Math.pow(2,7),e_=Math.pow(2,14),t_=Math.pow(2,21),r_=Math.pow(2,28),i_=Math.pow(2,35),s_=Math.pow(2,42),n_=Math.pow(2,49),a_=Math.pow(2,56),o_=Math.pow(2,63),c_=function(c){return c<Zw?1:c<e_?2:c<t_?3:c<r_?4:c<i_?5:c<s_?6:c<n_?7:c<a_?8:c<o_?9:10},u_={encode:Gw,decode:Yw,encodingLength:c_},Wl=u_;const Yh=(c,i,r=0)=>(Wl.encode(c,i,r),i),Xh=c=>Wl.encodingLength(c),lc=(c,i)=>{const r=i.byteLength,n=Xh(c),a=n+Xh(r),l=new Uint8Array(a+r);return Yh(c,l,0),Yh(r,l,n),l.set(i,a),new h_(c,r,i,l)};class h_{constructor(i,r,n,a){this.code=i,this.size=r,this.digest=n,this.bytes=a}}const Jl=({name:c,code:i,encode:r})=>new l_(c,i,r);class l_{constructor(i,r,n){this.name=i,this.code=r,this.encode=n}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?lc(this.code,r):r.then(n=>lc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ql=c=>async i=>new Uint8Array(await crypto.subtle.digest(c,i)),f_=Jl({name:"sha2-256",code:18,encode:Ql("SHA-256")}),p_=Jl({name:"sha2-512",code:19,encode:Ql("SHA-512")});var d_=Object.freeze({__proto__:null,sha256:f_,sha512:p_});const Yl=0,g_="identity",Xl=Kl,v_=c=>lc(Yl,Xl(c)),y_={code:Yl,name:g_,encode:Xl,digest:v_};var m_=Object.freeze({__proto__:null,identity:y_});new TextEncoder,new TextDecoder;const Zh={...hw,...fw,...dw,...vw,...ww,...Ow,...Nw,...Dw,...jw,...Vw};({...d_,...m_});function Zl(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function w_(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zl(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function ef(c,i,r,n){return{name:c,prefix:i,encoder:{name:c,prefix:i,encode:r},decoder:{decode:n}}}const el=ef("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Xo=ef("ascii","a",c=>{let i="a";for(let r=0;r<c.length;r++)i+=String.fromCharCode(c[r]);return i},c=>{c=c.substring(1);const i=w_(c.length);for(let r=0;r<c.length;r++)i[r]=c.charCodeAt(r);return i}),__={utf8:el,"utf-8":el,hex:Zh.base16,latin1:Xo,ascii:Xo,binary:Xo,...Zh};function b_(c,i="utf8"){const r=__[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zl(globalThis.Buffer.from(c,"utf-8")):r.decoder.decode(`${r.prefix}${c}`)}const tf="wc",E_=2,Ec="core",bi=`${tf}@2:${Ec}:`,I_={name:Ec,logger:"error"},x_={database:":memory:"},P_="crypto",tl="client_ed25519_seed",S_=ie.ONE_DAY,C_="keychain",A_="0.3",O_="messages",R_="0.3",T_=ie.SIX_HOURS,N_="publisher",rf="irn",F_="error",sf="wss://relay.walletconnect.com",rl="wss://relay.walletconnect.org",$_="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},D_="_subscription",ri={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},L_=ie.ONE_SECOND,q_="2.10.2",z_=1e4,M_="0.3",j_="WALLETCONNECT_CLIENT_ID",Fr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},U_="subscription",H_="0.3",k_=ie.FIVE_SECONDS*1e3,K_="pairing",B_="0.3",Ds={wc_pairingDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:0},res:{ttl:ie.ONE_DAY,prompt:!1,tag:0}}},Us={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},V_="history",G_="0.3",W_="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},J_="0.3",Zo="verify-api",la="https://verify.walletconnect.com",il="https://verify.walletconnect.org";class Q_{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=C_,this.version=A_,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:l}=X("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=i,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,Nl(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Fl(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Y_{constructor(i,r,n){this.core=i,this.logger=r,this.name=P_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Vh(a);return kl(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Jy();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),d=Vh(l),y=oc();return await B1(y,a,S_,d)},this.generateSharedKey=(a,l,d)=>{this.isInitialized();const y=this.getPrivateKey(a),w=Qy(y,l);return this.setSymKey(w,d)},this.setSymKey=async(a,l)=>{this.isInitialized();const d=l||Yy(a);return await this.keychain.set(d,a),d},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,d)=>{this.isInitialized();const y=Xy(d),w=Vs(l);if(Sh(y)){const R=y.senderPublicKey,M=y.receiverPublicKey;a=await this.generateSharedKey(R,M)}const v=this.getSymKey(a),{type:E,senderPublicKey:C}=y;return Zy({type:E,symKey:v,message:w,senderPublicKey:C})},this.decode=async(a,l,d)=>{this.isInitialized();const y=em(l,d);if(Sh(y)){const w=y.receiverPublicKey,v=y.senderPublicKey;a=await this.generateSharedKey(w,v)}try{const w=this.getSymKey(a),v=tm({symKey:w,encoded:l});return va(v)}catch(w){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(w)}},this.getPayloadType=a=>{const l=Ch(a);return rm(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Ch(a);return l.senderPublicKey?ga(l.senderPublicKey,im):void 0},this.core=i,this.logger=Ae.generateChildLogger(r,this.name),this.keychain=n||new Q_(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(tl)}catch{i=oc(),await this.keychain.set(tl,i)}return b_(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class X_ extends I1{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=O_,this.version=R_,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const l=ls(a);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=a,this.messages.set(n,d),await this.persist()),l},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const l=this.get(n),d=ls(a);return typeof l[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Ae.generateChildLogger(i,this.name),this.core=r}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,Nl(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Fl(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Z_ extends x1{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new kr.EventEmitter,this.name=N_,this.queue=new Map,this.publishTimeout=ie.toMiliseconds(ie.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,l)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}});try{const y=l?.ttl||T_,w=cc(l),v=l?.prompt||!1,E=l?.tag||0,C=l?.id||Dm().toString(),R={topic:n,message:a,opts:{ttl:y,relay:w,prompt:v,tag:E,id:C}},M=setTimeout(()=>this.queue.set(C,R),this.publishTimeout);try{await await Ks(this.rpcPublish(n,a,y,w,v,E,C),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(C),this.relayer.events.emit(Gt.publish,R)}catch($){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=l?.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(C),$;return}finally{clearTimeout(M)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=i,this.logger=Ae.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(i,r,n,a,l,d,y){var w,v,E,C;const R={method:oa(a.protocol).publish,params:{topic:i,message:r,ttl:n,prompt:l,tag:d},id:y};return _i((w=R.params)==null?void 0:w.prompt)&&((v=R.params)==null||delete v.prompt),_i((E=R.params)==null?void 0:E.tag)&&((C=R.params)==null||delete C.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:R}),this.relayer.request(R)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:n,opts:a}=i;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class eb{constructor(){this.map=new Map,this.set=(i,r)=>{const n=this.get(i);this.exists(i,r)||this.map.set(i,[...n,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const n=this.get(i);if(!this.exists(i,r))return;const a=n.filter(l=>l!==r);if(!a.length){this.map.delete(i);return}this.map.set(i,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var tb=Object.defineProperty,rb=Object.defineProperties,ib=Object.getOwnPropertyDescriptors,sl=Object.getOwnPropertySymbols,sb=Object.prototype.hasOwnProperty,nb=Object.prototype.propertyIsEnumerable,nl=(c,i,r)=>i in c?tb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Ls=(c,i)=>{for(var r in i||(i={}))sb.call(i,r)&&nl(c,r,i[r]);if(sl)for(var r of sl(i))nb.call(i,r)&&nl(c,r,i[r]);return c},ec=(c,i)=>rb(c,ib(i));class ab extends C1{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new eb,this.events=new kr.EventEmitter,this.name=U_,this.version=H_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const l=cc(a),d={topic:n,relay:l};this.pending.set(n,d);const y=await this.rpcSubscribe(n,l);return this.onSubscribe(y,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),y}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof a?.id<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,l)=>{const d=new ie.Watch;d.start(this.pendingSubscriptionWatchLabel);const y=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(y),d.stop(this.pendingSubscriptionWatchLabel),a(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=k_&&(clearInterval(y),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Ae.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let n=!1;try{n=this.getSubscription(i).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const n=this.topicMap.get(i);await Promise.all(n.map(async a=>await this.unsubscribeById(i,a,r)))}async unsubscribeById(i,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}});try{const a=cc(n);await this.rpcUnsubscribe(i,r,a);const l=tr("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(i,r){const n={method:oa(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Ks(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return ls(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,n={method:oa(r.protocol).batchSubscribe,params:{topics:i.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Ks(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(i,r,n){const a={method:oa(n.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(i,r){this.setSubscription(i,ec(Ls({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,Ls({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,n),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,Ls({},r)),this.topicMap.set(r.topic,i),this.events.emit(Fr.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const n=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(n.topic,i),this.events.emit(Fr.deleted,ec(Ls({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Fr.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Fr.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);fs(r)&&this.onBatchSubscribe(r.map((n,a)=>ec(Ls({},i[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on(Fr.created,async i=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(Fr.deleted,async i=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var ob=Object.defineProperty,al=Object.getOwnPropertySymbols,cb=Object.prototype.hasOwnProperty,ub=Object.prototype.propertyIsEnumerable,ol=(c,i,r)=>i in c?ob(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,hb=(c,i)=>{for(var r in i||(i={}))cb.call(i,r)&&ol(c,r,i[r]);if(al)for(var r of al(i))ub.call(i,r)&&ol(c,r,i[r]);return c};class lb extends P1{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new kr.EventEmitter,this.name=$_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Gt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ri.payload,this.onPayloadHandler),this.provider.on(ri.connect,this.onConnectHandler),this.provider.on(ri.disconnect,this.onDisconnectHandler),this.provider.on(ri.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Ae.generateChildLogger(i.logger,this.name):Ae.pino(Ae.getDefaultLoggerOptions({level:i.logger||F_})),this.messages=new X_(this.logger,i.core),this.subscriber=new ab(this,this.logger),this.publisher=new Z_(this,this.logger),this.relayUrl=i?.relayUrl||sf,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${rl}...`),await this.restartTransport(rl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},z_)}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,n){this.isInitialized(),await this.publisher.publish(i,r,n),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(i))==null?void 0:n[0])||"";if(a)return a;let l;const d=y=>{y.topic===i&&(this.subscriber.off(Fr.created,d),l())};return await Promise.all([new Promise(y=>{l=y,this.subscriber.on(Fr.created,d)}),new Promise(async y=>{a=await this.subscriber.subscribe(i,r),y()})]),a}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Ks(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Fr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Ks(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(ri.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Ah())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ni(new J1(sm({sdkVersion:q_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:n}=i;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(i){const{topic:r,message:n}=i;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),mc(i)){if(!i.method.endsWith(D_))return;const r=i.params,{topic:n,message:a,publishedAt:l}=r.data,d={topic:n,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(hb({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(i),await this.onMessageEvent(d)}else wc(i)&&this.events.emit(Gt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Gt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=_c(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ri.payload,this.onPayloadHandler),this.provider.off(ri.connect,this.onConnectHandler),this.provider.off(ri.disconnect,this.onDisconnectHandler),this.provider.off(ri.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Ah();nm(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},ie.toMiliseconds(L_)))}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var fb=Object.defineProperty,cl=Object.getOwnPropertySymbols,pb=Object.prototype.hasOwnProperty,db=Object.prototype.propertyIsEnumerable,ul=(c,i,r)=>i in c?fb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,hl=(c,i)=>{for(var r in i||(i={}))pb.call(i,r)&&ul(c,r,i[r]);if(cl)for(var r of cl(i))db.call(i,r)&&ul(c,r,i[r]);return c};class ma extends S1{constructor(i,r,n,a=bi,l=void 0){super(i,r,n,a),this.core=i,this.logger=r,this.name=n,this.map=new Map,this.version=M_,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):Gy(d)?this.map.set(d.id,d):Wy(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,y)=>{this.isInitialized(),this.map.has(d)?await this.update(d,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:y}),this.map.set(d,y),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(y=>Object.keys(d).every(w=>Y1(y[w],d[w]))):this.values),this.update=async(d,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:y});const w=hl(hl({},this.getData(d)),y);this.map.set(d,w),await this.persist()},this.delete=async(d,y)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:y}),this.map.delete(d),await this.persist())},this.logger=Ae.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class gb{constructor(i,r){this.core=i,this.logger=r,this.name=K_,this.version=B_,this.events=new vc,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[Ol],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=oc(),a=await this.core.crypto.setSymKey(n),l=$r(ie.FIVE_MINUTES),d={protocol:rf},y={topic:a,expiry:l,relay:d,active:!1},w=am({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:d});return await this.pairings.set(a,y),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:w}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:l,relay:d}=om(n.uri);let y;if(this.pairings.keys.includes(a)&&(y=this.pairings.get(a),y.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:d}));const w=$r(ie.FIVE_MINUTES),v={topic:a,relay:d,expiry:w,active:!1};return await this.pairings.set(a,v),this.core.expirer.set(a,w),n.activatePairing&&await this.activate({topic:a}),this.events.emit(Us.create,v),v},this.activate=async({topic:n})=>{this.isInitialized();const a=$r(ie.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:d,resolve:y,reject:w}=us();this.events.once(Ft("pairing_ping",l),({error:v})=>{v?w(v):y()}),await d()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,l)=>{const d=ks(a,l),y=await this.core.crypto.encode(n,d),w=Ds[a].req;return this.core.history.set(n,d),this.core.relayer.publish(n,y,w),d.id},this.sendResult=async(n,a,l)=>{const d=_c(n,l),y=await this.core.crypto.encode(a,d),w=await this.core.history.get(a,n),v=Ds[w.request.method].res;await this.core.relayer.publish(a,y,v),await this.core.history.resolve(d)},this.sendError=async(n,a,l)=>{const d=yc(n,l),y=await this.core.crypto.encode(a,d),w=await this.core.history.get(a,n),v=Ds[w.request.method]?Ds[w.request.method].res:Ds.unregistered_method.res;await this.core.relayer.publish(a,y,v),await this.core.history.resolve(d)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>wi(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:l}=n;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:l}=n,d=(await this.core.history.get(a,l.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,a)=>{const{id:l}=a;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit(Us.ping,{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,a)=>{const{id:l}=a;setTimeout(()=>{mi(a)?this.events.emit(Ft("pairing_ping",l),{}):si(a)&&this.events.emit(Ft("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Us.delete,{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:l,method:d}=a;try{if(this.registeredMethods.includes(d))return;const y=tr("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,n,y),this.logger.error(y)}catch(y){await this.sendError(l,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!hr(n)){const{message:a}=X("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(a)}if(!cm(n.uri)){const{message:a}=X("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(a)}},this.isValidPing=async n=>{if(!hr(n)){const{message:l}=X("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!hr(n)){const{message:l}=X("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!hs(n,!1)){const{message:a}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=X("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=i,this.logger=Ae.generateChildLogger(r,this.name),this.pairings=new ma(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ae.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async i=>{const{topic:r,message:n}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{mc(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):wc(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async i=>{const{topic:r}=Rl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Us.expire,{topic:r}))})}}class vb extends E1{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new kr.EventEmitter,this.name=V_,this.version=G_,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:l}),this.records.has(a.id))return;const d={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:l,expiry:$r(ie.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Hr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=si(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(Hr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===n){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(Hr.deleted,l)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ks(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(n)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Hr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(Hr.created,i=>{const r=Hr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.updated,i=>{const r=Hr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.deleted,i=>{const r=Hr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{ie.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class yb extends A1{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new kr.EventEmitter,this.name=W_,this.version=J_,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const l=this.formatTarget(n),d={target:l,expiry:a};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Sr.created,{target:l,expiration:d})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Sr.deleted,{target:a,expiration:l})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return um(i);if(typeof i=="number")return hm(i);const{message:r}=X("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(i,r){const{expiry:n}=r;ie.toMiliseconds(n)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Sr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,i=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.expired,i=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.deleted,i=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class mb extends O1{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=Zo,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||lm()||!Tl())return;const n=la;this.verifyUrl!==n&&this.removeIframe(),this.verifyUrl=n;try{await this.createIframe()}catch(a){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(a)}if(!this.initialized){this.removeIframe(),this.verifyUrl=il;try{await this.createIframe()}catch(a){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(a),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=n?.verifyUrl||la;let l;try{l=await this.fetchAttestation(n.attestationId,a)}catch(d){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(d),l=await this.fetchAttestation(n.attestationId,il)}return l},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const l=this.startAbortTimer(ie.ONE_SECOND*2),d=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?await d.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(l=>{if(document.getElementById(Zo))return l();window.addEventListener("message",a);const d=document.createElement("iframe");d.id=Zo,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,n=l}),new Promise((l,d)=>setTimeout(()=>{window.removeEventListener("message",a),d("verify iframe load timeout")},ie.toMiliseconds(ie.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Ae.generateChildLogger(r,this.name),this.verifyUrl=la,this.abortController=new AbortController,this.isDevEnv=fm()&&{}.IS_VITEST}get context(){return Ae.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ie.toMiliseconds(i))}}var wb=Object.defineProperty,ll=Object.getOwnPropertySymbols,_b=Object.prototype.hasOwnProperty,bb=Object.prototype.propertyIsEnumerable,fl=(c,i,r)=>i in c?wb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,pl=(c,i)=>{for(var r in i||(i={}))_b.call(i,r)&&fl(c,r,i[r]);if(ll)for(var r of ll(i))bb.call(i,r)&&fl(c,r,i[r]);return c};class Ic extends b1{constructor(i){super(i),this.protocol=tf,this.version=E_,this.name=Ec,this.events=new kr.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||sf,this.customStoragePrefix=i!=null&&i.customStoragePrefix?`:${i.customStoragePrefix}`:"";const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:i?.logger||I_.logger}));this.logger=Ae.generateChildLogger(r,this.name),this.heartbeat=new ps.HeartBeat,this.crypto=new Y_(this,this.logger,i?.keychain),this.history=new vb(this,this.logger),this.expirer=new yb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new f1(pl(pl({},x_),i?.storageOptions)),this.relayer=new lb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new gb(this,this.logger),this.verify=new mb(this.projectId||"",this.logger)}static async init(i){const r=new Ic(i);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(j_,n),r}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const Eb=Ic,nf="wc",af=2,of="client",xc=`${nf}@${af}:${of}:`,tc={name:of,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},dl="WALLETCONNECT_DEEPLINK_CHOICE",Ib="proposal",cf="Proposal expired",xb="session",sa=ie.SEVEN_DAYS,Pb="engine",qs={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},rc={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},ii={idle:"IDLE",active:"ACTIVE"},Sb="request",Cb=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Ab=Object.defineProperty,Ob=Object.defineProperties,Rb=Object.getOwnPropertyDescriptors,gl=Object.getOwnPropertySymbols,Tb=Object.prototype.hasOwnProperty,Nb=Object.prototype.propertyIsEnumerable,vl=(c,i,r)=>i in c?Ab(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,cr=(c,i)=>{for(var r in i||(i={}))Tb.call(i,r)&&vl(c,r,i[r]);if(gl)for(var r of gl(i))Nb.call(i,r)&&vl(c,r,i[r]);return c},zs=(c,i)=>Ob(c,Rb(i));class Fb extends T1{constructor(i){super(i),this.name=Pb,this.events=new vc,this.initialized=!1,this.ignoredPayloadTypes=[Ol],this.requestQueue={state:ii.idle,queue:[]},this.sessionRequestQueue={state:ii.idle,queue:[]},this.requestQueueDelay=ie.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(qs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=zs(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:y,relays:w}=n;let v=a,E,C=!1;if(v&&(C=this.client.core.pairing.pairings.get(v).active),!v||!C){const{topic:he,uri:fe}=await this.client.core.pairing.create();v=he,E=fe}const R=await this.client.core.crypto.generateKeyPair(),M=cr({requiredNamespaces:l,optionalNamespaces:d,relays:w??[{protocol:rf}],proposer:{publicKey:R,metadata:this.client.metadata}},y&&{sessionProperties:y}),{reject:$,resolve:K,done:re}=us(ie.FIVE_MINUTES,cf);if(this.events.once(Ft("session_connect"),async({error:he,session:fe})=>{if(he)$(he);else if(fe){fe.self.publicKey=R;const pe=zs(cr({},fe),{requiredNamespaces:fe.requiredNamespaces,optionalNamespaces:fe.optionalNamespaces});await this.client.session.set(fe.topic,pe),await this.setExpiry(fe.topic,fe.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:fe.peer.metadata}),K(pe)}}),!v){const{message:he}=X("NO_MATCHING_KEY",`connect() pairing topic: ${v}`);throw new Error(he)}const ce=await this.sendRequest({topic:v,method:"wc_sessionPropose",params:M}),ue=$r(ie.FIVE_MINUTES);return await this.setProposal(ce,cr({id:ce,expiry:ue},M)),{uri:E,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:a,namespaces:l,sessionProperties:d}=r,y=this.client.proposal.get(n);let{pairingTopic:w,proposer:v,requiredNamespaces:E,optionalNamespaces:C}=y;w=w||"",ca(E)||(E=dm(l,"approve()"));const R=await this.client.core.crypto.generateKeyPair(),M=v.publicKey,$=await this.client.core.crypto.generateSharedKey(R,M);w&&n&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:v.metadata}),await this.sendResult({id:n,topic:w,result:{relay:{protocol:a??"irn"},responderPublicKey:R}}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const K=cr({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:E,optionalNamespaces:C,pairingTopic:w,controller:{publicKey:R,metadata:this.client.metadata},expiry:$r(sa)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe($),await this.sendRequest({topic:$,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const re=zs(cr({},K),{topic:$,pairingTopic:w,acknowledged:!1,self:K.controller,peer:{publicKey:v.publicKey,metadata:v.metadata},controller:R});return await this.client.session.set($,re),await this.setExpiry($,$r(sa)),{topic:$,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get($)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,a),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:a}=r,l=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:d,resolve:y,reject:w}=us();return this.events.once(Ft("session_update",l),({error:v})=>{v?w(v):y()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:l,resolve:d,reject:y}=us();return this.events.once(Ft("session_extend",a),({error:w})=>{w?y(w):d()}),await this.setExpiry(n,$r(sa)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:a,topic:l,expiry:d}=r,y=Lm(),{done:w,resolve:v,reject:E}=us(d,"Request expired. Please try again.");return this.events.once(Ft("session_request",y),({error:C,result:R})=>{C?E(C):v(R)}),await Promise.all([new Promise(async C=>{await this.sendRequest({clientRpcId:y,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:d,throwOnFailedPublish:!0}).catch(R=>E(R)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:n,id:y}),C()}),new Promise(async C=>{const R=await this.client.core.storage.getItem(dl);gm({id:y,topic:l,wcDeepLink:R}),C()}),w()]).then(C=>C[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:l}=a;mi(a)?await this.sendResult({id:l,topic:n,result:a.result,throwOnFailedPublish:!0}):si(a)&&await this.sendError(l,n,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:l,resolve:d,reject:y}=us();this.events.once(Ft("session_ping",a),({error:w})=>{w?y(w):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:l}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:tr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>vm(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var d,y;return((d=l.peerMetadata)==null?void 0:d.url)&&((y=l.peerMetadata)==null?void 0:y.url)===r.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(dl).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=ii.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=qs.wc_sessionRequest.req.ttl,{id:a,topic:l,params:d,verifyContext:y}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:d,verifyContext:y}),n&&this.client.core.expirer.set(a,$r(n))},this.sendRequest=async r=>{const{topic:n,method:a,params:l,expiry:d,relayRpcId:y,clientRpcId:w,throwOnFailedPublish:v}=r,E=ks(a,l,w);if(Tl()&&Cb.includes(a)){const M=ls(JSON.stringify(E));this.client.core.verify.register({attestationId:M})}const C=await this.client.core.crypto.encode(n,E),R=qs[a].req;return d&&(R.ttl=d),y&&(R.id=y),this.client.core.history.set(n,E),v?(R.internal=zs(cr({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,C,R)):this.client.core.relayer.publish(n,C,R).catch(M=>this.client.logger.error(M)),E.id},this.sendResult=async r=>{const{id:n,topic:a,result:l,throwOnFailedPublish:d}=r,y=_c(n,l),w=await this.client.core.crypto.encode(a,y),v=await this.client.core.history.get(a,n),E=qs[v.request.method].res;d?(E.internal=zs(cr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,w,E)):this.client.core.relayer.publish(a,w,E).catch(C=>this.client.logger.error(C)),await this.client.core.history.resolve(y)},this.sendError=async(r,n,a)=>{const l=yc(r,a),d=await this.client.core.crypto.encode(n,l),y=await this.client.core.history.get(n,r),w=qs[y.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{wi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{wi(a.expiry)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ii.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ii.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ii.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,l=(await this.client.core.history.get(n,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=X("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:l}=n;try{this.isValidConnect(cr({},n.params));const d=$r(ie.FIVE_MINUTES),y=cr({id:l,pairingTopic:r,expiry:d},a);await this.setProposal(l,y);const w=ls(JSON.stringify(n)),v=await this.getVerifyContext(w,y.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:y,verifyContext:v})}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(mi(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const y=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const w=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const v=await this.client.core.crypto.generateSharedKey(y,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:v});const E=await this.client.core.relayer.subscribe(v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else si(n)&&(await this.client.proposal.delete(a,tr("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:y,expiry:w,namespaces:v,requiredNamespaces:E,optionalNamespaces:C,sessionProperties:R,pairingTopic:M}=n.params,$=cr({topic:r,relay:d,expiry:w,namespaces:v,acknowledged:!0,pairingTopic:M,requiredNamespaces:E,optionalNamespaces:C,controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},R&&{sessionProperties:R});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:$}),this.cleanupDuplicatePairings($)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;mi(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",a),{})):si(n)&&(await this.client.session.delete(r,tr("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:l}=n;try{const d=`${r}_session_update`,y=ta.get(d);if(y&&this.isRequestOutOfSync(y,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(cr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),ta.set(d,l)}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit(Ft("session_update",a),{}):si(n)&&this.events.emit(Ft("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,$r(sa)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit(Ft("session_extend",a),{}):si(n)&&this.events.emit(Ft("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n;setTimeout(()=>{mi(n)?this.events.emit(Ft("session_ping",a),{}):si(n)&&this.events.emit(Ft("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Gt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidRequest(cr({topic:r},l));const d=ls(JSON.stringify(ks("wc_sessionRequest",l,a))),y=this.client.session.get(r),w=await this.getVerifyContext(d,y.peer.metadata),v={id:a,topic:r,params:l,verifyContext:w};await this.setPendingSessionRequest(v),this.addSessionRequestToSessionRequestQueue(v),this.processSessionRequestQueue()}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit(Ft("session_request",a),{result:n.result}):si(n)&&this.events.emit(Ft("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:l}=n;try{const d=`${r}_session_event_${l.event.name}`,y=ta.get(d);if(y&&this.isRequestOutOfSync(y,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(cr({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),ta.set(d,a)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ii.idle,this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ii.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ii.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,ks("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async r=>{if(!hr(r)){const{message:w}=X("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:d,relays:y}=r;if(_i(n)||await this.isValidPairingTopic(n),!ym(y,!0)){const{message:w}=X("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(w)}!_i(a)&&ca(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!_i(l)&&ca(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=mm(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!hr(r))throw new Error(X("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:l,sessionProperties:d}=r;await this.isValidProposalId(n);const y=this.client.proposal.get(n),w=Ko(a,"approve()");if(w)throw new Error(w.message);const v=Oh(y.requiredNamespaces,a,"approve()");if(v)throw new Error(v.message);if(!hs(l,!0)){const{message:E}=X("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(E)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!hr(r)){const{message:l}=X("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:n,reason:a}=r;if(await this.isValidProposalId(n),!wm(a)){const{message:l}=X("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!hr(r)){const{message:v}=X("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(v)}const{relay:n,controller:a,namespaces:l,expiry:d}=r;if(!_m(n)){const{message:v}=X("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(v)}const y=bm(a,"onSessionSettleRequest()");if(y)throw new Error(y.message);const w=Ko(l,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(wi(d)){const{message:v}=X("EXPIRED","onSessionSettleRequest()");throw new Error(v)}},this.isValidUpdate=async r=>{if(!hr(r)){const{message:w}=X("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:n,namespaces:a}=r;await this.isValidSessionTopic(n);const l=this.client.session.get(n),d=Ko(a,"update()");if(d)throw new Error(d.message);const y=Oh(l.requiredNamespaces,a,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!hr(r)){const{message:w}=X("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:n,request:a,chainId:l,expiry:d}=r;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!Rh(y,l)){const{message:w}=X("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(w)}if(!Em(a)){const{message:w}=X("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(w)}if(!Im(y,l,a.method)){const{message:w}=X("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(w)}if(d&&!xm(d,rc)){const{message:w}=X("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${rc.min} and ${rc.max}`);throw new Error(w)}},this.isValidRespond=async r=>{if(!hr(r)){const{message:l}=X("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:n,response:a}=r;if(await this.isValidSessionTopic(n),!Pm(a)){const{message:l}=X("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!hr(r)){const{message:y}=X("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(y)}const{topic:n,event:a,chainId:l}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Rh(d,l)){const{message:y}=X("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(y)}if(!Sm(a)){const{message:y}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(y)}if(!Cm(d,l,a.name)){const{message:y}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(y)}},this.isValidDisconnect=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||la,validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});l&&(a.verified.origin=l.origin,a.verified.isScam=l.isScam,a.verified.validation=l.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.info(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!hs(a,!1)){const{message:l}=X("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(r,n);try{mc(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):wc(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async i=>{const{topic:r,id:n}=Rl(i.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,X("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Us.create,i=>this.onPairingCreated(i))}isValidPairingTopic(i){if(!hs(i,!1)){const{message:r}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=X("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!hs(i,!1)){const{message:r}=X("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=X("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=X("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(hs(i,!1)){const{message:r}=X("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=X("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!Am(i)){const{message:r}=X("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=X("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=X("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class $b extends ma{constructor(i,r){super(i,r,Ib,xc),this.core=i,this.logger=r}}class Db extends ma{constructor(i,r){super(i,r,xb,xc),this.core=i,this.logger=r}}class Lb extends ma{constructor(i,r){super(i,r,Sb,xc,n=>n.id),this.core=i,this.logger=r}}let qb=class uf extends R1{constructor(i){super(i),this.protocol=nf,this.version=af,this.name=tc.name,this.events=new kr.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=i?.name||tc.name,this.metadata=i?.metadata||pm();const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:i?.logger||tc.logger}));this.core=i?.core||new Eb(i),this.logger=Ae.generateChildLogger(r,this.name),this.session=new Db(this.core,this.logger),this.proposal=new $b(this.core,this.logger),this.pendingRequest=new Lb(this.core,this.logger),this.engine=new Fb(this)}static async init(i){const r=new uf(i);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};const yl="error",zb="wss://relay.walletconnect.com",Mb="wc",jb="universal_provider",ml=`${Mb}@2:${jb}:`,Ub="https://rpc.walletconnect.com/v1/",ai={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,i){(function(){var r,n="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",y="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",v=500,E="__lodash_placeholder__",C=1,R=2,M=4,$=1,K=2,re=1,ce=2,ue=4,he=8,fe=16,pe=32,F=64,H=128,W=256,ve=512,te=30,Ee="...",Oe=800,et=16,O=1,z=2,Me=3,Re=1/0,J=9007199254740991,B=17976931348623157e292,k=0/0,V=4294967295,ut=V-1,He=V>>>1,Dr=[["ary",H],["bind",re],["bindKey",ce],["curry",he],["curryRight",fe],["flip",ve],["partial",pe],["partialRight",F],["rearg",W]],_e="[object Arguments]",It="[object Array]",N="[object AsyncFunction]",T="[object Boolean]",S="[object Date]",u="[object DOMException]",b="[object Error]",Z="[object Function]",oe="[object GeneratorFunction]",me="[object Map]",Te="[object Number]",Fe="[object Null]",xe="[object Object]",xt="[object Promise]",mt="[object Proxy]",nt="[object RegExp]",De="[object Set]",Je="[object String]",Qe="[object Symbol]",at="[object Undefined]",je="[object WeakMap]",Ye="[object WeakSet]",Ne="[object ArrayBuffer]",ke="[object DataView]",ht="[object Float32Array]",qe="[object Float64Array]",Pt="[object Int8Array]",$t="[object Int16Array]",Ut="[object Int32Array]",Ht="[object Uint8Array]",qt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",Lr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oi=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,lt=RegExp(oi.source),tt=RegExp(xi.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,At=RegExp(dt.source),gt=/^\s+/,wt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,We=/\{\n\/\* \[wrapped with (.+)\] \*/,Ot=/,? & /,Rt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wa=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,ba=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Ea=/^[-+]0x[0-9a-f]+$/i,Ia=/^0b[01]+$/i,xa=/^\[object .+?Constructor\]$/,Pa=/^0o[0-7]+$/i,Sa=/^(?:0|[1-9]\d*)$/,Br=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ki=/($^)/,Ca=/['\n\r\u2028\u2029\\]/g,Ki="\\ud800-\\udfff",Aa="\\u0300-\\u036f",Oa="\\ufe20-\\ufe2f",Bi="\\u20d0-\\u20ff",Js=Aa+Oa+Bi,Qs="\\u2700-\\u27bf",Cr="a-z\\xdf-\\xf6\\xf8-\\xff",Ra="\\xac\\xb1\\xd7\\xf7",Ta="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Na="\\u2000-\\u206f",Fa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ys="A-Z\\xc0-\\xd6\\xd8-\\xde",Xs="\\ufe0e\\ufe0f",Pi=Ra+Ta+Na+Fa,ds="[']",Si="["+Ki+"]",gs="["+Pi+"]",Ci="["+Js+"]",Zs="\\d+",$a="["+Qs+"]",en="["+Cr+"]",tn="[^"+Ki+Pi+Zs+Qs+Cr+Ys+"]",Vi="\\ud83c[\\udffb-\\udfff]",Da="(?:"+Ci+"|"+Vi+")",rn="[^"+Ki+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+Ys+"]",sn="\\u200d",nn="(?:"+en+"|"+tn+")",qr="(?:"+lr+"|"+tn+")",an="(?:"+ds+"(?:d|ll|m|re|s|t|ve))?",on="(?:"+ds+"(?:D|LL|M|RE|S|T|VE))?",cn=Da+"?",un="["+Xs+"]?",La="(?:"+sn+"(?:"+[rn,Gi,ci].join("|")+")"+un+cn+")*",Vr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ln=un+cn+La,Wi="(?:"+[$a,Gi,ci].join("|")+")"+ln,qa="(?:"+[rn+Ci+"?",Ci,Gi,ci,Si].join("|")+")",vs=RegExp(ds,"g"),za=RegExp(Ci,"g"),Ji=RegExp(Vi+"(?="+Vi+")|"+qa+ln,"g"),fn=RegExp([lr+"?"+en+"+"+an+"(?="+[gs,lr,"$"].join("|")+")",qr+"+"+on+"(?="+[gs,lr+nn,"$"].join("|")+")",lr+"?"+nn+"+"+an,lr+"+"+on,hn,Vr,Zs,Wi].join("|"),"g"),pn=RegExp("["+sn+Ki+Js+Xs+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ma=-1,Ke={};Ke[ht]=Ke[qe]=Ke[Pt]=Ke[$t]=Ke[Ut]=Ke[Ht]=Ke[qt]=Ke[Wt]=Ke[rr]=!0,Ke[_e]=Ke[It]=Ke[Ne]=Ke[T]=Ke[ke]=Ke[S]=Ke[b]=Ke[Z]=Ke[me]=Ke[Te]=Ke[xe]=Ke[nt]=Ke[De]=Ke[Je]=Ke[je]=!1;var Ue={};Ue[_e]=Ue[It]=Ue[Ne]=Ue[ke]=Ue[T]=Ue[S]=Ue[ht]=Ue[qe]=Ue[Pt]=Ue[$t]=Ue[Ut]=Ue[me]=Ue[Te]=Ue[xe]=Ue[nt]=Ue[De]=Ue[Je]=Ue[Qe]=Ue[Ht]=Ue[qt]=Ue[Wt]=Ue[rr]=!0,Ue[b]=Ue[Z]=Ue[je]=!1;var g={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},j={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Be=parseFloat,de=parseInt,Xe=typeof Ms=="object"&&Ms&&Ms.Object===Object&&Ms,Tt=typeof self=="object"&&self&&self.Object===Object&&self,Se=Xe||Tt||Function("return this")(),Ve=i&&!i.nodeType&&i,_t=Ve&&!0&&c&&!c.nodeType&&c,ir=_t&&_t.exports===Ve,Nt=ir&&Xe.process,Ze=function(){try{var x=_t&&_t.require&&_t.require("util").types;return x||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Qt=Ze&&Ze.isArrayBuffer,Ar=Ze&&Ze.isDate,mr=Ze&&Ze.isMap,zr=Ze&&Ze.isRegExp,ys=Ze&&Ze.isSet,Oi=Ze&&Ze.isTypedArray;function zt(x,D,A){switch(A.length){case 0:return x.call(D);case 1:return x.call(D,A[0]);case 2:return x.call(D,A[0],A[1]);case 3:return x.call(D,A[0],A[1],A[2])}return x.apply(D,A)}function ff(x,D,A,Y){for(var le=-1,$e=x==null?0:x.length;++le<$e;){var Dt=x[le];D(Y,Dt,A(Dt),x)}return Y}function wr(x,D){for(var A=-1,Y=x==null?0:x.length;++A<Y&&D(x[A],A,x)!==!1;);return x}function pf(x,D){for(var A=x==null?0:x.length;A--&&D(x[A],A,x)!==!1;);return x}function Cc(x,D){for(var A=-1,Y=x==null?0:x.length;++A<Y;)if(!D(x[A],A,x))return!1;return!0}function ui(x,D){for(var A=-1,Y=x==null?0:x.length,le=0,$e=[];++A<Y;){var Dt=x[A];D(Dt,A,x)&&($e[le++]=Dt)}return $e}function gn(x,D){var A=x==null?0:x.length;return!!A&&Qi(x,D,0)>-1}function ja(x,D,A){for(var Y=-1,le=x==null?0:x.length;++Y<le;)if(A(D,x[Y]))return!0;return!1}function it(x,D){for(var A=-1,Y=x==null?0:x.length,le=Array(Y);++A<Y;)le[A]=D(x[A],A,x);return le}function hi(x,D){for(var A=-1,Y=D.length,le=x.length;++A<Y;)x[le+A]=D[A];return x}function Ua(x,D,A,Y){var le=-1,$e=x==null?0:x.length;for(Y&&$e&&(A=x[++le]);++le<$e;)A=D(A,x[le],le,x);return A}function df(x,D,A,Y){var le=x==null?0:x.length;for(Y&&le&&(A=x[--le]);le--;)A=D(A,x[le],le,x);return A}function Ha(x,D){for(var A=-1,Y=x==null?0:x.length;++A<Y;)if(D(x[A],A,x))return!0;return!1}var gf=ka("length");function vf(x){return x.split("")}function yf(x){return x.match(Rt)||[]}function Ac(x,D,A){var Y;return A(x,function(le,$e,Dt){if(D(le,$e,Dt))return Y=$e,!1}),Y}function vn(x,D,A,Y){for(var le=x.length,$e=A+(Y?1:-1);Y?$e--:++$e<le;)if(D(x[$e],$e,x))return $e;return-1}function Qi(x,D,A){return D===D?Of(x,D,A):vn(x,Oc,A)}function mf(x,D,A,Y){for(var le=A-1,$e=x.length;++le<$e;)if(Y(x[le],D))return le;return-1}function Oc(x){return x!==x}function Rc(x,D){var A=x==null?0:x.length;return A?Ba(x,D)/A:k}function ka(x){return function(D){return D==null?r:D[x]}}function Ka(x){return function(D){return x==null?r:x[D]}}function Tc(x,D,A,Y,le){return le(x,function($e,Dt,Ge){A=Y?(Y=!1,$e):D(A,$e,Dt,Ge)}),A}function wf(x,D){var A=x.length;for(x.sort(D);A--;)x[A]=x[A].value;return x}function Ba(x,D){for(var A,Y=-1,le=x.length;++Y<le;){var $e=D(x[Y]);$e!==r&&(A=A===r?$e:A+$e)}return A}function Va(x,D){for(var A=-1,Y=Array(x);++A<x;)Y[A]=D(A);return Y}function _f(x,D){return it(D,function(A){return[A,x[A]]})}function Nc(x){return x&&x.slice(0,Lc(x)+1).replace(gt,"")}function fr(x){return function(D){return x(D)}}function Ga(x,D){return it(D,function(A){return x[A]})}function ms(x,D){return x.has(D)}function Fc(x,D){for(var A=-1,Y=x.length;++A<Y&&Qi(D,x[A],0)>-1;);return A}function $c(x,D){for(var A=x.length;A--&&Qi(D,x[A],0)>-1;);return A}function bf(x,D){for(var A=x.length,Y=0;A--;)x[A]===D&&++Y;return Y}var Ef=Ka(g),If=Ka(I);function xf(x){return"\\"+Q[x]}function Pf(x,D){return x==null?r:x[D]}function Yi(x){return pn.test(x)}function Sf(x){return Ai.test(x)}function Cf(x){for(var D,A=[];!(D=x.next()).done;)A.push(D.value);return A}function Wa(x){var D=-1,A=Array(x.size);return x.forEach(function(Y,le){A[++D]=[le,Y]}),A}function Dc(x,D){return function(A){return x(D(A))}}function li(x,D){for(var A=-1,Y=x.length,le=0,$e=[];++A<Y;){var Dt=x[A];(Dt===D||Dt===E)&&(x[A]=E,$e[le++]=A)}return $e}function yn(x){var D=-1,A=Array(x.size);return x.forEach(function(Y){A[++D]=Y}),A}function Af(x){var D=-1,A=Array(x.size);return x.forEach(function(Y){A[++D]=[Y,Y]}),A}function Of(x,D,A){for(var Y=A-1,le=x.length;++Y<le;)if(x[Y]===D)return Y;return-1}function Rf(x,D,A){for(var Y=A+1;Y--;)if(x[Y]===D)return Y;return Y}function Xi(x){return Yi(x)?Nf(x):gf(x)}function Or(x){return Yi(x)?Ff(x):vf(x)}function Lc(x){for(var D=x.length;D--&&wt.test(x.charAt(D)););return D}var Tf=Ka(j);function Nf(x){for(var D=Ji.lastIndex=0;Ji.test(x);)++D;return D}function Ff(x){return x.match(Ji)||[]}function $f(x){return x.match(fn)||[]}var Df=function x(D){D=D==null?Se:Zi.defaults(Se.Object(),D,Zi.pick(Se,dn));var A=D.Array,Y=D.Date,le=D.Error,$e=D.Function,Dt=D.Math,Ge=D.Object,Ja=D.RegExp,Lf=D.String,_r=D.TypeError,mn=A.prototype,qf=$e.prototype,es=Ge.prototype,wn=D["__core-js_shared__"],_n=qf.toString,ze=es.hasOwnProperty,zf=0,qc=function(){var e=/[^.]+$/.exec(wn&&wn.keys&&wn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bn=es.toString,Mf=_n.call(Ge),jf=Se._,Uf=Ja("^"+_n.call(ze).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),En=ir?D.Buffer:r,fi=D.Symbol,In=D.Uint8Array,zc=En?En.allocUnsafe:r,xn=Dc(Ge.getPrototypeOf,Ge),Mc=Ge.create,jc=es.propertyIsEnumerable,Pn=mn.splice,Uc=fi?fi.isConcatSpreadable:r,ws=fi?fi.iterator:r,Ri=fi?fi.toStringTag:r,Sn=function(){try{var e=Di(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),Hf=D.clearTimeout!==Se.clearTimeout&&D.clearTimeout,kf=Y&&Y.now!==Se.Date.now&&Y.now,Kf=D.setTimeout!==Se.setTimeout&&D.setTimeout,Cn=Dt.ceil,An=Dt.floor,Qa=Ge.getOwnPropertySymbols,Bf=En?En.isBuffer:r,Hc=D.isFinite,Vf=mn.join,Gf=Dc(Ge.keys,Ge),Lt=Dt.max,Bt=Dt.min,Wf=Y.now,Jf=D.parseInt,kc=Dt.random,Qf=mn.reverse,Ya=Di(D,"DataView"),_s=Di(D,"Map"),Xa=Di(D,"Promise"),ts=Di(D,"Set"),bs=Di(D,"WeakMap"),Es=Di(Ge,"create"),On=bs&&new bs,rs={},Yf=Li(Ya),Xf=Li(_s),Zf=Li(Xa),ep=Li(ts),tp=Li(bs),Rn=fi?fi.prototype:r,Is=Rn?Rn.valueOf:r,Kc=Rn?Rn.toString:r;function f(e){if(yt(e)&&!ge(e)&&!(e instanceof Pe)){if(e instanceof br)return e;if(ze.call(e,"__wrapped__"))return Bu(e)}return new br(e)}var is=function(){function e(){}return function(t){if(!ct(t))return{};if(Mc)return Mc(t);e.prototype=t;var s=new e;return e.prototype=r,s}}();function Tn(){}function br(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:ft,evaluate:pt,interpolate:ot,variable:"",imports:{_:f}},f.prototype=Tn.prototype,f.prototype.constructor=f,br.prototype=is(Tn.prototype),br.prototype.constructor=br;function Pe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=V,this.__views__=[]}function rp(){var e=new Pe(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function ip(){if(this.__filtered__){var e=new Pe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function sp(){var e=this.__wrapped__.value(),t=this.__dir__,s=ge(e),o=t<0,h=s?e.length:0,p=vd(0,h,this.__views__),m=p.start,_=p.end,P=_-m,L=o?_:m-1,q=this.__iteratees__,U=q.length,G=0,ee=Bt(P,this.__takeCount__);if(!s||!o&&h==P&&ee==P)return du(e,this.__actions__);var ne=[];e:for(;P--&&G<ee;){L+=t;for(var we=-1,ae=e[L];++we<U;){var Ie=q[we],Ce=Ie.iteratee,gr=Ie.type,Zt=Ce(ae);if(gr==z)ae=Zt;else if(!Zt){if(gr==O)continue e;break e}}ne[G++]=ae}return ne}Pe.prototype=is(Tn.prototype),Pe.prototype.constructor=Pe;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function np(){this.__data__=Es?Es(null):{},this.size=0}function ap(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function op(e){var t=this.__data__;if(Es){var s=t[e];return s===w?r:s}return ze.call(t,e)?t[e]:r}function cp(e){var t=this.__data__;return Es?t[e]!==r:ze.call(t,e)}function up(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Es&&t===r?w:t,this}Ti.prototype.clear=np,Ti.prototype.delete=ap,Ti.prototype.get=op,Ti.prototype.has=cp,Ti.prototype.set=up;function Gr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function hp(){this.__data__=[],this.size=0}function lp(e){var t=this.__data__,s=Nn(t,e);if(s<0)return!1;var o=t.length-1;return s==o?t.pop():Pn.call(t,s,1),--this.size,!0}function fp(e){var t=this.__data__,s=Nn(t,e);return s<0?r:t[s][1]}function pp(e){return Nn(this.__data__,e)>-1}function dp(e,t){var s=this.__data__,o=Nn(s,e);return o<0?(++this.size,s.push([e,t])):s[o][1]=t,this}Gr.prototype.clear=hp,Gr.prototype.delete=lp,Gr.prototype.get=fp,Gr.prototype.has=pp,Gr.prototype.set=dp;function Wr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function gp(){this.size=0,this.__data__={hash:new Ti,map:new(_s||Gr),string:new Ti}}function vp(e){var t=Kn(this,e).delete(e);return this.size-=t?1:0,t}function yp(e){return Kn(this,e).get(e)}function mp(e){return Kn(this,e).has(e)}function wp(e,t){var s=Kn(this,e),o=s.size;return s.set(e,t),this.size+=s.size==o?0:1,this}Wr.prototype.clear=gp,Wr.prototype.delete=vp,Wr.prototype.get=yp,Wr.prototype.has=mp,Wr.prototype.set=wp;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Wr;++t<s;)this.add(e[t])}function _p(e){return this.__data__.set(e,w),this}function bp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=_p,Ni.prototype.has=bp;function Rr(e){var t=this.__data__=new Gr(e);this.size=t.size}function Ep(){this.__data__=new Gr,this.size=0}function Ip(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function xp(e){return this.__data__.get(e)}function Pp(e){return this.__data__.has(e)}function Sp(e,t){var s=this.__data__;if(s instanceof Gr){var o=s.__data__;if(!_s||o.length<a-1)return o.push([e,t]),this.size=++s.size,this;s=this.__data__=new Wr(o)}return s.set(e,t),this.size=s.size,this}Rr.prototype.clear=Ep,Rr.prototype.delete=Ip,Rr.prototype.get=xp,Rr.prototype.has=Pp,Rr.prototype.set=Sp;function Bc(e,t){var s=ge(e),o=!s&&qi(e),h=!s&&!o&&yi(e),p=!s&&!o&&!h&&os(e),m=s||o||h||p,_=m?Va(e.length,Lf):[],P=_.length;for(var L in e)(t||ze.call(e,L))&&!(m&&(L=="length"||h&&(L=="offset"||L=="parent")||p&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||Xr(L,P)))&&_.push(L);return _}function Vc(e){var t=e.length;return t?e[uo(0,t-1)]:r}function Cp(e,t){return Bn(sr(e),Fi(t,0,e.length))}function Ap(e){return Bn(sr(e))}function Za(e,t,s){(s!==r&&!Tr(e[t],s)||s===r&&!(t in e))&&Jr(e,t,s)}function xs(e,t,s){var o=e[t];(!(ze.call(e,t)&&Tr(o,s))||s===r&&!(t in e))&&Jr(e,t,s)}function Nn(e,t){for(var s=e.length;s--;)if(Tr(e[s][0],t))return s;return-1}function Op(e,t,s,o){return pi(e,function(h,p,m){t(o,h,s(h),m)}),o}function Gc(e,t){return e&&jr(t,Mt(t),e)}function Rp(e,t){return e&&jr(t,ar(t),e)}function Jr(e,t,s){t=="__proto__"&&Sn?Sn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function eo(e,t){for(var s=-1,o=t.length,h=A(o),p=e==null;++s<o;)h[s]=p?r:Do(e,t[s]);return h}function Fi(e,t,s){return e===e&&(s!==r&&(e=e<=s?e:s),t!==r&&(e=e>=t?e:t)),e}function Er(e,t,s,o,h,p){var m,_=t&C,P=t&R,L=t&M;if(s&&(m=h?s(e,o,h,p):s(e)),m!==r)return m;if(!ct(e))return e;var q=ge(e);if(q){if(m=md(e),!_)return sr(e,m)}else{var U=Vt(e),G=U==Z||U==oe;if(yi(e))return yu(e,_);if(U==xe||U==_e||G&&!h){if(m=P||G?{}:Lu(e),!_)return P?od(e,Rp(m,e)):ad(e,Gc(m,e))}else{if(!Ue[U])return h?e:{};m=wd(e,U,_)}}p||(p=new Rr);var ee=p.get(e);if(ee)return ee;p.set(e,m),lh(e)?e.forEach(function(ae){m.add(Er(ae,t,s,ae,e,p))}):uh(e)&&e.forEach(function(ae,Ie){m.set(Ie,Er(ae,t,s,Ie,e,p))});var ne=L?P?bo:_o:P?ar:Mt,we=q?r:ne(e);return wr(we||e,function(ae,Ie){we&&(Ie=ae,ae=e[Ie]),xs(m,Ie,Er(ae,t,s,Ie,e,p))}),m}function Tp(e){var t=Mt(e);return function(s){return Wc(s,e,t)}}function Wc(e,t,s){var o=s.length;if(e==null)return!o;for(e=Ge(e);o--;){var h=s[o],p=t[h],m=e[h];if(m===r&&!(h in e)||!p(m))return!1}return!0}function Jc(e,t,s){if(typeof e!="function")throw new _r(d);return Ts(function(){e.apply(r,s)},t)}function Ps(e,t,s,o){var h=-1,p=gn,m=!0,_=e.length,P=[],L=t.length;if(!_)return P;s&&(t=it(t,fr(s))),o?(p=ja,m=!1):t.length>=a&&(p=ms,m=!1,t=new Ni(t));e:for(;++h<_;){var q=e[h],U=s==null?q:s(q);if(q=o||q!==0?q:0,m&&U===U){for(var G=L;G--;)if(t[G]===U)continue e;P.push(q)}else p(t,U,o)||P.push(q)}return P}var pi=Eu(Mr),Qc=Eu(ro,!0);function Np(e,t){var s=!0;return pi(e,function(o,h,p){return s=!!t(o,h,p),s}),s}function Fn(e,t,s){for(var o=-1,h=e.length;++o<h;){var p=e[o],m=t(p);if(m!=null&&(_===r?m===m&&!dr(m):s(m,_)))var _=m,P=p}return P}function Fp(e,t,s,o){var h=e.length;for(s=ye(s),s<0&&(s=-s>h?0:h+s),o=o===r||o>h?h:ye(o),o<0&&(o+=h),o=s>o?0:ph(o);s<o;)e[s++]=t;return e}function Yc(e,t){var s=[];return pi(e,function(o,h,p){t(o,h,p)&&s.push(o)}),s}function kt(e,t,s,o,h){var p=-1,m=e.length;for(s||(s=bd),h||(h=[]);++p<m;){var _=e[p];t>0&&s(_)?t>1?kt(_,t-1,s,o,h):hi(h,_):o||(h[h.length]=_)}return h}var to=Iu(),Xc=Iu(!0);function Mr(e,t){return e&&to(e,t,Mt)}function ro(e,t){return e&&Xc(e,t,Mt)}function $n(e,t){return ui(t,function(s){return Zr(e[s])})}function $i(e,t){t=gi(t,e);for(var s=0,o=t.length;e!=null&&s<o;)e=e[Ur(t[s++])];return s&&s==o?e:r}function Zc(e,t,s){var o=t(e);return ge(e)?o:hi(o,s(e))}function Yt(e){return e==null?e===r?at:Fe:Ri&&Ri in Ge(e)?gd(e):Ad(e)}function io(e,t){return e>t}function $p(e,t){return e!=null&&ze.call(e,t)}function Dp(e,t){return e!=null&&t in Ge(e)}function Lp(e,t,s){return e>=Bt(t,s)&&e<Lt(t,s)}function so(e,t,s){for(var o=s?ja:gn,h=e[0].length,p=e.length,m=p,_=A(p),P=1/0,L=[];m--;){var q=e[m];m&&t&&(q=it(q,fr(t))),P=Bt(q.length,P),_[m]=!s&&(t||h>=120&&q.length>=120)?new Ni(m&&q):r}q=e[0];var U=-1,G=_[0];e:for(;++U<h&&L.length<P;){var ee=q[U],ne=t?t(ee):ee;if(ee=s||ee!==0?ee:0,!(G?ms(G,ne):o(L,ne,s))){for(m=p;--m;){var we=_[m];if(!(we?ms(we,ne):o(e[m],ne,s)))continue e}G&&G.push(ne),L.push(ee)}}return L}function qp(e,t,s,o){return Mr(e,function(h,p,m){t(o,s(h),p,m)}),o}function Ss(e,t,s){t=gi(t,e),e=ju(e,t);var o=e==null?e:e[Ur(xr(t))];return o==null?r:zt(o,e,s)}function eu(e){return yt(e)&&Yt(e)==_e}function zp(e){return yt(e)&&Yt(e)==Ne}function Mp(e){return yt(e)&&Yt(e)==S}function Cs(e,t,s,o,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:jp(e,t,s,o,Cs,h)}function jp(e,t,s,o,h,p){var m=ge(e),_=ge(t),P=m?It:Vt(e),L=_?It:Vt(t);P=P==_e?xe:P,L=L==_e?xe:L;var q=P==xe,U=L==xe,G=P==L;if(G&&yi(e)){if(!yi(t))return!1;m=!0,q=!1}if(G&&!q)return p||(p=new Rr),m||os(e)?Fu(e,t,s,o,h,p):pd(e,t,P,s,o,h,p);if(!(s&$)){var ee=q&&ze.call(e,"__wrapped__"),ne=U&&ze.call(t,"__wrapped__");if(ee||ne){var we=ee?e.value():e,ae=ne?t.value():t;return p||(p=new Rr),h(we,ae,s,o,p)}}return G?(p||(p=new Rr),dd(e,t,s,o,h,p)):!1}function Up(e){return yt(e)&&Vt(e)==me}function no(e,t,s,o){var h=s.length,p=h,m=!o;if(e==null)return!p;for(e=Ge(e);h--;){var _=s[h];if(m&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++h<p;){_=s[h];var P=_[0],L=e[P],q=_[1];if(m&&_[2]){if(L===r&&!(P in e))return!1}else{var U=new Rr;if(o)var G=o(L,q,P,e,t,U);if(!(G===r?Cs(q,L,$|K,o,U):G))return!1}}return!0}function tu(e){if(!ct(e)||Id(e))return!1;var t=Zr(e)?Uf:xa;return t.test(Li(e))}function Hp(e){return yt(e)&&Yt(e)==nt}function kp(e){return yt(e)&&Vt(e)==De}function Kp(e){return yt(e)&&Yn(e.length)&&!!Ke[Yt(e)]}function ru(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?ge(e)?nu(e[0],e[1]):su(e):xh(e)}function ao(e){if(!Rs(e))return Gf(e);var t=[];for(var s in Ge(e))ze.call(e,s)&&s!="constructor"&&t.push(s);return t}function Bp(e){if(!ct(e))return Cd(e);var t=Rs(e),s=[];for(var o in e)o=="constructor"&&(t||!ze.call(e,o))||s.push(o);return s}function oo(e,t){return e<t}function iu(e,t){var s=-1,o=nr(e)?A(e.length):[];return pi(e,function(h,p,m){o[++s]=t(h,p,m)}),o}function su(e){var t=Io(e);return t.length==1&&t[0][2]?zu(t[0][0],t[0][1]):function(s){return s===e||no(s,e,t)}}function nu(e,t){return Po(e)&&qu(t)?zu(Ur(e),t):function(s){var o=Do(s,e);return o===r&&o===t?Lo(s,e):Cs(t,o,$|K)}}function Dn(e,t,s,o,h){e!==t&&to(t,function(p,m){if(h||(h=new Rr),ct(p))Vp(e,t,m,s,Dn,o,h);else{var _=o?o(Co(e,m),p,m+"",e,t,h):r;_===r&&(_=p),Za(e,m,_)}},ar)}function Vp(e,t,s,o,h,p,m){var _=Co(e,s),P=Co(t,s),L=m.get(P);if(L){Za(e,s,L);return}var q=p?p(_,P,s+"",e,t,m):r,U=q===r;if(U){var G=ge(P),ee=!G&&yi(P),ne=!G&&!ee&&os(P);q=P,G||ee||ne?ge(_)?q=_:bt(_)?q=sr(_):ee?(U=!1,q=yu(P,!0)):ne?(U=!1,q=mu(P,!0)):q=[]:Ns(P)||qi(P)?(q=_,qi(_)?q=dh(_):(!ct(_)||Zr(_))&&(q=Lu(P))):U=!1}U&&(m.set(P,q),h(q,P,o,p,m),m.delete(P)),Za(e,s,q)}function au(e,t){var s=e.length;if(s)return t+=t<0?s:0,Xr(t,s)?e[t]:r}function ou(e,t,s){t.length?t=it(t,function(p){return ge(p)?function(m){return $i(m,p.length===1?p[0]:p)}:p}):t=[or];var o=-1;t=it(t,fr(se()));var h=iu(e,function(p,m,_){var P=it(t,function(L){return L(p)});return{criteria:P,index:++o,value:p}});return wf(h,function(p,m){return nd(p,m,s)})}function Gp(e,t){return cu(e,t,function(s,o){return Lo(e,o)})}function cu(e,t,s){for(var o=-1,h=t.length,p={};++o<h;){var m=t[o],_=$i(e,m);s(_,m)&&As(p,gi(m,e),_)}return p}function Wp(e){return function(t){return $i(t,e)}}function co(e,t,s,o){var h=o?mf:Qi,p=-1,m=t.length,_=e;for(e===t&&(t=sr(t)),s&&(_=it(e,fr(s)));++p<m;)for(var P=0,L=t[p],q=s?s(L):L;(P=h(_,q,P,o))>-1;)_!==e&&Pn.call(_,P,1),Pn.call(e,P,1);return e}function uu(e,t){for(var s=e?t.length:0,o=s-1;s--;){var h=t[s];if(s==o||h!==p){var p=h;Xr(h)?Pn.call(e,h,1):fo(e,h)}}return e}function uo(e,t){return e+An(kc()*(t-e+1))}function Jp(e,t,s,o){for(var h=-1,p=Lt(Cn((t-e)/(s||1)),0),m=A(p);p--;)m[o?p:++h]=e,e+=s;return m}function ho(e,t){var s="";if(!e||t<1||t>J)return s;do t%2&&(s+=e),t=An(t/2),t&&(e+=e);while(t);return s}function be(e,t){return Ao(Mu(e,t,or),e+"")}function Qp(e){return Vc(cs(e))}function Yp(e,t){var s=cs(e);return Bn(s,Fi(t,0,s.length))}function As(e,t,s,o){if(!ct(e))return e;t=gi(t,e);for(var h=-1,p=t.length,m=p-1,_=e;_!=null&&++h<p;){var P=Ur(t[h]),L=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(h!=m){var q=_[P];L=o?o(q,P,_):r,L===r&&(L=ct(q)?q:Xr(t[h+1])?[]:{})}xs(_,P,L),_=_[P]}return e}var hu=On?function(e,t){return On.set(e,t),e}:or,Xp=Sn?function(e,t){return Sn(e,"toString",{configurable:!0,enumerable:!1,value:zo(t),writable:!0})}:or;function Zp(e){return Bn(cs(e))}function Ir(e,t,s){var o=-1,h=e.length;t<0&&(t=-t>h?0:h+t),s=s>h?h:s,s<0&&(s+=h),h=t>s?0:s-t>>>0,t>>>=0;for(var p=A(h);++o<h;)p[o]=e[o+t];return p}function ed(e,t){var s;return pi(e,function(o,h,p){return s=t(o,h,p),!s}),!!s}function Ln(e,t,s){var o=0,h=e==null?o:e.length;if(typeof t=="number"&&t===t&&h<=He){for(;o<h;){var p=o+h>>>1,m=e[p];m!==null&&!dr(m)&&(s?m<=t:m<t)?o=p+1:h=p}return h}return lo(e,t,or,s)}function lo(e,t,s,o){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var m=t!==t,_=t===null,P=dr(t),L=t===r;h<p;){var q=An((h+p)/2),U=s(e[q]),G=U!==r,ee=U===null,ne=U===U,we=dr(U);if(m)var ae=o||ne;else L?ae=ne&&(o||G):_?ae=ne&&G&&(o||!ee):P?ae=ne&&G&&!ee&&(o||!we):ee||we?ae=!1:ae=o?U<=t:U<t;ae?h=q+1:p=q}return Bt(p,ut)}function lu(e,t){for(var s=-1,o=e.length,h=0,p=[];++s<o;){var m=e[s],_=t?t(m):m;if(!s||!Tr(_,P)){var P=_;p[h++]=m===0?0:m}}return p}function fu(e){return typeof e=="number"?e:dr(e)?k:+e}function pr(e){if(typeof e=="string")return e;if(ge(e))return it(e,pr)+"";if(dr(e))return Kc?Kc.call(e):"";var t=e+"";return t=="0"&&1/e==-Re?"-0":t}function di(e,t,s){var o=-1,h=gn,p=e.length,m=!0,_=[],P=_;if(s)m=!1,h=ja;else if(p>=a){var L=t?null:ld(e);if(L)return yn(L);m=!1,h=ms,P=new Ni}else P=t?[]:_;e:for(;++o<p;){var q=e[o],U=t?t(q):q;if(q=s||q!==0?q:0,m&&U===U){for(var G=P.length;G--;)if(P[G]===U)continue e;t&&P.push(U),_.push(q)}else h(P,U,s)||(P!==_&&P.push(U),_.push(q))}return _}function fo(e,t){return t=gi(t,e),e=ju(e,t),e==null||delete e[Ur(xr(t))]}function pu(e,t,s,o){return As(e,t,s($i(e,t)),o)}function qn(e,t,s,o){for(var h=e.length,p=o?h:-1;(o?p--:++p<h)&&t(e[p],p,e););return s?Ir(e,o?0:p,o?p+1:h):Ir(e,o?p+1:0,o?h:p)}function du(e,t){var s=e;return s instanceof Pe&&(s=s.value()),Ua(t,function(o,h){return h.func.apply(h.thisArg,hi([o],h.args))},s)}function po(e,t,s){var o=e.length;if(o<2)return o?di(e[0]):[];for(var h=-1,p=A(o);++h<o;)for(var m=e[h],_=-1;++_<o;)_!=h&&(p[h]=Ps(p[h]||m,e[_],t,s));return di(kt(p,1),t,s)}function gu(e,t,s){for(var o=-1,h=e.length,p=t.length,m={};++o<h;){var _=o<p?t[o]:r;s(m,e[o],_)}return m}function go(e){return bt(e)?e:[]}function vo(e){return typeof e=="function"?e:or}function gi(e,t){return ge(e)?e:Po(e,t)?[e]:Ku(Le(e))}var td=be;function vi(e,t,s){var o=e.length;return s=s===r?o:s,!t&&s>=o?e:Ir(e,t,s)}var vu=Hf||function(e){return Se.clearTimeout(e)};function yu(e,t){if(t)return e.slice();var s=e.length,o=zc?zc(s):new e.constructor(s);return e.copy(o),o}function yo(e){var t=new e.constructor(e.byteLength);return new In(t).set(new In(e)),t}function rd(e,t){var s=t?yo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function id(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function sd(e){return Is?Ge(Is.call(e)):{}}function mu(e,t){var s=t?yo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function wu(e,t){if(e!==t){var s=e!==r,o=e===null,h=e===e,p=dr(e),m=t!==r,_=t===null,P=t===t,L=dr(t);if(!_&&!L&&!p&&e>t||p&&m&&P&&!_&&!L||o&&m&&P||!s&&P||!h)return 1;if(!o&&!p&&!L&&e<t||L&&s&&h&&!o&&!p||_&&s&&h||!m&&h||!P)return-1}return 0}function nd(e,t,s){for(var o=-1,h=e.criteria,p=t.criteria,m=h.length,_=s.length;++o<m;){var P=wu(h[o],p[o]);if(P){if(o>=_)return P;var L=s[o];return P*(L=="desc"?-1:1)}}return e.index-t.index}function _u(e,t,s,o){for(var h=-1,p=e.length,m=s.length,_=-1,P=t.length,L=Lt(p-m,0),q=A(P+L),U=!o;++_<P;)q[_]=t[_];for(;++h<m;)(U||h<p)&&(q[s[h]]=e[h]);for(;L--;)q[_++]=e[h++];return q}function bu(e,t,s,o){for(var h=-1,p=e.length,m=-1,_=s.length,P=-1,L=t.length,q=Lt(p-_,0),U=A(q+L),G=!o;++h<q;)U[h]=e[h];for(var ee=h;++P<L;)U[ee+P]=t[P];for(;++m<_;)(G||h<p)&&(U[ee+s[m]]=e[h++]);return U}function sr(e,t){var s=-1,o=e.length;for(t||(t=A(o));++s<o;)t[s]=e[s];return t}function jr(e,t,s,o){var h=!s;s||(s={});for(var p=-1,m=t.length;++p<m;){var _=t[p],P=o?o(s[_],e[_],_,s,e):r;P===r&&(P=e[_]),h?Jr(s,_,P):xs(s,_,P)}return s}function ad(e,t){return jr(e,xo(e),t)}function od(e,t){return jr(e,$u(e),t)}function zn(e,t){return function(s,o){var h=ge(s)?ff:Op,p=t?t():{};return h(s,e,se(o,2),p)}}function ss(e){return be(function(t,s){var o=-1,h=s.length,p=h>1?s[h-1]:r,m=h>2?s[2]:r;for(p=e.length>3&&typeof p=="function"?(h--,p):r,m&&Xt(s[0],s[1],m)&&(p=h<3?r:p,h=1),t=Ge(t);++o<h;){var _=s[o];_&&e(t,_,o,p)}return t})}function Eu(e,t){return function(s,o){if(s==null)return s;if(!nr(s))return e(s,o);for(var h=s.length,p=t?h:-1,m=Ge(s);(t?p--:++p<h)&&o(m[p],p,m)!==!1;);return s}}function Iu(e){return function(t,s,o){for(var h=-1,p=Ge(t),m=o(t),_=m.length;_--;){var P=m[e?_:++h];if(s(p[P],P,p)===!1)break}return t}}function cd(e,t,s){var o=t&re,h=Os(e);function p(){var m=this&&this!==Se&&this instanceof p?h:e;return m.apply(o?s:this,arguments)}return p}function xu(e){return function(t){t=Le(t);var s=Yi(t)?Or(t):r,o=s?s[0]:t.charAt(0),h=s?vi(s,1).join(""):t.slice(1);return o[e]()+h}}function ns(e){return function(t){return Ua(Eh(bh(t).replace(vs,"")),e,"")}}function Os(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=is(e.prototype),o=e.apply(s,t);return ct(o)?o:s}}function ud(e,t,s){var o=Os(e);function h(){for(var p=arguments.length,m=A(p),_=p,P=as(h);_--;)m[_]=arguments[_];var L=p<3&&m[0]!==P&&m[p-1]!==P?[]:li(m,P);if(p-=L.length,p<s)return Ou(e,t,Mn,h.placeholder,r,m,L,r,r,s-p);var q=this&&this!==Se&&this instanceof h?o:e;return zt(q,this,m)}return h}function Pu(e){return function(t,s,o){var h=Ge(t);if(!nr(t)){var p=se(s,3);t=Mt(t),s=function(_){return p(h[_],_,h)}}var m=e(t,s,o);return m>-1?h[p?t[m]:m]:r}}function Su(e){return Yr(function(t){var s=t.length,o=s,h=br.prototype.thru;for(e&&t.reverse();o--;){var p=t[o];if(typeof p!="function")throw new _r(d);if(h&&!m&&kn(p)=="wrapper")var m=new br([],!0)}for(o=m?o:s;++o<s;){p=t[o];var _=kn(p),P=_=="wrapper"?Eo(p):r;P&&So(P[0])&&P[1]==(H|he|pe|W)&&!P[4].length&&P[9]==1?m=m[kn(P[0])].apply(m,P[3]):m=p.length==1&&So(p)?m[_]():m.thru(p)}return function(){var L=arguments,q=L[0];if(m&&L.length==1&&ge(q))return m.plant(q).value();for(var U=0,G=s?t[U].apply(this,L):q;++U<s;)G=t[U].call(this,G);return G}})}function Mn(e,t,s,o,h,p,m,_,P,L){var q=t&H,U=t&re,G=t&ce,ee=t&(he|fe),ne=t&ve,we=G?r:Os(e);function ae(){for(var Ie=arguments.length,Ce=A(Ie),gr=Ie;gr--;)Ce[gr]=arguments[gr];if(ee)var Zt=as(ae),vr=bf(Ce,Zt);if(o&&(Ce=_u(Ce,o,h,ee)),p&&(Ce=bu(Ce,p,m,ee)),Ie-=vr,ee&&Ie<L){var Et=li(Ce,Zt);return Ou(e,t,Mn,ae.placeholder,s,Ce,Et,_,P,L-Ie)}var Nr=U?s:this,ti=G?Nr[e]:e;return Ie=Ce.length,_?Ce=Od(Ce,_):ne&&Ie>1&&Ce.reverse(),q&&P<Ie&&(Ce.length=P),this&&this!==Se&&this instanceof ae&&(ti=we||Os(ti)),ti.apply(Nr,Ce)}return ae}function Cu(e,t){return function(s,o){return qp(s,e,t(o),{})}}function jn(e,t){return function(s,o){var h;if(s===r&&o===r)return t;if(s!==r&&(h=s),o!==r){if(h===r)return o;typeof s=="string"||typeof o=="string"?(s=pr(s),o=pr(o)):(s=fu(s),o=fu(o)),h=e(s,o)}return h}}function mo(e){return Yr(function(t){return t=it(t,fr(se())),be(function(s){var o=this;return e(t,function(h){return zt(h,o,s)})})})}function Un(e,t){t=t===r?" ":pr(t);var s=t.length;if(s<2)return s?ho(t,e):t;var o=ho(t,Cn(e/Xi(t)));return Yi(t)?vi(Or(o),0,e).join(""):o.slice(0,e)}function hd(e,t,s,o){var h=t&re,p=Os(e);function m(){for(var _=-1,P=arguments.length,L=-1,q=o.length,U=A(q+P),G=this&&this!==Se&&this instanceof m?p:e;++L<q;)U[L]=o[L];for(;P--;)U[L++]=arguments[++_];return zt(G,h?s:this,U)}return m}function Au(e){return function(t,s,o){return o&&typeof o!="number"&&Xt(t,s,o)&&(s=o=r),t=ei(t),s===r?(s=t,t=0):s=ei(s),o=o===r?t<s?1:-1:ei(o),Jp(t,s,o,e)}}function Hn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Pr(t),s=Pr(s)),e(t,s)}}function Ou(e,t,s,o,h,p,m,_,P,L){var q=t&he,U=q?m:r,G=q?r:m,ee=q?p:r,ne=q?r:p;t|=q?pe:F,t&=~(q?F:pe),t&ue||(t&=~(re|ce));var we=[e,t,h,ee,U,ne,G,_,P,L],ae=s.apply(r,we);return So(e)&&Uu(ae,we),ae.placeholder=o,Hu(ae,e,t)}function wo(e){var t=Dt[e];return function(s,o){if(s=Pr(s),o=o==null?0:Bt(ye(o),292),o&&Hc(s)){var h=(Le(s)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+o));return h=(Le(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-o))}return t(s)}}var ld=ts&&1/yn(new ts([,-0]))[1]==Re?function(e){return new ts(e)}:Uo;function Ru(e){return function(t){var s=Vt(t);return s==me?Wa(t):s==De?Af(t):_f(t,e(t))}}function Qr(e,t,s,o,h,p,m,_){var P=t&ce;if(!P&&typeof e!="function")throw new _r(d);var L=o?o.length:0;if(L||(t&=~(pe|F),o=h=r),m=m===r?m:Lt(ye(m),0),_=_===r?_:ye(_),L-=h?h.length:0,t&F){var q=o,U=h;o=h=r}var G=P?r:Eo(e),ee=[e,t,s,o,h,q,U,p,m,_];if(G&&Sd(ee,G),e=ee[0],t=ee[1],s=ee[2],o=ee[3],h=ee[4],_=ee[9]=ee[9]===r?P?0:e.length:Lt(ee[9]-L,0),!_&&t&(he|fe)&&(t&=~(he|fe)),!t||t==re)var ne=cd(e,t,s);else t==he||t==fe?ne=ud(e,t,_):(t==pe||t==(re|pe))&&!h.length?ne=hd(e,t,s,o):ne=Mn.apply(r,ee);var we=G?hu:Uu;return Hu(we(ne,ee),e,t)}function Tu(e,t,s,o){return e===r||Tr(e,es[s])&&!ze.call(o,s)?t:e}function Nu(e,t,s,o,h,p){return ct(e)&&ct(t)&&(p.set(t,e),Dn(e,t,r,Nu,p),p.delete(t)),e}function fd(e){return Ns(e)?r:e}function Fu(e,t,s,o,h,p){var m=s&$,_=e.length,P=t.length;if(_!=P&&!(m&&P>_))return!1;var L=p.get(e),q=p.get(t);if(L&&q)return L==t&&q==e;var U=-1,G=!0,ee=s&K?new Ni:r;for(p.set(e,t),p.set(t,e);++U<_;){var ne=e[U],we=t[U];if(o)var ae=m?o(we,ne,U,t,e,p):o(ne,we,U,e,t,p);if(ae!==r){if(ae)continue;G=!1;break}if(ee){if(!Ha(t,function(Ie,Ce){if(!ms(ee,Ce)&&(ne===Ie||h(ne,Ie,s,o,p)))return ee.push(Ce)})){G=!1;break}}else if(!(ne===we||h(ne,we,s,o,p))){G=!1;break}}return p.delete(e),p.delete(t),G}function pd(e,t,s,o,h,p,m){switch(s){case ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ne:return!(e.byteLength!=t.byteLength||!p(new In(e),new In(t)));case T:case S:case Te:return Tr(+e,+t);case b:return e.name==t.name&&e.message==t.message;case nt:case Je:return e==t+"";case me:var _=Wa;case De:var P=o&$;if(_||(_=yn),e.size!=t.size&&!P)return!1;var L=m.get(e);if(L)return L==t;o|=K,m.set(e,t);var q=Fu(_(e),_(t),o,h,p,m);return m.delete(e),q;case Qe:if(Is)return Is.call(e)==Is.call(t)}return!1}function dd(e,t,s,o,h,p){var m=s&$,_=_o(e),P=_.length,L=_o(t),q=L.length;if(P!=q&&!m)return!1;for(var U=P;U--;){var G=_[U];if(!(m?G in t:ze.call(t,G)))return!1}var ee=p.get(e),ne=p.get(t);if(ee&&ne)return ee==t&&ne==e;var we=!0;p.set(e,t),p.set(t,e);for(var ae=m;++U<P;){G=_[U];var Ie=e[G],Ce=t[G];if(o)var gr=m?o(Ce,Ie,G,t,e,p):o(Ie,Ce,G,e,t,p);if(!(gr===r?Ie===Ce||h(Ie,Ce,s,o,p):gr)){we=!1;break}ae||(ae=G=="constructor")}if(we&&!ae){var Zt=e.constructor,vr=t.constructor;Zt!=vr&&"constructor"in e&&"constructor"in t&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof vr=="function"&&vr instanceof vr)&&(we=!1)}return p.delete(e),p.delete(t),we}function Yr(e){return Ao(Mu(e,r,Wu),e+"")}function _o(e){return Zc(e,Mt,xo)}function bo(e){return Zc(e,ar,$u)}var Eo=On?function(e){return On.get(e)}:Uo;function kn(e){for(var t=e.name+"",s=rs[t],o=ze.call(rs,t)?s.length:0;o--;){var h=s[o],p=h.func;if(p==null||p==e)return h.name}return t}function as(e){var t=ze.call(f,"placeholder")?f:e;return t.placeholder}function se(){var e=f.iteratee||Mo;return e=e===Mo?ru:e,arguments.length?e(arguments[0],arguments[1]):e}function Kn(e,t){var s=e.__data__;return Ed(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Io(e){for(var t=Mt(e),s=t.length;s--;){var o=t[s],h=e[o];t[s]=[o,h,qu(h)]}return t}function Di(e,t){var s=Pf(e,t);return tu(s)?s:r}function gd(e){var t=ze.call(e,Ri),s=e[Ri];try{e[Ri]=r;var o=!0}catch{}var h=bn.call(e);return o&&(t?e[Ri]=s:delete e[Ri]),h}var xo=Qa?function(e){return e==null?[]:(e=Ge(e),ui(Qa(e),function(t){return jc.call(e,t)}))}:Ho,$u=Qa?function(e){for(var t=[];e;)hi(t,xo(e)),e=xn(e);return t}:Ho,Vt=Yt;(Ya&&Vt(new Ya(new ArrayBuffer(1)))!=ke||_s&&Vt(new _s)!=me||Xa&&Vt(Xa.resolve())!=xt||ts&&Vt(new ts)!=De||bs&&Vt(new bs)!=je)&&(Vt=function(e){var t=Yt(e),s=t==xe?e.constructor:r,o=s?Li(s):"";if(o)switch(o){case Yf:return ke;case Xf:return me;case Zf:return xt;case ep:return De;case tp:return je}return t});function vd(e,t,s){for(var o=-1,h=s.length;++o<h;){var p=s[o],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Bt(t,e+m);break;case"takeRight":e=Lt(e,t-m);break}}return{start:e,end:t}}function yd(e){var t=e.match(We);return t?t[1].split(Ot):[]}function Du(e,t,s){t=gi(t,e);for(var o=-1,h=t.length,p=!1;++o<h;){var m=Ur(t[o]);if(!(p=e!=null&&s(e,m)))break;e=e[m]}return p||++o!=h?p:(h=e==null?0:e.length,!!h&&Yn(h)&&Xr(m,h)&&(ge(e)||qi(e)))}function md(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&ze.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Lu(e){return typeof e.constructor=="function"&&!Rs(e)?is(xn(e)):{}}function wd(e,t,s){var o=e.constructor;switch(t){case Ne:return yo(e);case T:case S:return new o(+e);case ke:return rd(e,s);case ht:case qe:case Pt:case $t:case Ut:case Ht:case qt:case Wt:case rr:return mu(e,s);case me:return new o;case Te:case Je:return new o(e);case nt:return id(e);case De:return new o;case Qe:return sd(e)}}function _d(e,t){var s=t.length;if(!s)return e;var o=s-1;return t[o]=(s>1?"& ":"")+t[o],t=t.join(s>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+t+`] */
`)}function bd(e){return ge(e)||qi(e)||!!(Uc&&e&&e[Uc])}function Xr(e,t){var s=typeof e;return t=t??J,!!t&&(s=="number"||s!="symbol"&&Sa.test(e))&&e>-1&&e%1==0&&e<t}function Xt(e,t,s){if(!ct(s))return!1;var o=typeof t;return(o=="number"?nr(s)&&Xr(t,s.length):o=="string"&&t in s)?Tr(s[t],e):!1}function Po(e,t){if(ge(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||dr(e)?!0:St.test(e)||!rt.test(e)||t!=null&&e in Ge(t)}function Ed(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function So(e){var t=kn(e),s=f[t];if(typeof s!="function"||!(t in Pe.prototype))return!1;if(e===s)return!0;var o=Eo(s);return!!o&&e===o[0]}function Id(e){return!!qc&&qc in e}var xd=wn?Zr:ko;function Rs(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||es;return e===s}function qu(e){return e===e&&!ct(e)}function zu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==r||e in Ge(s))}}function Pd(e){var t=Jn(e,function(o){return s.size===v&&s.clear(),o}),s=t.cache;return t}function Sd(e,t){var s=e[1],o=t[1],h=s|o,p=h<(re|ce|H),m=o==H&&s==he||o==H&&s==W&&e[7].length<=t[8]||o==(H|W)&&t[7].length<=t[8]&&s==he;if(!(p||m))return e;o&re&&(e[2]=t[2],h|=s&re?0:ue);var _=t[3];if(_){var P=e[3];e[3]=P?_u(P,_,t[4]):_,e[4]=P?li(e[3],E):t[4]}return _=t[5],_&&(P=e[5],e[5]=P?bu(P,_,t[6]):_,e[6]=P?li(e[5],E):t[6]),_=t[7],_&&(e[7]=_),o&H&&(e[8]=e[8]==null?t[8]:Bt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function Cd(e){var t=[];if(e!=null)for(var s in Ge(e))t.push(s);return t}function Ad(e){return bn.call(e)}function Mu(e,t,s){return t=Lt(t===r?e.length-1:t,0),function(){for(var o=arguments,h=-1,p=Lt(o.length-t,0),m=A(p);++h<p;)m[h]=o[t+h];h=-1;for(var _=A(t+1);++h<t;)_[h]=o[h];return _[t]=s(m),zt(e,this,_)}}function ju(e,t){return t.length<2?e:$i(e,Ir(t,0,-1))}function Od(e,t){for(var s=e.length,o=Bt(t.length,s),h=sr(e);o--;){var p=t[o];e[o]=Xr(p,s)?h[p]:r}return e}function Co(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Uu=ku(hu),Ts=Kf||function(e,t){return Se.setTimeout(e,t)},Ao=ku(Xp);function Hu(e,t,s){var o=t+"";return Ao(e,_d(o,Rd(yd(o),s)))}function ku(e){var t=0,s=0;return function(){var o=Wf(),h=et-(o-s);if(s=o,h>0){if(++t>=Oe)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Bn(e,t){var s=-1,o=e.length,h=o-1;for(t=t===r?o:t;++s<t;){var p=uo(s,h),m=e[p];e[p]=e[s],e[s]=m}return e.length=t,e}var Ku=Pd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ct,function(s,o,h,p){t.push(h?p.replace(_a,"$1"):o||s)}),t});function Ur(e){if(typeof e=="string"||dr(e))return e;var t=e+"";return t=="0"&&1/e==-Re?"-0":t}function Li(e){if(e!=null){try{return _n.call(e)}catch{}try{return e+""}catch{}}return""}function Rd(e,t){return wr(Dr,function(s){var o="_."+s[0];t&s[1]&&!gn(e,o)&&e.push(o)}),e.sort()}function Bu(e){if(e instanceof Pe)return e.clone();var t=new br(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Td(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=Lt(ye(t),0);var o=e==null?0:e.length;if(!o||t<1)return[];for(var h=0,p=0,m=A(Cn(o/t));h<o;)m[p++]=Ir(e,h,h+=t);return m}function Nd(e){for(var t=-1,s=e==null?0:e.length,o=0,h=[];++t<s;){var p=e[t];p&&(h[o++]=p)}return h}function Fd(){var e=arguments.length;if(!e)return[];for(var t=A(e-1),s=arguments[0],o=e;o--;)t[o-1]=arguments[o];return hi(ge(s)?sr(s):[s],kt(t,1))}var $d=be(function(e,t){return bt(e)?Ps(e,kt(t,1,bt,!0)):[]}),Dd=be(function(e,t){var s=xr(t);return bt(s)&&(s=r),bt(e)?Ps(e,kt(t,1,bt,!0),se(s,2)):[]}),Ld=be(function(e,t){var s=xr(t);return bt(s)&&(s=r),bt(e)?Ps(e,kt(t,1,bt,!0),r,s):[]});function qd(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),Ir(e,t<0?0:t,o)):[]}function zd(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),t=o-t,Ir(e,0,t<0?0:t)):[]}function Md(e,t){return e&&e.length?qn(e,se(t,3),!0,!0):[]}function jd(e,t){return e&&e.length?qn(e,se(t,3),!0):[]}function Ud(e,t,s,o){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&Xt(e,t,s)&&(s=0,o=h),Fp(e,t,s,o)):[]}function Vu(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=s==null?0:ye(s);return h<0&&(h=Lt(o+h,0)),vn(e,se(t,3),h)}function Gu(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=o-1;return s!==r&&(h=ye(s),h=s<0?Lt(o+h,0):Bt(h,o-1)),vn(e,se(t,3),h,!0)}function Wu(e){var t=e==null?0:e.length;return t?kt(e,1):[]}function Hd(e){var t=e==null?0:e.length;return t?kt(e,Re):[]}function kd(e,t){var s=e==null?0:e.length;return s?(t=t===r?1:ye(t),kt(e,t)):[]}function Kd(e){for(var t=-1,s=e==null?0:e.length,o={};++t<s;){var h=e[t];o[h[0]]=h[1]}return o}function Ju(e){return e&&e.length?e[0]:r}function Bd(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=s==null?0:ye(s);return h<0&&(h=Lt(o+h,0)),Qi(e,t,h)}function Vd(e){var t=e==null?0:e.length;return t?Ir(e,0,-1):[]}var Gd=be(function(e){var t=it(e,go);return t.length&&t[0]===e[0]?so(t):[]}),Wd=be(function(e){var t=xr(e),s=it(e,go);return t===xr(s)?t=r:s.pop(),s.length&&s[0]===e[0]?so(s,se(t,2)):[]}),Jd=be(function(e){var t=xr(e),s=it(e,go);return t=typeof t=="function"?t:r,t&&s.pop(),s.length&&s[0]===e[0]?so(s,r,t):[]});function Qd(e,t){return e==null?"":Vf.call(e,t)}function xr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function Yd(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=o;return s!==r&&(h=ye(s),h=h<0?Lt(o+h,0):Bt(h,o-1)),t===t?Rf(e,t,h):vn(e,Oc,h,!0)}function Xd(e,t){return e&&e.length?au(e,ye(t)):r}var Zd=be(Qu);function Qu(e,t){return e&&e.length&&t&&t.length?co(e,t):e}function eg(e,t,s){return e&&e.length&&t&&t.length?co(e,t,se(s,2)):e}function tg(e,t,s){return e&&e.length&&t&&t.length?co(e,t,r,s):e}var rg=Yr(function(e,t){var s=e==null?0:e.length,o=eo(e,t);return uu(e,it(t,function(h){return Xr(h,s)?+h:h}).sort(wu)),o});function ig(e,t){var s=[];if(!(e&&e.length))return s;var o=-1,h=[],p=e.length;for(t=se(t,3);++o<p;){var m=e[o];t(m,o,e)&&(s.push(m),h.push(o))}return uu(e,h),s}function Oo(e){return e==null?e:Qf.call(e)}function sg(e,t,s){var o=e==null?0:e.length;return o?(s&&typeof s!="number"&&Xt(e,t,s)?(t=0,s=o):(t=t==null?0:ye(t),s=s===r?o:ye(s)),Ir(e,t,s)):[]}function ng(e,t){return Ln(e,t)}function ag(e,t,s){return lo(e,t,se(s,2))}function og(e,t){var s=e==null?0:e.length;if(s){var o=Ln(e,t);if(o<s&&Tr(e[o],t))return o}return-1}function cg(e,t){return Ln(e,t,!0)}function ug(e,t,s){return lo(e,t,se(s,2),!0)}function hg(e,t){var s=e==null?0:e.length;if(s){var o=Ln(e,t,!0)-1;if(Tr(e[o],t))return o}return-1}function lg(e){return e&&e.length?lu(e):[]}function fg(e,t){return e&&e.length?lu(e,se(t,2)):[]}function pg(e){var t=e==null?0:e.length;return t?Ir(e,1,t):[]}function dg(e,t,s){return e&&e.length?(t=s||t===r?1:ye(t),Ir(e,0,t<0?0:t)):[]}function gg(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),t=o-t,Ir(e,t<0?0:t,o)):[]}function vg(e,t){return e&&e.length?qn(e,se(t,3),!1,!0):[]}function yg(e,t){return e&&e.length?qn(e,se(t,3)):[]}var mg=be(function(e){return di(kt(e,1,bt,!0))}),wg=be(function(e){var t=xr(e);return bt(t)&&(t=r),di(kt(e,1,bt,!0),se(t,2))}),_g=be(function(e){var t=xr(e);return t=typeof t=="function"?t:r,di(kt(e,1,bt,!0),r,t)});function bg(e){return e&&e.length?di(e):[]}function Eg(e,t){return e&&e.length?di(e,se(t,2)):[]}function Ig(e,t){return t=typeof t=="function"?t:r,e&&e.length?di(e,r,t):[]}function Ro(e){if(!(e&&e.length))return[];var t=0;return e=ui(e,function(s){if(bt(s))return t=Lt(s.length,t),!0}),Va(t,function(s){return it(e,ka(s))})}function Yu(e,t){if(!(e&&e.length))return[];var s=Ro(e);return t==null?s:it(s,function(o){return zt(t,r,o)})}var xg=be(function(e,t){return bt(e)?Ps(e,t):[]}),Pg=be(function(e){return po(ui(e,bt))}),Sg=be(function(e){var t=xr(e);return bt(t)&&(t=r),po(ui(e,bt),se(t,2))}),Cg=be(function(e){var t=xr(e);return t=typeof t=="function"?t:r,po(ui(e,bt),r,t)}),Ag=be(Ro);function Og(e,t){return gu(e||[],t||[],xs)}function Rg(e,t){return gu(e||[],t||[],As)}var Tg=be(function(e){var t=e.length,s=t>1?e[t-1]:r;return s=typeof s=="function"?(e.pop(),s):r,Yu(e,s)});function Xu(e){var t=f(e);return t.__chain__=!0,t}function Ng(e,t){return t(e),e}function Vn(e,t){return t(e)}var Fg=Yr(function(e){var t=e.length,s=t?e[0]:0,o=this.__wrapped__,h=function(p){return eo(p,e)};return t>1||this.__actions__.length||!(o instanceof Pe)||!Xr(s)?this.thru(h):(o=o.slice(s,+s+(t?1:0)),o.__actions__.push({func:Vn,args:[h],thisArg:r}),new br(o,this.__chain__).thru(function(p){return t&&!p.length&&p.push(r),p}))});function $g(){return Xu(this)}function Dg(){return new br(this.value(),this.__chain__)}function Lg(){this.__values__===r&&(this.__values__=fh(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function qg(){return this}function zg(e){for(var t,s=this;s instanceof Tn;){var o=Bu(s);o.__index__=0,o.__values__=r,t?h.__wrapped__=o:t=o;var h=o;s=s.__wrapped__}return h.__wrapped__=e,t}function Mg(){var e=this.__wrapped__;if(e instanceof Pe){var t=e;return this.__actions__.length&&(t=new Pe(this)),t=t.reverse(),t.__actions__.push({func:Vn,args:[Oo],thisArg:r}),new br(t,this.__chain__)}return this.thru(Oo)}function jg(){return du(this.__wrapped__,this.__actions__)}var Ug=zn(function(e,t,s){ze.call(e,s)?++e[s]:Jr(e,s,1)});function Hg(e,t,s){var o=ge(e)?Cc:Np;return s&&Xt(e,t,s)&&(t=r),o(e,se(t,3))}function kg(e,t){var s=ge(e)?ui:Yc;return s(e,se(t,3))}var Kg=Pu(Vu),Bg=Pu(Gu);function Vg(e,t){return kt(Gn(e,t),1)}function Gg(e,t){return kt(Gn(e,t),Re)}function Wg(e,t,s){return s=s===r?1:ye(s),kt(Gn(e,t),s)}function Zu(e,t){var s=ge(e)?wr:pi;return s(e,se(t,3))}function eh(e,t){var s=ge(e)?pf:Qc;return s(e,se(t,3))}var Jg=zn(function(e,t,s){ze.call(e,s)?e[s].push(t):Jr(e,s,[t])});function Qg(e,t,s,o){e=nr(e)?e:cs(e),s=s&&!o?ye(s):0;var h=e.length;return s<0&&(s=Lt(h+s,0)),Xn(e)?s<=h&&e.indexOf(t,s)>-1:!!h&&Qi(e,t,s)>-1}var Yg=be(function(e,t,s){var o=-1,h=typeof t=="function",p=nr(e)?A(e.length):[];return pi(e,function(m){p[++o]=h?zt(t,m,s):Ss(m,t,s)}),p}),Xg=zn(function(e,t,s){Jr(e,s,t)});function Gn(e,t){var s=ge(e)?it:iu;return s(e,se(t,3))}function Zg(e,t,s,o){return e==null?[]:(ge(t)||(t=t==null?[]:[t]),s=o?r:s,ge(s)||(s=s==null?[]:[s]),ou(e,t,s))}var e0=zn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function t0(e,t,s){var o=ge(e)?Ua:Tc,h=arguments.length<3;return o(e,se(t,4),s,h,pi)}function r0(e,t,s){var o=ge(e)?df:Tc,h=arguments.length<3;return o(e,se(t,4),s,h,Qc)}function i0(e,t){var s=ge(e)?ui:Yc;return s(e,Qn(se(t,3)))}function s0(e){var t=ge(e)?Vc:Qp;return t(e)}function n0(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=ye(t);var o=ge(e)?Cp:Yp;return o(e,t)}function a0(e){var t=ge(e)?Ap:Zp;return t(e)}function o0(e){if(e==null)return 0;if(nr(e))return Xn(e)?Xi(e):e.length;var t=Vt(e);return t==me||t==De?e.size:ao(e).length}function c0(e,t,s){var o=ge(e)?Ha:ed;return s&&Xt(e,t,s)&&(t=r),o(e,se(t,3))}var u0=be(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Xt(e,t[0],t[1])?t=[]:s>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),ou(e,kt(t,1),[])}),Wn=kf||function(){return Se.Date.now()};function h0(e,t){if(typeof t!="function")throw new _r(d);return e=ye(e),function(){if(--e<1)return t.apply(this,arguments)}}function th(e,t,s){return t=s?r:t,t=e&&t==null?e.length:t,Qr(e,H,r,r,r,r,t)}function rh(e,t){var s;if(typeof t!="function")throw new _r(d);return e=ye(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=r),s}}var To=be(function(e,t,s){var o=re;if(s.length){var h=li(s,as(To));o|=pe}return Qr(e,o,t,s,h)}),ih=be(function(e,t,s){var o=re|ce;if(s.length){var h=li(s,as(ih));o|=pe}return Qr(t,o,e,s,h)});function sh(e,t,s){t=s?r:t;var o=Qr(e,he,r,r,r,r,r,t);return o.placeholder=sh.placeholder,o}function nh(e,t,s){t=s?r:t;var o=Qr(e,fe,r,r,r,r,r,t);return o.placeholder=nh.placeholder,o}function ah(e,t,s){var o,h,p,m,_,P,L=0,q=!1,U=!1,G=!0;if(typeof e!="function")throw new _r(d);t=Pr(t)||0,ct(s)&&(q=!!s.leading,U="maxWait"in s,p=U?Lt(Pr(s.maxWait)||0,t):p,G="trailing"in s?!!s.trailing:G);function ee(Et){var Nr=o,ti=h;return o=h=r,L=Et,m=e.apply(ti,Nr),m}function ne(Et){return L=Et,_=Ts(Ie,t),q?ee(Et):m}function we(Et){var Nr=Et-P,ti=Et-L,Ph=t-Nr;return U?Bt(Ph,p-ti):Ph}function ae(Et){var Nr=Et-P,ti=Et-L;return P===r||Nr>=t||Nr<0||U&&ti>=p}function Ie(){var Et=Wn();if(ae(Et))return Ce(Et);_=Ts(Ie,we(Et))}function Ce(Et){return _=r,G&&o?ee(Et):(o=h=r,m)}function gr(){_!==r&&vu(_),L=0,o=P=h=_=r}function Zt(){return _===r?m:Ce(Wn())}function vr(){var Et=Wn(),Nr=ae(Et);if(o=arguments,h=this,P=Et,Nr){if(_===r)return ne(P);if(U)return vu(_),_=Ts(Ie,t),ee(P)}return _===r&&(_=Ts(Ie,t)),m}return vr.cancel=gr,vr.flush=Zt,vr}var l0=be(function(e,t){return Jc(e,1,t)}),f0=be(function(e,t,s){return Jc(e,Pr(t)||0,s)});function p0(e){return Qr(e,ve)}function Jn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new _r(d);var s=function(){var o=arguments,h=t?t.apply(this,o):o[0],p=s.cache;if(p.has(h))return p.get(h);var m=e.apply(this,o);return s.cache=p.set(h,m)||p,m};return s.cache=new(Jn.Cache||Wr),s}Jn.Cache=Wr;function Qn(e){if(typeof e!="function")throw new _r(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function d0(e){return rh(2,e)}var g0=td(function(e,t){t=t.length==1&&ge(t[0])?it(t[0],fr(se())):it(kt(t,1),fr(se()));var s=t.length;return be(function(o){for(var h=-1,p=Bt(o.length,s);++h<p;)o[h]=t[h].call(this,o[h]);return zt(e,this,o)})}),No=be(function(e,t){var s=li(t,as(No));return Qr(e,pe,r,t,s)}),oh=be(function(e,t){var s=li(t,as(oh));return Qr(e,F,r,t,s)}),v0=Yr(function(e,t){return Qr(e,W,r,r,r,t)});function y0(e,t){if(typeof e!="function")throw new _r(d);return t=t===r?t:ye(t),be(e,t)}function m0(e,t){if(typeof e!="function")throw new _r(d);return t=t==null?0:Lt(ye(t),0),be(function(s){var o=s[t],h=vi(s,0,t);return o&&hi(h,o),zt(e,this,h)})}function w0(e,t,s){var o=!0,h=!0;if(typeof e!="function")throw new _r(d);return ct(s)&&(o="leading"in s?!!s.leading:o,h="trailing"in s?!!s.trailing:h),ah(e,t,{leading:o,maxWait:t,trailing:h})}function _0(e){return th(e,1)}function b0(e,t){return No(vo(t),e)}function E0(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function I0(e){return Er(e,M)}function x0(e,t){return t=typeof t=="function"?t:r,Er(e,M,t)}function P0(e){return Er(e,C|M)}function S0(e,t){return t=typeof t=="function"?t:r,Er(e,C|M,t)}function C0(e,t){return t==null||Wc(e,t,Mt(t))}function Tr(e,t){return e===t||e!==e&&t!==t}var A0=Hn(io),O0=Hn(function(e,t){return e>=t}),qi=eu(function(){return arguments}())?eu:function(e){return yt(e)&&ze.call(e,"callee")&&!jc.call(e,"callee")},ge=A.isArray,R0=Qt?fr(Qt):zp;function nr(e){return e!=null&&Yn(e.length)&&!Zr(e)}function bt(e){return yt(e)&&nr(e)}function T0(e){return e===!0||e===!1||yt(e)&&Yt(e)==T}var yi=Bf||ko,N0=Ar?fr(Ar):Mp;function F0(e){return yt(e)&&e.nodeType===1&&!Ns(e)}function $0(e){if(e==null)return!0;if(nr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||os(e)||qi(e)))return!e.length;var t=Vt(e);if(t==me||t==De)return!e.size;if(Rs(e))return!ao(e).length;for(var s in e)if(ze.call(e,s))return!1;return!0}function D0(e,t){return Cs(e,t)}function L0(e,t,s){s=typeof s=="function"?s:r;var o=s?s(e,t):r;return o===r?Cs(e,t,r,s):!!o}function Fo(e){if(!yt(e))return!1;var t=Yt(e);return t==b||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ns(e)}function q0(e){return typeof e=="number"&&Hc(e)}function Zr(e){if(!ct(e))return!1;var t=Yt(e);return t==Z||t==oe||t==N||t==mt}function ch(e){return typeof e=="number"&&e==ye(e)}function Yn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=J}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var uh=mr?fr(mr):Up;function z0(e,t){return e===t||no(e,t,Io(t))}function M0(e,t,s){return s=typeof s=="function"?s:r,no(e,t,Io(t),s)}function j0(e){return hh(e)&&e!=+e}function U0(e){if(xd(e))throw new le(l);return tu(e)}function H0(e){return e===null}function k0(e){return e==null}function hh(e){return typeof e=="number"||yt(e)&&Yt(e)==Te}function Ns(e){if(!yt(e)||Yt(e)!=xe)return!1;var t=xn(e);if(t===null)return!0;var s=ze.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&_n.call(s)==Mf}var $o=zr?fr(zr):Hp;function K0(e){return ch(e)&&e>=-J&&e<=J}var lh=ys?fr(ys):kp;function Xn(e){return typeof e=="string"||!ge(e)&&yt(e)&&Yt(e)==Je}function dr(e){return typeof e=="symbol"||yt(e)&&Yt(e)==Qe}var os=Oi?fr(Oi):Kp;function B0(e){return e===r}function V0(e){return yt(e)&&Vt(e)==je}function G0(e){return yt(e)&&Yt(e)==Ye}var W0=Hn(oo),J0=Hn(function(e,t){return e<=t});function fh(e){if(!e)return[];if(nr(e))return Xn(e)?Or(e):sr(e);if(ws&&e[ws])return Cf(e[ws]());var t=Vt(e),s=t==me?Wa:t==De?yn:cs;return s(e)}function ei(e){if(!e)return e===0?e:0;if(e=Pr(e),e===Re||e===-Re){var t=e<0?-1:1;return t*B}return e===e?e:0}function ye(e){var t=ei(e),s=t%1;return t===t?s?t-s:t:0}function ph(e){return e?Fi(ye(e),0,V):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return k;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Nc(e);var s=Ia.test(e);return s||Pa.test(e)?de(e.slice(2),s?2:8):Ea.test(e)?k:+e}function dh(e){return jr(e,ar(e))}function Q0(e){return e?Fi(ye(e),-J,J):e===0?e:0}function Le(e){return e==null?"":pr(e)}var Y0=ss(function(e,t){if(Rs(t)||nr(t)){jr(t,Mt(t),e);return}for(var s in t)ze.call(t,s)&&xs(e,s,t[s])}),gh=ss(function(e,t){jr(t,ar(t),e)}),Zn=ss(function(e,t,s,o){jr(t,ar(t),e,o)}),X0=ss(function(e,t,s,o){jr(t,Mt(t),e,o)}),Z0=Yr(eo);function ev(e,t){var s=is(e);return t==null?s:Gc(s,t)}var tv=be(function(e,t){e=Ge(e);var s=-1,o=t.length,h=o>2?t[2]:r;for(h&&Xt(t[0],t[1],h)&&(o=1);++s<o;)for(var p=t[s],m=ar(p),_=-1,P=m.length;++_<P;){var L=m[_],q=e[L];(q===r||Tr(q,es[L])&&!ze.call(e,L))&&(e[L]=p[L])}return e}),rv=be(function(e){return e.push(r,Nu),zt(vh,r,e)});function iv(e,t){return Ac(e,se(t,3),Mr)}function sv(e,t){return Ac(e,se(t,3),ro)}function nv(e,t){return e==null?e:to(e,se(t,3),ar)}function av(e,t){return e==null?e:Xc(e,se(t,3),ar)}function ov(e,t){return e&&Mr(e,se(t,3))}function cv(e,t){return e&&ro(e,se(t,3))}function uv(e){return e==null?[]:$n(e,Mt(e))}function hv(e){return e==null?[]:$n(e,ar(e))}function Do(e,t,s){var o=e==null?r:$i(e,t);return o===r?s:o}function lv(e,t){return e!=null&&Du(e,t,$p)}function Lo(e,t){return e!=null&&Du(e,t,Dp)}var fv=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),e[t]=s},zo(or)),pv=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),ze.call(e,t)?e[t].push(s):e[t]=[s]},se),dv=be(Ss);function Mt(e){return nr(e)?Bc(e):ao(e)}function ar(e){return nr(e)?Bc(e,!0):Bp(e)}function gv(e,t){var s={};return t=se(t,3),Mr(e,function(o,h,p){Jr(s,t(o,h,p),o)}),s}function vv(e,t){var s={};return t=se(t,3),Mr(e,function(o,h,p){Jr(s,h,t(o,h,p))}),s}var yv=ss(function(e,t,s){Dn(e,t,s)}),vh=ss(function(e,t,s,o){Dn(e,t,s,o)}),mv=Yr(function(e,t){var s={};if(e==null)return s;var o=!1;t=it(t,function(p){return p=gi(p,e),o||(o=p.length>1),p}),jr(e,bo(e),s),o&&(s=Er(s,C|R|M,fd));for(var h=t.length;h--;)fo(s,t[h]);return s});function wv(e,t){return yh(e,Qn(se(t)))}var _v=Yr(function(e,t){return e==null?{}:Gp(e,t)});function yh(e,t){if(e==null)return{};var s=it(bo(e),function(o){return[o]});return t=se(t),cu(e,s,function(o,h){return t(o,h[0])})}function bv(e,t,s){t=gi(t,e);var o=-1,h=t.length;for(h||(h=1,e=r);++o<h;){var p=e==null?r:e[Ur(t[o])];p===r&&(o=h,p=s),e=Zr(p)?p.call(e):p}return e}function Ev(e,t,s){return e==null?e:As(e,t,s)}function Iv(e,t,s,o){return o=typeof o=="function"?o:r,e==null?e:As(e,t,s,o)}var mh=Ru(Mt),wh=Ru(ar);function xv(e,t,s){var o=ge(e),h=o||yi(e)||os(e);if(t=se(t,4),s==null){var p=e&&e.constructor;h?s=o?new p:[]:ct(e)?s=Zr(p)?is(xn(e)):{}:s={}}return(h?wr:Mr)(e,function(m,_,P){return t(s,m,_,P)}),s}function Pv(e,t){return e==null?!0:fo(e,t)}function Sv(e,t,s){return e==null?e:pu(e,t,vo(s))}function Cv(e,t,s,o){return o=typeof o=="function"?o:r,e==null?e:pu(e,t,vo(s),o)}function cs(e){return e==null?[]:Ga(e,Mt(e))}function Av(e){return e==null?[]:Ga(e,ar(e))}function Ov(e,t,s){return s===r&&(s=t,t=r),s!==r&&(s=Pr(s),s=s===s?s:0),t!==r&&(t=Pr(t),t=t===t?t:0),Fi(Pr(e),t,s)}function Rv(e,t,s){return t=ei(t),s===r?(s=t,t=0):s=ei(s),e=Pr(e),Lp(e,t,s)}function Tv(e,t,s){if(s&&typeof s!="boolean"&&Xt(e,t,s)&&(t=s=r),s===r&&(typeof t=="boolean"?(s=t,t=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ei(e),t===r?(t=e,e=0):t=ei(t)),e>t){var o=e;e=t,t=o}if(s||e%1||t%1){var h=kc();return Bt(e+h*(t-e+Be("1e-"+((h+"").length-1))),t)}return uo(e,t)}var Nv=ns(function(e,t,s){return t=t.toLowerCase(),e+(s?_h(t):t)});function _h(e){return qo(Le(e).toLowerCase())}function bh(e){return e=Le(e),e&&e.replace(Br,Ef).replace(za,"")}function Fv(e,t,s){e=Le(e),t=pr(t);var o=e.length;s=s===r?o:Fi(ye(s),0,o);var h=s;return s-=t.length,s>=0&&e.slice(s,h)==t}function $v(e){return e=Le(e),e&&tt.test(e)?e.replace(xi,If):e}function Dv(e){return e=Le(e),e&&At.test(e)?e.replace(dt,"\\$&"):e}var Lv=ns(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),qv=ns(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),zv=xu("toLowerCase");function Mv(e,t,s){e=Le(e),t=ye(t);var o=t?Xi(e):0;if(!t||o>=t)return e;var h=(t-o)/2;return Un(An(h),s)+e+Un(Cn(h),s)}function jv(e,t,s){e=Le(e),t=ye(t);var o=t?Xi(e):0;return t&&o<t?e+Un(t-o,s):e}function Uv(e,t,s){e=Le(e),t=ye(t);var o=t?Xi(e):0;return t&&o<t?Un(t-o,s)+e:e}function Hv(e,t,s){return s||t==null?t=0:t&&(t=+t),Jf(Le(e).replace(gt,""),t||0)}function kv(e,t,s){return(s?Xt(e,t,s):t===r)?t=1:t=ye(t),ho(Le(e),t)}function Kv(){var e=arguments,t=Le(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Bv=ns(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function Vv(e,t,s){return s&&typeof s!="number"&&Xt(e,t,s)&&(t=s=r),s=s===r?V:s>>>0,s?(e=Le(e),e&&(typeof t=="string"||t!=null&&!$o(t))&&(t=pr(t),!t&&Yi(e))?vi(Or(e),0,s):e.split(t,s)):[]}var Gv=ns(function(e,t,s){return e+(s?" ":"")+qo(t)});function Wv(e,t,s){return e=Le(e),s=s==null?0:Fi(ye(s),0,e.length),t=pr(t),e.slice(s,s+t.length)==t}function Jv(e,t,s){var o=f.templateSettings;s&&Xt(e,t,s)&&(t=r),e=Le(e),t=Zn({},t,o,Tu);var h=Zn({},t.imports,o.imports,Tu),p=Mt(h),m=Ga(h,p),_,P,L=0,q=t.interpolate||ki,U="__p += '",G=Ja((t.escape||ki).source+"|"+q.source+"|"+(q===ot?ba:ki).source+"|"+(t.evaluate||ki).source+"|$","g"),ee="//# sourceURL="+(ze.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ma+"]")+`
`;e.replace(G,function(ae,Ie,Ce,gr,Zt,vr){return Ce||(Ce=gr),U+=e.slice(L,vr).replace(Ca,xf),Ie&&(_=!0,U+=`' +
__e(`+Ie+`) +
'`),Zt&&(P=!0,U+=`';
`+Zt+`;
__p += '`),Ce&&(U+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),L=vr+ae.length,ae}),U+=`';
`;var ne=ze.call(t,"variable")&&t.variable;if(!ne)U=`with (obj) {
`+U+`
}
`;else if(wa.test(ne))throw new le(y);U=(P?U.replace(Lr,""):U).replace(Jt,"$1").replace(Kr,"$1;"),U="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var we=Ih(function(){return $e(p,ee+"return "+U).apply(r,m)});if(we.source=U,Fo(we))throw we;return we}function Qv(e){return Le(e).toLowerCase()}function Yv(e){return Le(e).toUpperCase()}function Xv(e,t,s){if(e=Le(e),e&&(s||t===r))return Nc(e);if(!e||!(t=pr(t)))return e;var o=Or(e),h=Or(t),p=Fc(o,h),m=$c(o,h)+1;return vi(o,p,m).join("")}function Zv(e,t,s){if(e=Le(e),e&&(s||t===r))return e.slice(0,Lc(e)+1);if(!e||!(t=pr(t)))return e;var o=Or(e),h=$c(o,Or(t))+1;return vi(o,0,h).join("")}function ey(e,t,s){if(e=Le(e),e&&(s||t===r))return e.replace(gt,"");if(!e||!(t=pr(t)))return e;var o=Or(e),h=Fc(o,Or(t));return vi(o,h).join("")}function ty(e,t){var s=te,o=Ee;if(ct(t)){var h="separator"in t?t.separator:h;s="length"in t?ye(t.length):s,o="omission"in t?pr(t.omission):o}e=Le(e);var p=e.length;if(Yi(e)){var m=Or(e);p=m.length}if(s>=p)return e;var _=s-Xi(o);if(_<1)return o;var P=m?vi(m,0,_).join(""):e.slice(0,_);if(h===r)return P+o;if(m&&(_+=P.length-_),$o(h)){if(e.slice(_).search(h)){var L,q=P;for(h.global||(h=Ja(h.source,Le(yr.exec(h))+"g")),h.lastIndex=0;L=h.exec(q);)var U=L.index;P=P.slice(0,U===r?_:U)}}else if(e.indexOf(pr(h),_)!=_){var G=P.lastIndexOf(h);G>-1&&(P=P.slice(0,G))}return P+o}function ry(e){return e=Le(e),e&&lt.test(e)?e.replace(oi,Tf):e}var iy=ns(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),qo=xu("toUpperCase");function Eh(e,t,s){return e=Le(e),t=s?r:t,t===r?Sf(e)?$f(e):yf(e):e.match(t)||[]}var Ih=be(function(e,t){try{return zt(e,r,t)}catch(s){return Fo(s)?s:new le(s)}}),sy=Yr(function(e,t){return wr(t,function(s){s=Ur(s),Jr(e,s,To(e[s],e))}),e});function ny(e){var t=e==null?0:e.length,s=se();return e=t?it(e,function(o){if(typeof o[1]!="function")throw new _r(d);return[s(o[0]),o[1]]}):[],be(function(o){for(var h=-1;++h<t;){var p=e[h];if(zt(p[0],this,o))return zt(p[1],this,o)}})}function ay(e){return Tp(Er(e,C))}function zo(e){return function(){return e}}function oy(e,t){return e==null||e!==e?t:e}var cy=Su(),uy=Su(!0);function or(e){return e}function Mo(e){return ru(typeof e=="function"?e:Er(e,C))}function hy(e){return su(Er(e,C))}function ly(e,t){return nu(e,Er(t,C))}var fy=be(function(e,t){return function(s){return Ss(s,e,t)}}),py=be(function(e,t){return function(s){return Ss(e,s,t)}});function jo(e,t,s){var o=Mt(t),h=$n(t,o);s==null&&!(ct(t)&&(h.length||!o.length))&&(s=t,t=e,e=this,h=$n(t,Mt(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,m=Zr(e);return wr(h,function(_){var P=t[_];e[_]=P,m&&(e.prototype[_]=function(){var L=this.__chain__;if(p||L){var q=e(this.__wrapped__),U=q.__actions__=sr(this.__actions__);return U.push({func:P,args:arguments,thisArg:e}),q.__chain__=L,q}return P.apply(e,hi([this.value()],arguments))})}),e}function dy(){return Se._===this&&(Se._=jf),this}function Uo(){}function gy(e){return e=ye(e),be(function(t){return au(t,e)})}var vy=mo(it),yy=mo(Cc),my=mo(Ha);function xh(e){return Po(e)?ka(Ur(e)):Wp(e)}function wy(e){return function(t){return e==null?r:$i(e,t)}}var _y=Au(),by=Au(!0);function Ho(){return[]}function ko(){return!1}function Ey(){return{}}function Iy(){return""}function xy(){return!0}function Py(e,t){if(e=ye(e),e<1||e>J)return[];var s=V,o=Bt(e,V);t=se(t),e-=V;for(var h=Va(o,t);++s<e;)t(s);return h}function Sy(e){return ge(e)?it(e,Ur):dr(e)?[e]:sr(Ku(Le(e)))}function Cy(e){var t=++zf;return Le(e)+t}var Ay=jn(function(e,t){return e+t},0),Oy=wo("ceil"),Ry=jn(function(e,t){return e/t},1),Ty=wo("floor");function Ny(e){return e&&e.length?Fn(e,or,io):r}function Fy(e,t){return e&&e.length?Fn(e,se(t,2),io):r}function $y(e){return Rc(e,or)}function Dy(e,t){return Rc(e,se(t,2))}function Ly(e){return e&&e.length?Fn(e,or,oo):r}function qy(e,t){return e&&e.length?Fn(e,se(t,2),oo):r}var zy=jn(function(e,t){return e*t},1),My=wo("round"),jy=jn(function(e,t){return e-t},0);function Uy(e){return e&&e.length?Ba(e,or):0}function Hy(e,t){return e&&e.length?Ba(e,se(t,2)):0}return f.after=h0,f.ary=th,f.assign=Y0,f.assignIn=gh,f.assignInWith=Zn,f.assignWith=X0,f.at=Z0,f.before=rh,f.bind=To,f.bindAll=sy,f.bindKey=ih,f.castArray=E0,f.chain=Xu,f.chunk=Td,f.compact=Nd,f.concat=Fd,f.cond=ny,f.conforms=ay,f.constant=zo,f.countBy=Ug,f.create=ev,f.curry=sh,f.curryRight=nh,f.debounce=ah,f.defaults=tv,f.defaultsDeep=rv,f.defer=l0,f.delay=f0,f.difference=$d,f.differenceBy=Dd,f.differenceWith=Ld,f.drop=qd,f.dropRight=zd,f.dropRightWhile=Md,f.dropWhile=jd,f.fill=Ud,f.filter=kg,f.flatMap=Vg,f.flatMapDeep=Gg,f.flatMapDepth=Wg,f.flatten=Wu,f.flattenDeep=Hd,f.flattenDepth=kd,f.flip=p0,f.flow=cy,f.flowRight=uy,f.fromPairs=Kd,f.functions=uv,f.functionsIn=hv,f.groupBy=Jg,f.initial=Vd,f.intersection=Gd,f.intersectionBy=Wd,f.intersectionWith=Jd,f.invert=fv,f.invertBy=pv,f.invokeMap=Yg,f.iteratee=Mo,f.keyBy=Xg,f.keys=Mt,f.keysIn=ar,f.map=Gn,f.mapKeys=gv,f.mapValues=vv,f.matches=hy,f.matchesProperty=ly,f.memoize=Jn,f.merge=yv,f.mergeWith=vh,f.method=fy,f.methodOf=py,f.mixin=jo,f.negate=Qn,f.nthArg=gy,f.omit=mv,f.omitBy=wv,f.once=d0,f.orderBy=Zg,f.over=vy,f.overArgs=g0,f.overEvery=yy,f.overSome=my,f.partial=No,f.partialRight=oh,f.partition=e0,f.pick=_v,f.pickBy=yh,f.property=xh,f.propertyOf=wy,f.pull=Zd,f.pullAll=Qu,f.pullAllBy=eg,f.pullAllWith=tg,f.pullAt=rg,f.range=_y,f.rangeRight=by,f.rearg=v0,f.reject=i0,f.remove=ig,f.rest=y0,f.reverse=Oo,f.sampleSize=n0,f.set=Ev,f.setWith=Iv,f.shuffle=a0,f.slice=sg,f.sortBy=u0,f.sortedUniq=lg,f.sortedUniqBy=fg,f.split=Vv,f.spread=m0,f.tail=pg,f.take=dg,f.takeRight=gg,f.takeRightWhile=vg,f.takeWhile=yg,f.tap=Ng,f.throttle=w0,f.thru=Vn,f.toArray=fh,f.toPairs=mh,f.toPairsIn=wh,f.toPath=Sy,f.toPlainObject=dh,f.transform=xv,f.unary=_0,f.union=mg,f.unionBy=wg,f.unionWith=_g,f.uniq=bg,f.uniqBy=Eg,f.uniqWith=Ig,f.unset=Pv,f.unzip=Ro,f.unzipWith=Yu,f.update=Sv,f.updateWith=Cv,f.values=cs,f.valuesIn=Av,f.without=xg,f.words=Eh,f.wrap=b0,f.xor=Pg,f.xorBy=Sg,f.xorWith=Cg,f.zip=Ag,f.zipObject=Og,f.zipObjectDeep=Rg,f.zipWith=Tg,f.entries=mh,f.entriesIn=wh,f.extend=gh,f.extendWith=Zn,jo(f,f),f.add=Ay,f.attempt=Ih,f.camelCase=Nv,f.capitalize=_h,f.ceil=Oy,f.clamp=Ov,f.clone=I0,f.cloneDeep=P0,f.cloneDeepWith=S0,f.cloneWith=x0,f.conformsTo=C0,f.deburr=bh,f.defaultTo=oy,f.divide=Ry,f.endsWith=Fv,f.eq=Tr,f.escape=$v,f.escapeRegExp=Dv,f.every=Hg,f.find=Kg,f.findIndex=Vu,f.findKey=iv,f.findLast=Bg,f.findLastIndex=Gu,f.findLastKey=sv,f.floor=Ty,f.forEach=Zu,f.forEachRight=eh,f.forIn=nv,f.forInRight=av,f.forOwn=ov,f.forOwnRight=cv,f.get=Do,f.gt=A0,f.gte=O0,f.has=lv,f.hasIn=Lo,f.head=Ju,f.identity=or,f.includes=Qg,f.indexOf=Bd,f.inRange=Rv,f.invoke=dv,f.isArguments=qi,f.isArray=ge,f.isArrayBuffer=R0,f.isArrayLike=nr,f.isArrayLikeObject=bt,f.isBoolean=T0,f.isBuffer=yi,f.isDate=N0,f.isElement=F0,f.isEmpty=$0,f.isEqual=D0,f.isEqualWith=L0,f.isError=Fo,f.isFinite=q0,f.isFunction=Zr,f.isInteger=ch,f.isLength=Yn,f.isMap=uh,f.isMatch=z0,f.isMatchWith=M0,f.isNaN=j0,f.isNative=U0,f.isNil=k0,f.isNull=H0,f.isNumber=hh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Ns,f.isRegExp=$o,f.isSafeInteger=K0,f.isSet=lh,f.isString=Xn,f.isSymbol=dr,f.isTypedArray=os,f.isUndefined=B0,f.isWeakMap=V0,f.isWeakSet=G0,f.join=Qd,f.kebabCase=Lv,f.last=xr,f.lastIndexOf=Yd,f.lowerCase=qv,f.lowerFirst=zv,f.lt=W0,f.lte=J0,f.max=Ny,f.maxBy=Fy,f.mean=$y,f.meanBy=Dy,f.min=Ly,f.minBy=qy,f.stubArray=Ho,f.stubFalse=ko,f.stubObject=Ey,f.stubString=Iy,f.stubTrue=xy,f.multiply=zy,f.nth=Xd,f.noConflict=dy,f.noop=Uo,f.now=Wn,f.pad=Mv,f.padEnd=jv,f.padStart=Uv,f.parseInt=Hv,f.random=Tv,f.reduce=t0,f.reduceRight=r0,f.repeat=kv,f.replace=Kv,f.result=bv,f.round=My,f.runInContext=x,f.sample=s0,f.size=o0,f.snakeCase=Bv,f.some=c0,f.sortedIndex=ng,f.sortedIndexBy=ag,f.sortedIndexOf=og,f.sortedLastIndex=cg,f.sortedLastIndexBy=ug,f.sortedLastIndexOf=hg,f.startCase=Gv,f.startsWith=Wv,f.subtract=jy,f.sum=Uy,f.sumBy=Hy,f.template=Jv,f.times=Py,f.toFinite=ei,f.toInteger=ye,f.toLength=ph,f.toLower=Qv,f.toNumber=Pr,f.toSafeInteger=Q0,f.toString=Le,f.toUpper=Yv,f.trim=Xv,f.trimEnd=Zv,f.trimStart=ey,f.truncate=ty,f.unescape=ry,f.uniqueId=Cy,f.upperCase=iy,f.upperFirst=qo,f.each=Zu,f.eachRight=eh,f.first=Ju,jo(f,function(){var e={};return Mr(f,function(t,s){ze.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),wr(["drop","take"],function(e,t){Pe.prototype[e]=function(s){s=s===r?1:Lt(ye(s),0);var o=this.__filtered__&&!t?new Pe(this):this.clone();return o.__filtered__?o.__takeCount__=Bt(s,o.__takeCount__):o.__views__.push({size:Bt(s,V),type:e+(o.__dir__<0?"Right":"")}),o},Pe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),wr(["filter","map","takeWhile"],function(e,t){var s=t+1,o=s==O||s==Me;Pe.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:se(h,3),type:s}),p.__filtered__=p.__filtered__||o,p}}),wr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Pe.prototype[e]=function(){return this[s](1).value()[0]}}),wr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Pe.prototype[e]=function(){return this.__filtered__?new Pe(this):this[s](1)}}),Pe.prototype.compact=function(){return this.filter(or)},Pe.prototype.find=function(e){return this.filter(e).head()},Pe.prototype.findLast=function(e){return this.reverse().find(e)},Pe.prototype.invokeMap=be(function(e,t){return typeof e=="function"?new Pe(this):this.map(function(s){return Ss(s,e,t)})}),Pe.prototype.reject=function(e){return this.filter(Qn(se(e)))},Pe.prototype.slice=function(e,t){e=ye(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Pe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==r&&(t=ye(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Pe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pe.prototype.toArray=function(){return this.take(V)},Mr(Pe.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),h=f[o?"take"+(t=="last"?"Right":""):t],p=o||/^find/.test(t);h&&(f.prototype[t]=function(){var m=this.__wrapped__,_=o?[1]:arguments,P=m instanceof Pe,L=_[0],q=P||ge(m),U=function(Ie){var Ce=h.apply(f,hi([Ie],_));return o&&G?Ce[0]:Ce};q&&s&&typeof L=="function"&&L.length!=1&&(P=q=!1);var G=this.__chain__,ee=!!this.__actions__.length,ne=p&&!G,we=P&&!ee;if(!p&&q){m=we?m:new Pe(this);var ae=e.apply(m,_);return ae.__actions__.push({func:Vn,args:[U],thisArg:r}),new br(ae,G)}return ne&&we?e.apply(this,_):(ae=this.thru(U),ne?o?ae.value()[0]:ae.value():ae)})}),wr(["pop","push","shift","sort","splice","unshift"],function(e){var t=mn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(o&&!this.__chain__){var p=this.value();return t.apply(ge(p)?p:[],h)}return this[s](function(m){return t.apply(ge(m)?m:[],h)})}}),Mr(Pe.prototype,function(e,t){var s=f[t];if(s){var o=s.name+"";ze.call(rs,o)||(rs[o]=[]),rs[o].push({name:t,func:s})}}),rs[Mn(r,ce).name]=[{name:"wrapper",func:r}],Pe.prototype.clone=rp,Pe.prototype.reverse=ip,Pe.prototype.value=sp,f.prototype.at=Fg,f.prototype.chain=$g,f.prototype.commit=Dg,f.prototype.next=Lg,f.prototype.plant=zg,f.prototype.reverse=Mg,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=jg,f.prototype.first=f.prototype.head,ws&&(f.prototype[ws]=qg),f},Zi=Df();_t?((_t.exports=Zi)._=Zi,Ve._=Zi):Se._=Zi}).call(Ms)})(fc,fc.exports);var Hb=Object.defineProperty,kb=Object.defineProperties,Kb=Object.getOwnPropertyDescriptors,wl=Object.getOwnPropertySymbols,Bb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,_l=(c,i,r)=>i in c?Hb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,na=(c,i)=>{for(var r in i||(i={}))Bb.call(i,r)&&_l(c,r,i[r]);if(wl)for(var r of wl(i))Vb.call(i,r)&&_l(c,r,i[r]);return c},Gb=(c,i)=>kb(c,Kb(i));function Ei(c,i,r){var n;const a=Om(c);return((n=i.rpcMap)==null?void 0:n[a.reference])||`${Ub}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function Hi(c){return c.includes(":")?c.split(":")[1]:c}function hf(c){return c.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function Wb(c,i){const r=Object.keys(i.namespaces).filter(a=>a.includes(c));if(!r.length)return[];const n=[];return r.forEach(a=>{const l=i.namespaces[a].accounts;n.push(...l)}),n}function Jb(c={},i={}){const r=bl(c),n=bl(i);return fc.exports.merge(r,n)}function bl(c){var i,r,n,a;const l={};if(!ca(c))return l;for(const[d,y]of Object.entries(c)){const w=$l(d)?[d]:y.chains,v=y.methods||[],E=y.events||[],C=y.rpcMap||{},R=js(d);l[R]=Gb(na(na({},l[R]),y),{chains:Bo(w,(i=l[R])==null?void 0:i.chains),methods:Bo(v,(r=l[R])==null?void 0:r.methods),events:Bo(E,(n=l[R])==null?void 0:n.events),rpcMap:na(na({},C),(a=l[R])==null?void 0:a.rpcMap)})}return l}function Qb(c){return c.includes(":")?c.split(":")[2]:c}function Yb(c){const i={};for(const[r,n]of Object.entries(c)){const a=n.methods||[],l=n.events||[],d=n.accounts||[],y=$l(r)?[r]:n.chains?n.chains:hf(n.accounts);i[r]={chains:y,methods:a,events:l,accounts:d}}return i}function ic(c){return typeof c=="number"?c:c.includes("0x")?parseInt(c,16):c.includes(":")?Number(c.split(":")[1]):Number(c)}const lf={},st=c=>lf[c],sc=(c,i)=>{lf[c]=i};class Xb{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=Hi(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class Zb{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(parseInt(i),r),this.chainId=parseInt(i),this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const n=r||Ei(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt(Hi(r));i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,n;let a=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class eE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=Hi(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class tE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=Hi(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class rE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=Hi(r);i[a]=this.createHttpProvider(a,n)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||this.getCardanoRPCUrl(i);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class iE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=Hi(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class sE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=Hi(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class nE{constructor(i){this.name="near",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Ei(`${this.name}:${i}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace);return typeof n>"u"?void 0:new ni(new Ii(n,st("disableProviderPing")))}}var aE=Object.defineProperty,oE=Object.defineProperties,cE=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,uE=Object.prototype.hasOwnProperty,hE=Object.prototype.propertyIsEnumerable,Il=(c,i,r)=>i in c?aE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,aa=(c,i)=>{for(var r in i||(i={}))uE.call(i,r)&&Il(c,r,i[r]);if(El)for(var r of El(i))hE.call(i,r)&&Il(c,r,i[r]);return c},nc=(c,i)=>oE(c,cE(i));class Pc{constructor(i){this.events=new vc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:i?.logger||yl})),this.disableProviderPing=i?.disableProviderPing||!1}static async init(i){const r=new Pc(i);return await r.initialize(),r}async request(i,r){const[n,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:aa({},i),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(i,r,n){this.request(i,n).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=Yb(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==cf)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[n,a]=this.validateChain(i);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(fs(r)){for(const n of r)i.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await qb.init({logger:this.providerOpts.logger||yl,relayUrl:this.providerOpts.relayUrl||zb,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>js(r)))];sc("client",this.client),sc("events",this.events),sc("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const n=Wb(r,this.session),a=hf(n),l=Jb(this.namespaces,this.optionalNamespaces),d=nc(aa({},l[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new Zb({namespace:d});break;case"solana":this.rpcProviders[r]=new eE({namespace:d});break;case"cosmos":this.rpcProviders[r]=new tE({namespace:d});break;case"polkadot":this.rpcProviders[r]=new Xb({namespace:d});break;case"cip34":this.rpcProviders[r]=new rE({namespace:d});break;case"elrond":this.rpcProviders[r]=new iE({namespace:d});break;case"multiversx":this.rpcProviders[r]=new sE({namespace:d});break;case"near":this.rpcProviders[r]=new nE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&fs(a)&&this.events.emit("accountsChanged",a.map(Qb))}else if(n.name==="chainChanged"){const a=r.chainId,l=r.event.data,d=js(a),y=ic(a)!==ic(l)?`${d}:${ic(l)}`:a;this.onChainChanged(y)}else this.events.emit(n.name,n.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var n;const{namespaces:a}=r,l=(n=this.client)==null?void 0:n.session.get(i);this.session=nc(aa({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",nc(aa({},tr("USER_DISCONNECTED")),{data:i.topic}))}),this.on(ai.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=i;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(i){const[r,n]=i?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(d=>js(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=js(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var n;if(!this.namespaces)return;const[a,l]=this.validateChain(i);r||this.getProvider(a).setDefaultChain(l),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${ml}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${ml}/${i}`)}}const lE=Pc,fE="wc",pE="ethereum_provider",dE=`${fE}@2:${pE}:`,gE="https://rpc.walletconnect.com/v1/",pc=["eth_sendTransaction","personal_sign"],vE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],dc=["chainChanged","accountsChanged"],yE=["chainChanged","accountsChanged","message","disconnect","connect"];var mE=Object.defineProperty,wE=Object.defineProperties,_E=Object.getOwnPropertyDescriptors,xl=Object.getOwnPropertySymbols,bE=Object.prototype.hasOwnProperty,EE=Object.prototype.propertyIsEnumerable,Pl=(c,i,r)=>i in c?mE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Hs=(c,i)=>{for(var r in i||(i={}))bE.call(i,r)&&Pl(c,r,i[r]);if(xl)for(var r of xl(i))EE.call(i,r)&&Pl(c,r,i[r]);return c},Sl=(c,i)=>wE(c,_E(i));function da(c){return Number(c[0].split(":")[1])}function ac(c){return`0x${c.toString(16)}`}function IE(c){const{chains:i,optionalChains:r,methods:n,optionalMethods:a,events:l,optionalEvents:d,rpcMap:y}=c;if(!fs(i))throw new Error("Invalid chains");const w={chains:i,methods:n||pc,events:l||dc,rpcMap:Hs({},i.length?{[da(i)]:y[da(i)]}:{})},v=l?.filter(M=>!dc.includes(M)),E=n?.filter(M=>!pc.includes(M));if(!r&&!d&&!a&&!(v!=null&&v.length)&&!(E!=null&&E.length))return{required:i.length?w:void 0};const C=v?.length&&E?.length||!r,R={chains:[...new Set(C?w.chains.concat(r||[]):r)],methods:[...new Set(w.methods.concat(a!=null&&a.length?a:vE))],events:[...new Set(w.events.concat(d!=null&&d.length?d:yE))],rpcMap:y};return{required:i.length?w:void 0,optional:r.length?R:void 0}}class Sc{constructor(){this.events=new kr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=dE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Sc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:n}=IE(this.rpc);try{const a=await new Promise(async(d,y)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(v=>{!v.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Sl(Hs({namespaces:Hs({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:i?.pairingTopic})).then(v=>{d(v)}).catch(v=>{y(new Error(v.message))})});if(!a)return;const l=Rm(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:ac(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",ac(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",Sl(Hs({},tr("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",ac(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,n,a]=i.split(":");return{chainId:`${r}:${n}`,address:a}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,n;const a=(r=i?.chains)!=null?r:[],l=(n=i?.optionalChains)!=null?n:[],d=a.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=a.length?i?.methods||pc:[],w=a.length?i?.events||dc:[],v=i?.optionalMethods||[],E=i?.optionalEvents||[],C=i?.rpcMap||this.buildRpcMap(d,i.projectId),R=i?.qrModalOptions||void 0;return{chains:a?.map(M=>this.formatChainId(M)),optionalChains:l.map(M=>this.formatChainId(M)),methods:y,events:w,optionalMethods:v,optionalEvents:E,rpcMap:C,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:R,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const n={};return i.forEach(a=>{n[a]=this.getRpcUrl(a,r)}),n}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?da(this.rpc.chains):da(this.rpc.optionalChains),this.signer=await lE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await Tm(()=>import("./index-78c8de83.js").then(a=>a.i),["assets/index-78c8de83.js","assets/index-c12aec1c.js","assets/index-a5bf1ffd.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Hs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:n,rpcMap:a}=i;r&&fs(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=a?.[l]||this.getRpcUrl(l)})),n&&fs(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n?.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=a?.[l]||this.getRpcUrl(l)}))}getRpcUrl(i,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[i])||`${gE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r?.accounts),this.setAccounts(r?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const LE=Sc;export{LE as EthereumProvider,yE as OPTIONAL_EVENTS,vE as OPTIONAL_METHODS,dc as REQUIRED_EVENTS,pc as REQUIRED_METHODS,Sc as default};
